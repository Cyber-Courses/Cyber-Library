---
title: 'Identifying Open SSH Ports (22): Techniques & Tools'
description: Explore effective methods and tools for identifying open SSH ports, including
  Nmap, Masscan, and packet crafting techniques.
keywords:
- SSH port identification
- Nmap SSH scan
- Masscan for SSH
- network security
- detecting open ports
- SSH version detection
- firewall evasion
- packet crafting
- network enumeration
- passive scanning techniques
---

# Identifying Open SSH Ports (22)

## Network Scanning

### Active Scanning Techniques

#### Utilize Nmap for Port Discovery

Nmap is a powerful open-source tool for network discovery and security auditing. For identifying open SSH ports specifically, Nmap offers flexible scanning options to target port 22, the default port for SSH. The basic command to scan for open SSH ports is:

```bash
nmap -p 22 <target_ip>
```

This command checks whether port 22 on the target IP address is open. For more thorough scanning, you can use:

```bash
nmap -sV -p 22 <target_ip>
```

Here, the `-sV` option enables version detection, which helps in identifying the SSH version and implementation running on the target system. For wider network scans, using `-p-` will scan all 65535 ports:

```bash
nmap -p- <target_ip> --open
```

To enhance scanning efficiency, the `-Pn` flag can be used to disable host discovery, which is useful when dealing with firewalls that block ping requests:

```bash
nmap -Pn -p 22 <target_ip>
```

#### Implementing Masscan for High-Speed Scans

Masscan is used for scanning large IP ranges at high speed. It is particularly useful when you need to scan a vast number of hosts quickly for open SSH ports. The tool uses a different networking engine, enabling it to scan the entire internet in under six minutes.

```bash
masscan -p22 0.0.0.0/0 --rate=100000
```

This command will scan all possible IP addresses for open SSH ports at the rate of 100,000 packets per second. Masscan outputs results in a format similar to Nmap, which can be easily processed further. Handling such extensive data requires filtering tools like `grep` or `awk` to extract meaningful insights.

### Passive Scanning Methods

#### Network Sniffing for Traffic Analysis

Passive methods involve monitoring network traffic without actively sending packets, making detection difficult. Tools like Wireshark are ideal for analyzing network patterns that involve SSH traffic. Follow these steps to leverage Wireshark:

1. **Capture Filters**: Set Wireshark capture filters to isolate traffic on port 22:

   ```
   tcp.port == 22
   ```

   This filters and displays only the traffic destined for port 22.

2. **Analysis**: Look for patterns in the traffic, such as frequent connections, which may indicate a popular SSH server.

3. **Session Replay**: Attempting to decrypt SSH traffic is impractical due to encryption, but session timing and IP addresses provide valuable information about SSH usage.

## Firewall Evasion Strategies

### Techniques to Bypass Network Filters

#### Crafting Packets with Scapy for Evasion

Scapy is a Python-based tool used for crafting and sending packets. Customizing packets to evade network filters involves altering packet attributes such as TTL, source port, and fragmentation. Here is an example of sending fragmented packets to bypass firewalls:

```python
from scapy.all import *

# Create fragmented packets
packet = IP(dst="target_ip")/TCP(dport=22, flags="S")
frags = fragment(packet, fragsize=24)
send(frags)
```

The fragmentation breaks the packet into smaller parts, which can help evade detection mechanisms that rely on reassembling full packets.

#### Using Proxy Servers to Mask Scanning Activity

Sending scan traffic through proxy servers can obscure your true origin. Configuring proxy chains can route requests through a series of proxies, masking the scan’s source:

- Install proxychains and modify `/etc/proxychains.conf` to include your desired proxies.
- Use tools or scripts prefixed with `proxychains` to anonymize traffic:

   ```bash
   proxychains nmap -p 22 <target_ip>
   ```

### Advanced Evasion Tactics

#### Employing Fragmented Packets to Defeat IDS/IPS Systems

Similar to the packet crafting above, sending fragmented packets can confuse Intrusion Detection/Prevention Systems (IDS/IPS), which may not reassemble packets to recognize suspicious patterns.

Fragmented packets can bypass simple rulesets designed for full packets, triggering alarms only when wanted parts are reconstructed.

#### Leverage DNS Tunneling for Covert Scanning

DNS tunneling encodes data into DNS queries and responses, which can slip through firewalls unnoticed as DNS traffic. Tools like `iodine` can establish a covert channel to perform scans:

- Set up an iodine server and make DNS requests to exfiltrate or scan networks.

The scenario is highly complex and requires rigorous setup, including owning a domain and redirecting its DNS to your iodine server.

## Host Discovery

### Targeting Host Systems for SSH Services

#### Identifying Live Hosts Using ARP Scans

ARP scanning is efficient within local networks for identifying devices with open SSH services. Tools like `arp-scan` send ARP requests to elicit responses from devices, providing MAC addresses and IPs:

```bash
arp-scan --localnet
```

#### ICMP-based Host Discovery

Using ICMP requests (ping scanning) helps discover live hosts for further scanning. However, many networks block ICMP, so it might not always be reliable.

Adaptive scanning techniques, like altering intervals and packet sizes, improve discovery chances in restrictive environments.

### Determining SSH Service Exposure

#### Assessing External IP Ranges with Shodan

Shodan, the search engine for internet-connected devices, indexes systems based on open ports and services. Use Shodan’s query feature to locate systems with open SSH ports:

```shell
shodan search "port:22"
```

This displays systems globally with port 22 open, often with metadata about the SSH server.

#### Employing Cloud-Based Reconnaissance Tools

Cloud reconnaissance tools aggregate data from multiple sources to present potential SSH entry points. Platforms like Censys can be queried similarly to Shodan but may offer different datasets and capabilities.

## Automation of SSH Port Identification

### Scripting for Efficiency

#### Developing Custom Scripts for Automated Scanning

Automating repetitive tasks such as scanning large subnets can be done with custom scripts. Python's `subprocess` module can perform automated Nmap scans:

```python
import subprocess

hosts = ["192.168.1.0/24", "10.0.0.0/16"]
for host in hosts:
    subprocess.call(["nmap", "-p", "22", host, "-oG", "ssh_scan_results.txt"])
```

This script runs scans on specified networks and saves output to a file for further analysis.

### Utilizing Existing Automation Frameworks

#### Integrating Open-source Tools into Workflows

Combine existing tools into coherent workflows using orchestration frameworks like Ansible. Write playbooks to automate scanning and logging processes to maintain vigilance:

```yaml
- name: SSH Scan
  hosts: all
  tasks:
    - name: Run Nmap scan
      command: nmap -p 22 {{ ansible_host }}
```

Execute this playbook to scan all hosts in your inventory file automatically.

#### Implementing Cron Jobs for Regular Scan Tasks

Set up `cron` jobs to automate scans at periodic intervals. Edit the crontab file:

```shell
0 0 * * * /usr/bin/nmap -p 22 -sV 192.168.1.0/24 > /var/log/ssh_scan.log
```

This runs the scan nightly at midnight, logging results for later review.

## Advanced Analysis of SSH Port Activity

### Monitoring and Alerting for SSH Port Usage

#### Setting up Real-time Alerts for Unauthorized Access

Configure tools like Snort for real-time alerts on networks. Setup Snort to listen on the interface where SSH scans are likely to occur:

```bash
/etc/snort/snort.conf
```

Define rules to detect multiple connection attempts to port 22, generating alerts as needed.

#### Employing Honeypots to Trap Intrusion Attempts

Deploy honeypots that mimic vulnerable SSH services. Tools like `Cowrie` simulate an SSH environment, recording attacker activity for analysis:

Install `Cowrie` and configure it to look like a real system while capturing illegitimate connection attempts.

### Data Analytics and Reporting

#### Applying Machine Learning to Detect Anomalies

Use anomaly detection algorithms to flag unexpected SSH usage patterns. Libraries like Scikit-learn provide utilities for clustering and outlier detection based on connection metrics.

Models can alert security teams to deviations in expected SSH traffic patterns.

#### Generating Comprehensive Reports for Threat Analysis

Create scripts or use tools like Splunk to visualize and report on captured network data. Incorporate templates to structure findings and provide actionable insights into SSH port activities over time.

Enable dynamic graphics and summaries to effectively communicate security posture concerning SSH services to stakeholders.