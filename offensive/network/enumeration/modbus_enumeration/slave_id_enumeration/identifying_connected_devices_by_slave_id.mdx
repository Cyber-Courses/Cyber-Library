---
title: Identifying Connected Devices by Slave ID in Modbus Networks
description: Learn to identify connected devices by Slave ID using Modbus protocol
  enumeration techniques for enhanced network reconnaissance.
keywords:
- Modbus protocol
- Slave ID enumeration
- network reconnaissance
- industrial control systems
- connected devices
- penetration testing
- device identification
- traffic analysis
- network security
---

### Identifying Connected Devices by Slave ID

---

#### Modbus Protocol Overview

The Modbus protocol is a communication protocol commonly used in industrial environments for connecting supervisory computers with remote terminal units in SCADA systems. It functions as a master/slave or client/server model where a master device initiates transactions (known as queries) and slave devices respond to them. Each device in the network has a unique Slave ID, which can range from 1 to 247, distinguishing it within the system. Understanding the Modbus protocol is crucial because Slave ID enumeration allows the identification of connected devices and their roles, enhancing situational awareness during penetration testing activities.

---

#### Network Enumeration Techniques

Network enumeration techniques for identifying Slave IDs are critical for mapping an industrial environment and gaining insights into device configurations. There are active and passive approaches to enumerate Slave IDs. Active techniques involve direct interaction with networked devices through Modbus queries to elicit responses, revealing their Slave IDs. Passive techniques focus on monitoring traffic to identify Slave IDs based on captured network communications without engaging devices directly. These methods are fundamental for collecting intelligence on network architecture and identifying potential targets for subsequent attack vectors.

---

#### Direct Query for Slave ID Identification

Direct querying involves sending meticulously crafted requests to devices on a Modbus network to provoke responses that disclose their Slave IDs. A typical approach is to initiate a request from the master device using the function code designed to read diagnostic information, such as function code 43/14. This request can elicit a response containing the Slave ID and device-specific information, which helps in reconnaissance activities. For example, a simple command to query Slave IDs might look like:

```shell
modpoll -m tcp -t 43 -a 1 -r 0 -c 2 192.168.1.10
```

In this example, `modpoll` sends a query to the slave device at IP `192.168.1.10`, prompting it to return its identification information. This approach requires careful management of query frequency and timing to avoid detection by anomaly-based intrusion detection systems.

---

#### Traffic Analysis for Passive Enumeration

Passive enumeration involves capturing and analyzing network traffic patterns to discover Slave IDs without direct interaction. Tools like Wireshark or TShark can be employed to intercept traffic on the Modbus port (typically TCP/502), extracting Slave IDs from the observed data exchanges between the master and slave devices. This data can reveal which Slave IDs are active and provide insights into communication patterns and device roles. The advantage of passive enumeration is its lower likelihood of detection compared to active querying, making it suitable for covert reconnaissance efforts.

---

#### Differentiating Device Types by Slave ID

Once Slave IDs are identified, correlating them with device types and manufacturers requires knowledge of common mappings and proprietary databases. Manufacturers often assign specific ranges of Slave IDs to particular device models or series. By analyzing the Slave ID and correlating it with known manufacturer conventions or through documentation, one can differentiate between device types, such as PLCs, RTUs, and IEDs. This knowledge is vital in exploiting configuration-specific vulnerabilities or tailoring attacks to specific device models.

---

#### Challenges in Slave ID Enumeration

Slave ID enumeration faces challenges, such as varying degrees of response disclosure from devices due to network configurations or security measures. Devices may be configured to suppress responses to unknown requests or implement rate limiting. Moreover, administrators may employ segmentation or other network hardening techniques that complicate enumeration activities. Understanding such obstacles and potential detection by network monitoring solutions necessitates stealthy approaches and often requires integrating enumeration results with other collected intelligence.

---

#### Leveraging Slave ID Data

Slave ID data obtained through enumeration can significantly enhance a penetration testing campaign. By mapping networked devices, penetration testers can strategize attacks focusing on key control systems or infrastructure components. Slave ID information acts as a gateway to exploiting known vulnerabilities, manipulating device functions, or even weaponizing existing communication channels for further infiltration. Thus, leveraging Slave ID data is crucial for a successful offensive operation in a connected industrial environment.

---

#### Tools and Scripts

Various tools and scripts facilitate Slave ID enumeration, with `modscan`, `plcscan`, and custom Python scripts being popular choices. These tools allow for the automation of the querying process, ensuring efficient enumeration over large network spaces. For instance, `modscan` can be configured to sweep network ranges, identifying active Slave IDs and compiling device information systematically. Proper configuration and scripting underpin the effectiveness of these tools, which must align with specific operational goals and network conditions.

---

#### Operational Context and Application

In offensive operations, identifying connected devices by Slave ID allows testers to create a comprehensive map of an industrial network. This map contextualizes the interconnectedness of devices, revealing critical nodes that may serve as entry points or targets for cyberattacks. Cross-referencing Slave ID data with results from other enumeration activities, such as network scans or vulnerability assessments, provides a holistic view of the network. This approach facilitates the development of strategies tailored to the network's technological landscape, enhancing the efficacy of penetration tests.