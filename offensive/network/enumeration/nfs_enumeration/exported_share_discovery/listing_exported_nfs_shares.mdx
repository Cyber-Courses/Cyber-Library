---
title: Comprehensive Guide to Listing Exported NFS Shares
description: Explore methods to list exported NFS shares and discover potential vulnerabilities
  in networked environments.
keywords:
- NFS shares
- exported NFS
- NFS enumeration
- network services
- NFS vulnerabilities
- showmount command
- rpcinfo
- etc/exports file
- mounting NFS shares
- network file system
---

# Listing Exported NFS Shares

## Enumerating Network Services

Identify open NFS ports as a first step in determining the presence of Network File System (NFS) services within a network. This involves using network scanning tools like `nmap` to pinpoint devices that are listening on NFS-associated ports, primarily port 2049. The command `nmap -p 2049 <target-ip-range>` can be employed to look for open NFS ports across multiple network addresses. Discovering these open ports suggests the presence of NFS services which can be further interrogated for additional insights or potential vulnerabilities.

NFS service version detection requires leveraging service enumeration techniques to identify the specific NFS version in operation. Using `nmap` service version detection, crafted with the command `nmap -sV -p 2049 <target-ip>`, one can retrieve information about the version of NFS in use. Identifying the NFS version is crucial as it guides further attacks or reconnaissance efforts, especially considering that different versions have distinct features, configurations, and vulnerabilities.

## Utilizing RPC Protocol for NFS Enumeration

Engaging with the Remote Procedure Call (RPC) protocol using utilities like `rpcinfo` is essential in NFS enumeration. RPC, integral to NFS operation, can reveal details about network services that are available for remote calls. Running `rpcinfo -p <target-ip>` on a target system lists RPC programs and their corresponding ports, including those related to NFS. This gathered data helps in understanding the services running on the host and planning subsequent actions for optimal engagement with the network’s NFS components.

## Analyzing the `/etc/exports` File

The `/etc/exports` file on a *nix system defines the directories shared over NFS and details client access control mechanisms. Gaining access to view or download this file on a remote system - through legitimate permission checks or exploiting system vulnerabilities - can reveal critical information about what an NFS server exposes to a network. The file syntax specifies shared paths alongside client access privileges, including read/write permissions and IP-based access restrictions, guiding strategists toward exploiting misconfigurations or under-secured shared paths.

## Listing NFS Shares with `showmount`

The `showmount` tool effectively lists exported directories from an NFS server. Executing `showmount -e <target-ip>` displays NFS exported directories, making it clear where the potential data exposures or accessible resources are situated. It provides a quick review of what an NFS server is sharing, offering insights into the potential pivot points and data leak opportunities that an attacker could leverage.

Cross-referencing the gathered exported directories involves analyzing the accessibility of each to ascertain the likelihood of successful exploitation or information extraction. This includes reviewing directory permissions and other associated attributes which support deeper penetration testing or forensic examination objectives.

## Advanced Techniques

Bypassing access controls in NFS setups involves identifying and exploiting misconfigurations or known vulnerabilities that allow access to otherwise restricted NFS shares. This could involve trying IP spoofing if access controls are IP-based, or exploiting vulnerabilities in NFS implementations that may allow attackers to modify their access rights or invisibly traverse protected file shares.

## Automating NFS Share Discovery

Developing custom scripts for NFS share discovery automates the enumeration process, saving time and increasing the efficiency of reconnaissance operations. Scripting languages like Python or Bash can be used to repeatedly run discovery tasks against large IP ranges, systematically compiling lists of open and vulnerable NFS shares. Automation ensures that an attack surface can be quickly and thoroughly examined, especially in enterprises with large networks.

## Verification with Mounting Attempts

Verification through mounting attempts is a critical step in confirming the feasibility of direct file access and manipulation. By using the `mount` command to attach a discovered NFS share locally - for example, `mount -t nfs <target-ip>:/exported/path /local/mountpoint` - operators can validate actual access rights and restrictions. This process confirms the potential for data extraction or manipulation, providing a verified basis for broader offensive operations.

## Consolidating Access Information

Documenting all discovered data concerning NFS shares is crucial. This involves recording detailed information about each share’s configurations, access permissions, identified vulnerabilities, and exploitable weaknesses. This consolidated access information aids further offensive cybersecurity efforts by providing clear documentation that can be referenced to plan coordinated attacks or highlight vulnerabilities to be addressed in defensive security audits.