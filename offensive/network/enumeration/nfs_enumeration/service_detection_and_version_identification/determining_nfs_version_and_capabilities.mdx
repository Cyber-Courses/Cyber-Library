---
title: How to Determine NFS Version and Capabilities Effectively
description: Learn techniques to identify NFS versions and capabilities using tools
  like Nmap, rpcinfo, and Wireshark for better security assessments.
keywords:
- NFS version identification
- NFS capabilities assessment
- RPC enumeration
- Nmap NFS
- showmount command
- Wireshark NFS analysis
- NFS security
---

---

# Determining NFS Version and Capabilities

In offensive cybersecurity, gaining a deep understanding of the NFS (Network File System) version and its capabilities on a target network is crucial for exploiting potential vulnerabilities. This process involves several technical steps that leverage specific tools and techniques to extract version information and assess the system's capabilities.

## RPC Enumeration Techniques

### Port Scanning with Nmap

Nmap is a fundamental tool for network enumeration. To determine if an NFS service is active, port scanning via Nmap can be utilized. By specifically targeting ports 2049, 111, and other RPC-related ports, one can identify NFS services running on the network. The command for an aggressive scan that identifies the service version on port 2049 is:

```bash
nmap -p 2049 -sV <target-ip>
```

Additionally, using Nmap's scripting engine with the `rpcinfo` and `nfs*` scripts can provide extended information about RPC services:

```bash
nmap -p 111 --script=nfs* <target-ip>
```

### Utilizing RPCinfo

`rpcinfo` is a command-line utility utilized to query RPC services on a network. By executing `rpcinfo` against a target, attackers can identify the program numbers, versions, and network protocols used by NFS. The usage is straightforward:

```bash
rpcinfo -p <target-ip>
```

This will list all registered RPC services, providing critical insights into which services, including NFS, are available.

### NFS Status Check via Showmount

The `showmount` command checks active NFS exports on a server. It communicates using RPC to determine what directories are exported and who is permitted access. This utility is indispensable for assessing NFS availability and exporting configurations:

```bash
showmount -e <target-ip>
```

Running this command will help determine what NFS resources are exposed, providing a gateway to NFS version verification.

## Version Identification

### Analyzing NFS Proc Versions

On Linux systems where NFS services are hosted, examining the `/proc/fs/nfsd/versions` file provides a quick look at the supported NFS versions. This backend assessment, particularly when access privileges are high, allows for unfiltered insight into the server's NFS configuration:

```bash
cat /proc/fs/nfsd/versions
```

### Packet Inspection through Wireshark

Using Wireshark, an attacker can capture and analyze packets exchanged between an NFS client and server. By looking at captured packets, the NFS protocol version can often be discerned from the traffic header details. Begin by filtering Network File System packets:

```
nfs
```

This filtered data will showcase the version information in the `NFS Opcodes` section explicitly, revealing intricate details about the protocol version in use.

### Exploiting Error Messages

NFS servers can be probed by conducting various operations deliberately designed to fail. These operations might generate error messages specifying unsupported operations based on the client's request, indicating the protocol version implicitly.

Attempts to perform actions above the current NFS version threshold could return errors that hint at the supported versions, which can be rogue-orchestrated through tailored scripts or direct attempts.

## Capability Assessment

### Nmap Scripting for NFS Capabilities

Nmapâ€™s scripting engine offers extensive scripts to probe deeper into NFS beyond version detection. Specific scripts like `nfs-ls`, `nfs-statfs`, and `nfs-showmount` explore the directories, filesystem statistics, and other attributes:

```bash
nmap --script nfs-* <target-ip>
```

### Bypass Permission Tactics

Permission-based tactics involve attempting unauthorized access and privilege escalation to infer missing security layers and server capabilities. Using methods like UID spoofing in NFS can sometimes bypass weak authentication mechanisms, revealing more about server capabilities.

### Mount Options Enumeration

Understanding mount options can provide details about enforced security mechanisms and operational parameters. By using verbose (`-v`) options during mount operations, detailed insights about available NFS options are obtainable:

```bash
mount -v -o nfs <server>:/<share> <mount-point>
```

This command details mount parameters that are enforced or allowed, giving a measure of the NFS server's flexibility and potential configuration weaknesses.

### File System Analysis

Performing file manipulation operations like creating, renaming, or setting file attributes within an NFS share assists in identifying supported filesystem-specific features. These operations allow a real-time assessment of capabilities such as lock management, file size limits, and special permissions, revealing the operational envelope of the NFS server.

--- 

By delving into these practices, cybersecurity professionals can effectively discover NFS version details and their operational capabilities, paving the way for identifying potential security vulnerabilities in the target network.