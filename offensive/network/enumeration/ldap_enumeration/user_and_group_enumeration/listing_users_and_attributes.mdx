---
title: Listing Users and Attributes in LDAP Enumeration
description: Explore techniques for listing users and attributes in LDAP for security
  enumeration. Master advanced queries and tools for effective analysis.
keywords:
- LDAP enumeration
- user attributes
- user listing
- enumeration techniques
- active directory
- ldapsearch
- security analysis
- user data extraction
- privilege identification
---

# Listing Users and Attributes

## LDAP Query Design

**Leveraging LDAP Filters for User Enumeration**

LDAP (Lightweight Directory Access Protocol) is a critical component for managing and accessing directory services, essential in offensive cybersecurity for enumerating users. LDAP filters offer powerful means to craft queries that efficiently locate user-related information within directory services. To leverage them effectively, one must understand the syntax and semantics of LDAP filters. The basic structure involves specifying a condition in parentheses, such as `uid=jdoe`, which searches for a user with an ID of "jdoe". More complex queries use logical operators, such as `&` for AND, `|` for OR, and `!` for NOT, allowing combinations like `(&(objectClass=user)(|(sn=Smith)(givenName=John)))` to target specific users. Optimizing these searches focuses not just on speed but also on minimizing traces that could alert defenders. Hence, queries should be concise and targeted, avoiding broad wildcard searches that might generate significant noise and raise suspicion.

**Constructing Attribute Lists**

Attributes in an LDAP directory provide metadata for each entry, where critical attributes can shed light on valuable targets or information within a network. Enumerators must focus on choosing the right attributes to extract to avoid excessive network load and increase the efficacy of their enumeration efforts. Key attributes often include `sAMAccountName`, `displayName`, `mail`, and `memberOf`, which can reveal usernames, real names, email addresses, and group memberships, respectively. Constructing attribute lists involves understanding the target environment to decide on relevant attributes, adjusting queries accordingly. A streamlined attribute list will help in pinpointing actionable items without overwhelming the enumerator with unnecessary data.

## Tools and Techniques

**Using ldapsearch for User Enumeration**

`ldapsearch` is a versatile command-line tool facilitating LDAP queries against directory services. It is commonly used to pull information such as user lists and their attributes. To initiate a basic user enumeration with `ldapsearch`, a user might issue:

```shell
ldapsearch -x -b "dc=example,dc=com" "(objectClass=user)"
```

This command performs a search starting at the base distinguished name (DN) "dc=example,dc=com", filtering for entries classified as users. To extract specific attributes, modify the command:

```shell
ldapsearch -x -b "dc=example,dc=com" "(objectClass=user)" cn mail
```

This targets specific entries to retrieve only the `cn` (common name) and `mail` attributes. For large directories, it is practical to add paging support to handle voluminous returns without overwhelming the connection.

**Exploiting Built-in System Commands**

Operating systems provide built-in tools that can facilitate the enumeration of user attributes. In Windows environments, PowerShell and Command Prompt are particularly potent. The PowerShell cmdlet `Get-ADUser` is commonly used:

```powershell
Get-ADUser -Filter * -Property DisplayName, EmailAddress, MemberOf
```

This retrieves a list of all users along with specific attributes. In Unix/Linux systems, utilities like `getent` can query user information stored in directory services:

```shell
getent passwd | awk -F: '{ print $1,$5 }'
```

This command extracts usernames and their associated descriptive fields from local directories.

## Advanced Query Tactics

**Recursive Searches and Depth Limitation**

Recursive searches leverage LDAP’s hierarchical nature to scan through nested organizational units and groups. However, this can be bandwidth-intensive and noisy, making depth limitation a critical technique to control such operations. Specifying a search scope, such as `base`, `one`, or `sub`, determines how deep into the directory structure the search goes. It's wise to use search depth strategically, setting clear objectives about which organizational levels hold valuable data to remain stealthy during enumeration.

**Attribute-based Filtering**

Refining searches by specific attributes can pinpoint critical data swiftly. By constructing queries that target attributes indicative of roles or positions, such as `title=Administrator`, attackers can zero in on users likely to hold privileges. Combining such filters tactically allows narrowing targets from potentially extensive lists to a core group of high-value accounts. An example filter might look like:

```shell
(&(objectClass=user)(|(mail=*)(telephoneNumber=*)))
```

This seeks users with either an email address or telephone number, often indicators of communication roles or remote access.

## Extracting User Details

**Finding Key Attributes for Lateral Movement**

Sophisticated attacks frequently move laterally across a network, seeking opportunistic expansions. Knowing which attributes reveal potential avenues for lateral movement is crucial. Attributes like `homeDirectory`, which can indicate shared network paths, or `userPrincipalName`, linking to login methods, provide key insights. Analysts can craft schemes to target such attributes, identifying vulnerable user junctions facilitating lateral movement.

**Determining Administrative Attributes**

Finding indications of administrative privileges within user attributes can be a game-changer. Attributes such as `adminCount`, when set to values suggesting elevated permissions, expose accounts with administrative access. Discerning these attributes through LDAP queries can help attackers focus efforts on gaining elevated access through compromised accounts. 

## Post-Enumeration Analysis

**Pattern Analysis in User Data**

Post-extraction, analyzing user data for patterns that indicate irregularities or systematic oversights is essential. Identifying trends, such as unusually common passwords indicated by `userPassword`, or inconsistent `sn` (surname) patterns, can hint at systemic vulnerabilities. Moreover, profiling historic attribute changes might highlight shifts in user roles or security settings, offering vectors for escalation or exfiltration tactics.

**Cross-referencing with External Data**

Enhancing internal user data with external datasets can significantly improve accuracy in enumeration. Cross-referencing user attributes against publicly available organizational roles, known breach databases, or social networks can identify weakened security practices or predict user behaviors, offering actionable intelligence for further attacks. Enriching this information with such external dimensions refines the attacker’s strategy, moving beyond mere extraction to comprehensive security analysis.