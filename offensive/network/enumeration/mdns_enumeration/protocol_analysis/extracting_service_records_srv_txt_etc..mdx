---
title: 'Extracting Service Records: SRV and TXT Explained'
description: Learn to extract SRV and TXT records for effective network enumeration,
  analysis, and operational tactics in cybersecurity.
keywords:
- SRV records
- TXT records
- DNS enumeration
- network discovery
- mDNS techniques
- packet analysis
- network enumeration tools
- offensive security
- DNS query manipulation
---

## Extracting Service Records (SRV, TXT, etc.)

### Service Records Overview

SRV (Service) and TXT (Text) records are crucial components of the Domain Name System (DNS) that provide information about available network services and additional metadata for domains. SRV records direct clients to specific services hosted within a domain, pointing to details like hostname and port number. TXT records, on the other hand, can hold arbitrary text information which often includes verification details, domain policies, or other metadata relevant to service management.

Understanding these records is essential in network discovery and enumeration as they can reveal critical information about the network services available in the target domain. Extracting these records helps attackers map potential targets and identify the services and capabilities of a network infrastructure.

### Tools and Utilities for Extraction

Several tools can be used to extract SRV and TXT records, ranging from basic command-line utilities to advanced automated discovery tools.

#### Command-Line Tools

- **dig**: A versatile DNS lookup utility. To retrieve SRV and TXT records:

  ```bash
  dig _service._tcp.example.com SRV
  dig example.com TXT
  ```

  The above commands query DNS directly for SRV and TXT records, respectively.

- **nslookup**: Simpler than `dig`, yet effective for basic DNS queries:

  ```bash
  nslookup -type=SRV _service._tcp.example.com
  nslookup -type=TXT example.com
  ```

#### Advanced Extraction Tools

- **dnsrecon**: Facilitates automated record discovery, executing multiple DNS enumeration techniques:

  ```bash
  dnsrecon -d example.com -t srv
  dnsrecon -d example.com -t txt
  ```

  This command identifies existing SRV and TXT records in the specified domain.

- **dnsenum**: Another utility for comprehensive DNS enumeration, particularly useful for expanding queries beyond SRV and TXT records:

  ```bash
  dnsenum --enum example.com
  ```

#### Scripting for Automation

Python libraries, such as `dnslib` and `dnspython`, allow the automation of record extraction, creating customized solutions to gather DNS information programmatically:

```python
import dns.resolver

def get_srv_records(domain):
    try:
        answers = dns.resolver.resolve(f'_service._tcp.{domain}', 'SRV')
        return [str(record) for record in answers]
    except Exception as e:
        return f"No SRV records found: {e}"

def get_txt_records(domain):
    try:
        answers = dns.resolver.resolve(domain, 'TXT')
        return [record.strings for record in answers]
    except Exception as e:
        return f"No TXT records found: {e}"

domain = "example.com"
print(get_srv_records(domain))
print(get_txt_records(domain))
```

This script programmatically resolves SRV and TXT records for a given domain.

### Network Protocol Analysis

Capturing and analyzing DNS and mDNS traffic between clients and DNS servers is another method for extracting service records.

#### Packet Capture Techniques

- **tcpdump** and **Wireshark**: Use these tools for packet capture on network interfaces to observe real-time DNS queries and responses.

  ```bash
  tcpdump -i eth0 port 53 -w dns_traffic.pcap
  ```

  This command captures all DNS traffic on the `eth0` interface.

#### Analyzing DNS Queries and Responses

In Wireshark, filter captured traffic using `dns` as a display filter and look for SRV and TXT queries in the DNS packet details pane, focusing on the Answers section to find military-ranked service records.

#### Extracting Data from Captures

Wireshark allows filtering relevant service records, making it easier to distinguish and focus on SRV and TXT records among the captured data. This process involves managing filters based on specific record types, such as `_service._tcp` indicates an SRV record.

### DNS Query Manipulation

### Crafting Queries for Internal and External Domains

Direct querying of DNS records may not always yield results due to network restrictions. Manipulating queries for internal or less scrutinized external domains can reveal additional records. Modifying the query structure to bypass internal DNS policies ensures comprehensive data extraction:

```bash
dig @dns.server.internal _service._tcp.internaldomain SRV
```

### Evasion Techniques

To avoid detection during DNS interrogation, hackers often employ techniques like query randomization, varying sourcing networks, and altering query intervals to mimic typical user behavior. VPNs or proxy servers mask the attacker's origin, reducing visibility in network logs.

### Response Analysis

Interpreting DNS response data effectively identifies patterns and leads to additional queries. SRV records, which map service types to hostnames and ports, often require deeper investigation into associated services, guiding further enumeration.

### mDNS Specific Techniques

### mDNS Packet Structure

mDNS, or Multicast DNS, restricts its operations to the local network, and its packet structure slightly varies from traditional DNS. mDNS SRV and TXT records provide immediate insight into local network services, like printers or shared storage:

- **Tool Commands**: Use `avahi-browse` to identify mDNS services across a local network:

  ```bash
  avahi-browse -r _services._dns-sd._udp
  ```

### mDNS Exploitation

Exploiting mDNS involves leveraging the multicast nature to enumerate services broadcast over the LAN. Regular enumeration commands capture service types and offer network footprint insights, utilizing tools like `mdns-scan`.

### Record Interpretation

### Parsing Extracted Records

Once extracted, SRV and TXT records reveal information about network configurations, service roles, and organizational structure. Parsing involves converting raw data packets into structured formats:

```python
# Sample parsing command
parsed_srv_record = dns.resolver.resolve('_sip._tcp.example.com', 'SRV')
for srv in parsed_srv_record:
    print(f"Service: {srv.target}, Port: {srv.port}")
```

### Influencing Service Discovery

Strategically modifying or corrupting service records disrupts legitimate service discovery processes, guiding or misleading network consumers. This manipulation could either cloak attacker actions or mislead the defense into diagnosing incorrect service configurations.

### Tactics for Covert Operations

### Mitigating Beacons

Removing or altering DNS beacons—automated queries reporting back to a central server—limits potential exposure during operations. This involves curating DNS policies within organizational networks.

### Stealthy DNS Operations

By minimizing detectable signatures during DNS operations, attackers blend within legitimate traffic. Heavy reliance on encrypted DNS (DoT/DoH) and stealth tactics prevents network security controls from distinguishing malicious from benign traffic, securing adversary anonymity within the enumeration phase.

### Comprehensive Network Enumeration Strategy

Combining SRV and TXT record extraction with other enumeration methods builds a robust strategy, facilitating a thorough attack surface analysis. Integrating these techniques into the broader enumeration workflow enhances target understanding, enabling effective and precise offensive campaigns.