---
title: 'Determine RDP Version and Features: A Comprehensive Guide'
description: Learn to effectively determine RDP versions and features using tools
  like Nmap, Metasploit, and more for enhanced security analysis.
keywords:
- RDP version detection
- RDP features enumeration
- Nmap RDP scanning
- Metasploit RDP modules
- network enumeration tools
- RDP security analysis
- Masscan for RDP
- RDPSCAN utility
- RDP protocol analysis
- TLS fingerprinting
---

### Determining RDP Version and Features

When it comes to determining the version and features of Remote Desktop Protocol (RDP) services, a variety of tools and techniques can be employed to gain valuable insights into the capabilities and security postures of remote systems. Below is a detailed exploration of these methods:

#### Network Scanning Tools

**Nmap for RDP Enumeration**

Nmap, a robust network scanning tool, can be used to detect RDP services and ascertain their versions. By leveraging Nmap's scripting engine (NSE), users can employ specific scripts designed for RDP analysis. For example, the `rdp-enum-encryption` script can be used not only to detect the presence of RDP but also to infer the version by analyzing encryption settings:

```bash
nmap -p 3389 --script rdp-enum-encryption <target-ip>
```

This command scans the target IP on port 3389, specifically looking for encryption details that help infer the RDP version and its security configurations.

**Masscan for Large-Scale Sweeps**

Masscan is tailored for high-speed network scanning, making it ideal for quickly sweeping large networks to identify open RDP ports. By integrating Masscan results with further analysis tools, users can streamline the process of determining the RDP version:

```bash
masscan -p3389 <network-range> --rate=10000
```

This command executes a scan across a specified network range at a rate of 10,000 packets per second, efficiently finding active RDP services that can be further inspected for detailed version information.

#### Exploitation Frameworks

**Metasploit RDP Modules**

Metasploit, a well-known penetration testing framework, includes auxiliary modules for assessing RDP services. Modules like `auxiliary/scanner/rdp/rdp_version` enable users to extract version information from target systems:

```bash
use auxiliary/scanner/rdp/rdp_version
set RHOSTS <target-ip>
run
```

Using Metasploit allows for comprehensive information gathering, leveraging built-in exploits and scripts to determine the features of the RDP service deployed.

#### Protocol-Specific Tactics

**RDP Handshake Inspection**

During the RDP connection process, the handshake phase can reveal valuable version and feature information. Analyzing packet captures of this handshake with tools like Wireshark can provide insights into the sessionâ€™s configuration and capabilities.

By capturing and inspecting the initial handshake packets, security professionals can assess supported protocol versions and encryption levels.

**RDP Negotiation Protocol Analysis**

The RDP negotiation phase often uses the X.224 protocol to exchange versioning information and tricks such as capturing negotiation requests aid in identifying supported features of an RDP service. This protocol-based analysis can unveil specific versions and any unique features enabled on the server.

#### Tool-Based Enumeration

**RDPSCAN Utility**

RDPSCAN is a specialized tool designed for checking RDP configurations quickly. By running RDPSCAN, users can promptly ascertain the RDP version and ascertain crucial aspects of the server's configuration:

```bash
rdpscan <target-ip>
```

The simplified output of RDPSCAN includes RDP version details, offering a straightforward way to determine what features and configurations are present on the target system.

**CrackMapExec for RDP Feature Detection**

CrackMapExec (CME) provides a suite of functionalities to automate the detection of RDP features across multiple systems. It allows penetration testers to efficiently determine feature sets:

```bash
cme rdp <target-ip>
```

With CrackMapExec, users can access detailed information such as session management configurations, helping detect specific security configurations and plugins in use.

#### Script and Custom Tools

**CREDDUMP and RDPY for Automated Checking**

Utilizing scripts and tools like CREDDUMP and RDPY facilitates automated analysis of RDP services. By scripting these tools, security experts can extend their capabilities, automating the detection of version information and server features, thereby increasing the accuracy and depth of the enumeration process.

#### Leveraging Public Databases

**Exploring Shodan and Censys**

Shodan and Censys provide APIs for querying internet-facing RDP services. By targeting these databases with queries tailored to RDP attributes, users can gather intelligence on version distributions and common feature deployments without direct network engagement.

```python
import shodan

api = shodan.Shodan('YOUR_API_KEY')
results = api.search('port:3389')
for service in results['matches']:
    print(service['ip_str'], service['data'])
```

By querying these services, security professionals can gain a wide-angle view of RDP deployments and their vulnerabilities worldwide.

#### Advanced Fingerprinting Techniques

**TLS Fingerprints for RDP**

TLS fingerprinting involves analyzing the SSL/TLS handshake to identify RDP server variants and features. By matching unique fingerprint signatures against known version templates, experts can deduce the specific version and supported features.

**Banner Grabbing**

Banner grabbing techniques involve extracting the service banner of RDP servers, which often display version and feature information in plaintext. Tools specialized in scripted banner grabbing can automate this process, streamlining the collection of useful data for analysis.

By employing these methodologies and tools, cybersecurity professionals can effectively determine the version and characteristics of RDP implementations, allowing for precise vulnerability assessments and informed security posture evaluations.