---
title: Identify MSSQL Services on Network Effectively
description: Learn how to identify MSSQL services on a network using scanning, interrogation,
  and authentication techniques.
keywords:
- MSSQL services
- network scanning
- Nmap MSSQL
- Metasploit MSSQL
- database enumeration
- SMB LDAP query
- protocol analysis
- brute-force authentication
- traffic inspection
- asset inventory
---

## Identifying MSSQL Services on Network

### Network Scanning Techniques

**Port Scanning for MSSQL**

The primary step to identify SQL services is to scan the network for open ports associated with Microsoft SQL Server. The default port for MSSQL is 1433, but it can be configured to run on non-standard ports. Utilize the Nmap tool to conduct this scan:

```shell
nmap -p 1433 --open <target_network>
```

This command scans the entire specified network for open port 1433 indicating an actively listening MSSQL service. 

Advanced scanning techniques such as SYN and ACK scans are useful for evading firewall rules or filters that block standard scan types. A SYN scan identifies open ports without completing the TCP handshake, which is less likely to be logged:

```shell
nmap -sS -p 1433 <target_network>
```

**Network Sweeping for MSSQL**

For a broader initial analysis, network sweeps detect live hosts that might potentially host various services, including MSSQL. A simple ping sweep can identify which hosts are responsive, upon which further targeted scans can be executed.

```shell
fping -a -g <start_IP>-<end_IP>
```

### Advanced Network Enumeration

**Service Interrogation with Scripts**

Once potential MSSQL services are identified via open ports, deeper interrogation is possible using scripts. Nmap provides specialized scripts, like `ms-sql-info`, that perform a detailed probe of the service:

```shell
nmap --script ms-sql-info -p 1433 <target_host>
```

This script retrieves SQL server details, including server name, version, and edition details, providing a crucial understanding of the service environment.

**Utilizing Metasploit for MSSQL Discovery**

The Metasploit Framework offers auxiliary modules to facilitate MSSQL discovery, enhancing the scan capabilities with its rich module library:

```shell
use auxiliary/scanner/mssql/mssql_ping
set RHOSTS <target_network>
run
```

This operation leverages the `mssql_ping` module to not only ping the server but gather additional MSSQL-specific responses, aiding in confirming the presence of SQL services.

### Direct Connection and Authentication Methods

**SMB and LDAP Association**

Analyzing SMB (Server Message Block) shares and querying LDAP (Lightweight Directory Access Protocol) can uncover associations between network services and known or suspected MSSQL instances, providing additional search vectors:

```shell
smbclient -L <ip_address> -U <username>
```

Performing SMB enumeration might reveal shared directories hinting at SQL installations. Similarly, LDAP queries can identify directory-based configurations:

```shell
ldapsearch -x -b "dc=example,dc=com"
```

**Brute-Force Authentication Attempts**

Once an MSSQL service is located, penetration testers might conduct brute-force attempts to gain access, testing for default or weak credentials using automated tools such as Hydra:

```shell
hydra -t 16 -l sa -P /usr/share/wordlists/rockyou.txt mssql://<ip_address>
```

This command attempts a dictionary attack using the `rockyou.txt` wordlist against the MSSQL service login, assuming the 'sa' account is enabled.

### Protocol Analysis

**Traffic Inspection Techniques**

Real-time traffic inspection using a tool like Wireshark allows the capture and analysis of ongoing MSSQL communication. Monitoring specific MSSQL-related packets can confirm service activity:

```shell
wireshark -i <interface> -f 'tcp port 1433'
```

Filtering for the specific TCP port quickly isolates packets related to SQL communications for detailed inspection.

**Banner Grabbing via TCP**

Banner grabbing is a technique of opening a TCP connection and reading the initial response to gather service data. Tools like Netcat are useful to execute this:

```shell
nc -v <ip_address> 1433
```

Issuing this command opens a connection to a suspected SQL service, potentially returning banner information that includes version details.

### Cross-Reference with Organization Assets

**Asset Inventory Correlation**

Cross-referencing discovered MSSQL services with the organization's asset inventory often verifies findings. Mapping results to known or expected service deployments may reveal discrepancies or unauthorized installations, providing better situational awareness and risk assessment.

By layering these methods, it becomes possible to accurately map MSSQL services on a network, yielding vital information to spearhead subsequent offensive or defensive cybersecurity actions. This structured approach ensures that even hidden or obfuscated services are identified and assessed effectively.