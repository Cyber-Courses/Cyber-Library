---
title: 'Understanding XPath Injection: A Comprehensive Guide'
description: Learn how to identify and exploit XPath injection vectors in web applications
  with our comprehensive guide on injection basics.
keywords:
- XPath injection
- boolean logic injection
- predicate injection
- comment injection
- authentication bypass
- XPath syntax errors
---

# Injection Basics

## Context

    The objective of this article is to equip you with the knowledge and techniques necessary to identify, craft, and exploit basic XPath injection vectors within web applications. Before diving into the practical aspects of XPath injection, it is assumed that you are already familiar with XML document structures, XPath query syntax, and the typical flow of requests and responses in web applications.

## Theory

### XPath Injection Fundamentals

    XPath injection is a technique used to manipulate XPath queries through unsanitized user input, thereby altering how XML data is retrieved. At the core of this attack is the concept that user inputs, when directly integrated into XPath queries without proper sanitization, can modify the logic or structure of the queries. This vulnerability is particularly prevalent in applications that construct XPath queries using string concatenation methods.

### Boolean Logic Injection in XPath

    Boolean logic injection exploits the ability to insert always-true expressions such as `' or '1'='1`. By injecting such predicates, attackers can force the query to evaluate under conditions that bypass any intended constraints, allowing unauthorized access or disclosure of information.

### Predicate and Comment Injection

    Predicate injection involves modifying or appending conditions within XPath predicates by using crafted input. Complementarily, comment injection uses XPath comments such as `//` to truncate or neutralize parts of the query, potentially bypassing crucial logical checks or security constraints.

### XPath Syntax Errors and Exploitation

    Introducing malformed input into an XPath query can trigger syntax errors. These errors often reveal the structure of the query or result in the disclosure of error messages. By submitting invalid input, an attacker can obtain valuable information about the backend processes and further exploit the vulnerability.

## Practice

### Boolean-Based XPath Injection for Authentication Bypass

    - Identify a login or input field that feeds user-controlled data into an XPath query.
    - Inject a classic always-true predicate:
        ```http
        ' or '1'='1
        ```
    - For double-quoted contexts, send:
        ```http
        " or "1"="1
        ```
    - Combine numeric and string logic when needed:
        ```http
        x' or 1=1 or 'x'='y
        ```
    - Confirm unauthorized access or logic bypass to validate the vulnerability.

### Predicate and Comment Injection for Query Manipulation

    - Terminate predicates with:
        ```http
        ' or ''='
        ```
    - Add logic that forces true evaluation:
        ```http
        ' or 1=1 or 'a'='a
        ```
    - Truncate trailing query logic via comments:
        ```http
        ' or '1'='1' //
        ```
    - Monitor responses for altered query execution or disclosure of structure.

### XPath Syntax Error Induction for Information Disclosure

    - Break the query with an unmatched single quote:
        ```http
        '
        ```
    - Repeat with a double-quote payload:
        ```http
        "
        ```
    - Capture verbose errors or stack traces that reveal the query structure.

## Tools

    - **Burp Suite**
    - **OWASP ZAP**
