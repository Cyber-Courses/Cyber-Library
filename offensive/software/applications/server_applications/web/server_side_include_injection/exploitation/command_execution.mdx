---
title: 'Command Execution: SSI Injection Exploitation Guide'
description: Learn how to execute commands via SSI injection on vulnerable web servers
  for ethical hacking and penetration testing.
keywords:
- SSI command execution
- arbitrary command execution
- SSI injection
- server side include
- command injection
- web server exploitation
- Metasploit SSI
- cybersecurity
- ethical hacking
- penetration testing
---

# Command Execution

## Context

In this article, we will explore the offensive technique of exploiting Server Side Include (SSI) injections for executing arbitrary commands on vulnerable web servers. This technique can be utilized to gain unauthorized access and control over web servers. The reader is assumed to be familiar with Server Side Includes, web server configuration, basic shell commands, and the fundamental concept of SSI Injection.

## Theory

### SSI Command Execution Mechanism

Server Side Include (SSI) command execution exploits the `<!--#exec cmd="..."-->` directive within SSI-capable web servers. This directive allows the injection and execution of system commands through user inputs that are processed by the server. When a server is configured to permit SSI and improperly sanitizes user inputs, it becomes vulnerable to command injection attacks, which can enable attackers to execute shell commands.

### Attack Sequence for SSI Command Execution

The typical sequence for exploiting SSI command execution is as follows:

1. Identify the SSI injection point within a web application.
2. Inject a command using the `<!--#exec cmd="..."-->` directive.
3. Trigger the server’s SSI processing to execute the command.
4. Retrieve any resulting output from the executed command to confirm success.

```mermaid
flowchart TD
A[Find SSI Injection Point] --> B[Inject <!--#exec cmd="id"-->]
B --> C[Web Server Processes SSI]
C --> D[Command Executed]
D --> E[Output Returned to Attacker]
```

### Security Implications of Arbitrary Command Execution

The capability to execute arbitrary commands through SSI injection can lead to severe security implications. Attackers may gain full system access, allowing for data exfiltration, further lateral movement within a network, and even full system compromise. Typically, web servers assume SSI inputs to be sanitized or inherently trusted, which unfortunately, enlarges the attack surface for potential adversaries.

## Practice

### Manual SSI Command Execution via Injection

To perform SSI command execution manually, follow these steps:

- Craft an SSI payload designed to execute a shell command. For instance, to execute the `id` command, utilize the following payload:

    ```html
    <!--#exec cmd="id"-->
    ```

- Submit this payload to an identified SSI injection point, which might be found via web forms or file upload features in the application.
- Engage the web server’s SSI processing capabilities, such as by accessing the webpage or uploaded file to prompt the server to process the injected SSI command.
- Examine the HTTP response or resulting rendered page for command execution output, verifying that the command was successfully executed.

### Automated SSI Command Execution with Metasploit

Automated approaches for SSI command execution can leverage tools such as Metasploit. Follow these steps for automation:

- Open a terminal and execute the following command to initiate Metasploit:

    ```bash
    msfconsole -q -x 'use exploit/multi/http/ssi_exec; set RHOSTS <target>; set TARGETURI <vulnerable_path>; run'
    ```

    This command will load and execute the SSI exec module in Metasploit against the specified target.

- Upon successful command injection, you can interact with the opened Metasploit session to issue and control further commands on the target server.

## Tools

- **Metasploit**
- **Burp Suite**
- **curl**

This detailed write-up allows the reader to execute both manual and automated SSI command injections effectively, leveraging industry-standard tools to further explore and exploit vulnerabilities in real-world settings.