---
title: Mastering Injection Basics for SSI Exploitation
description: Learn how to exploit server-side includes with foundational SSI injection
  techniques for dynamic content manipulation and server-side attack vectors.
keywords:
- SSI injection
- server-side includes
- dynamic content manipulation
- SSI directives
- server-side exploitation
- file metadata disclosure
- dynamic file inclusion
- variable printing
- document name injection
---

# Injection Basics

## Context

The goal of this guide is to demonstrate foundational Server Side Include (SSI) injection techniques used to manipulate server-side content. These techniques leverage basic SSI directives to affect how server-side environments handle and display data. Before proceeding, readers should understand the purpose and functions of SSI, how web servers configure SSI processing, and the general concept of server-side injection.

## Theory

### SSI Directive Syntax and Injection Points

SSI directives use HTML comments and are processed by web servers before delivering the response to the user. The core principle of SSI injection is exploiting user input that is reflected in SSI-processed content, which allows the insertion of malicious directives. Attackers typically identify input points that are reflected in SSI contexts, craft appropriate payloads, and then observe the server-side effects to confirm the efficacy of their attacks.

### Common SSI Directives for Injection

Several SSI directives are commonly used in injection attacks:

- `<!--#echo -->` is used to print environment variables or user-supplied values.
- `<!--#include -->` allows content from files or URLs to be inserted into the HTTP response.
- `<!--#config -->` can change SSI output formatting, such as setting custom error messages or date formats.
- `<!--#fsize -->` displays the size of a specified file.
- `<!--#flastmod -->` shows the last modification date of a file.

### Dynamic Include and Variable Printing Mechanisms

Dynamic inclusion involves attackers controlling which file or resource is injected into the serverâ€™s response. This becomes particularly potent when the attacker can specify file or URL parameters dynamically. Variable printing refers to the ability to output server environment variables or user-controlled data, often leveraged by attackers to reveal sensitive information.

### Document Name and Header Injection

SSI directives can also be injected through document names or HTTP headers if these are reflected in SSI-processed content areas. Applications that reflect user input into SSI contexts without proper sanitization are particularly vulnerable to these types of injections.

## Practice

### Injecting SSI Echo Directive for Variable Printing

- **Payload**: `<!--#echo var="HTTP_USER_AGENT" -->`
  - Inject this payload into a field reflected in an SSI-processed page, such as the User-Agent HTTP header.
  - **Observation**: Check if your User-Agent value gets reflected in the server's response, confirming SSI injection and variable printing.

### Injecting SSI Include Directive for Dynamic File Inclusion

- **Payload**: `<!--#include file="/etc/passwd" -->`
  - Target this payload at a parameter or field that is reflected in an SSI context.
  - **Observation**: Verify whether the content of the `/etc/passwd` file appears in the HTTP response to validate dynamic file inclusion.

### Injecting SSI Config Directive to Manipulate Output Formatting

- **Payload**: `<!--#config errmsg="SSI Error Detected" -->`
  - Use this to alter error message outputs for subsequent SSI errors.
  - **Observation**: Trigger an SSI error and check if the custom error message appears, confirming output manipulation capabilities.

### Injecting SSI Fsize and Flastmod Directives for File Metadata Disclosure

- **Payload**: `<!--#fsize file="/etc/passwd" -->` and `<!--#flastmod file="/etc/passwd" -->`
  - These payloads will display file size and modification date for `/etc/passwd`.
  - **Observation**: Look for file size and modification date details in the HTTP response, indicating successful metadata disclosure via SSI.

### Document Name and Header Injection for SSI Execution

- **Technique**: Rename an uploaded file to include SSI directives, e.g., `index.html<!--#echo var="DOCUMENT_NAME" -->.shtml`.
- Set HTTP headers (e.g., User-Agent) to contain SSI payloads, targeting vectors where headers are reflected in SSI contexts.
- **Outcome**: Verify execution of SSI directives via either document names or HTTP headers, signaling bypass of input validation mechanisms.

## Tools

- **Burp Suite**
- **curl**