---
title: Exploiting Cart & Wishlist Vulnerabilities in Web Apps
description: Learn to exploit cart and wishlist vulnerabilities in web apps for unauthorized
  access and manipulation.
keywords:
- cart wishlist exploitation
- business logic flaws
- negative quantity handling
- inventory abuse
- cross-user tampering
---

# Cart/Wishlist Exploitation

## Context

The purpose of this guide is to enable offensive security practitioners to exploit business logic vulnerabilities within web applications, specifically targeting cart and wishlist functionalities. These features often contain flaws that can be manipulated for unauthorized benefits or to disrupt business processes. To fully engage with this content, readers should have an understanding of HTTP requests, session management, web application architecture, and business logic errors.

## Theory

### Cart and Wishlist Feature Logic

Carts and wishlists are essential components of e-commerce platforms, allowing users to select products for purchase or future interest. However, these features can harbor business logic flaws if the application workflows do not adequately enforce intended rules and constraints, leading to exploitation opportunities.

### Common Exploitable Logic Flaws

Several types of vulnerabilities can arise in cart and wishlist functionalities:

- **Negative Quantity Handling**: When an application fails to properly validate quantities in a shopping cart, users might exploit the logic by inputting negative numbers, possibly reducing their total cost or gaining credits.
- **Overstock Cart Abuse**: This involves adding more items to a cart than the inventory system allows, often bypassing stock limitations enforced by the backend.
- **Wishlist Manipulation**: Inadequate access controls may enable unauthorized users to view or modify other users' wishlists.
- **Cross-User Cart Tampering**: Weak session management can lead to unauthorized tampering with another user's cart.
- **Cart Inventory Abuse**: Manipulating stock levels could deny availability to legitimate users or cause back-end processing errors.

### Attack Surface and Threat Model

Attacks typically involve manipulating cart and wishlist parameters using crafted HTTP requests. Attackers target weaknesses in input validation, session isolation, and authorization logic.

### Security Controls and Weaknesses

Certain controls, when absent or improperly implemented, contribute to these vulnerabilities:

- **Lack of CSRF Protection**: This enables unauthorized cart and wishlist actions.
- **Insufficient Input Validation**: Permits negative or excessively high quantities in cart manipulation.
- **Missing Authorization Checks**: Allows cross-user data access or unauthorized modifications.

## Practice

### Negative Quantity Cart Exploit

To exploit the handling of negative quantities in a cart:

- Intercept a cart update request and modify the quantity to a negative value. This alters the expected logic of purchase calculations.
  
  ```bash
  curl -b cookies.txt -X POST 'https://target.com/cart/update' -H "Content-Type: application/x-www-form-urlencoded" -d 'item_id=123&quantity=-5'
  ```

  Outcome: Successful execution may result in a manipulated cart total, possibly granting credits or free items.

### Overstock Cart Abuse

Exploiting overstock cart abuse involves:

- Adding more items to a cart than currently available in inventory to test stock enforcement.

  ```bash
  curl -b cookies.txt -X POST 'https://target.com/cart/add' -d 'item_id=456&quantity=9999'
  ```

  Outcome: Bypassing inventory logic could block others from purchasing or trigger application errors.

### Cross-User Wishlist Manipulation

To exploit cross-user wishlist manipulation:

- Access or modify another user's wishlist by altering user identifiers in the HTTP request. This tests the robustness of authorization mechanisms.

  ```bash
  curl -b cookies.txt 'https://target.com/wishlist/view?user_id=42'
  ```

  ```bash
  curl -b cookies.txt -X POST 'https://target.com/wishlist/add' -d 'user_id=42&item_id=789'
  ```

  Outcome: Unauthorized access or modification of another user's wishlist demonstrates flaw exploitation.

### Cart Inventory Abuse for Denial of Service

To perform a denial of service against cart inventory:

- Add all of the available stock of a specific product to a cart, preventing other users from purchasing it.

  ```bash
  curl -b cookies.txt -X POST 'https://target.com/cart/add' -d 'item_id=321&quantity=100'
  ```

  Outcome: This can exhaust product availability, denying service to other users.

## Tools

- **Burp Suite**
- **OWASP ZAP**
- **curl** 

These tools aid in the interception and crafting of HTTP requests, necessary for exploiting cart and wishlist vulnerabilities.