---
title: Optimize SQLMap with Preprocess and Postprocess
description: Learn to enhance SQLMap operations using preprocess and postprocess for
  efficient request and response management.
keywords:
- sqlmap
- preprocess
- postprocess
- request manipulation
- response parsing
- automation
- HTTP requests
- HTTP responses
- SQL injection
---

# Preprocess/Postprocess

## Context

This article focuses on using sqlmap's preprocess and postprocess options for request manipulation and response parsing. It assumes knowledge of HTTP requests, HTTP responses, and the basics of SQL injection.

## Theory

### Preprocessing in SQLMap

Preprocessing in sqlmap involves modifying HTTP requests before they are sent. This customization is critical for bypassing filters or adding necessary headers that might be required for certain injection scenarios. By automating request modifications, preprocessing enables attackers to handle complex injection sequences effortlessly. Leveraging preprocessing scripts, you can tailor requests to meet specific attack needs, allowing for more refined control over the injection process.

### Postprocessing in SQLMap

Postprocessing, on the other hand, deals with analyzing HTTP responses after sqlmap receives them. This feature is vital for extracting specific data from responses, particularly in attacks where the goal is to identify and exploit SQL injection vulnerabilities. By implementing custom postprocessing scripts, attackers can automate the analysis of responses, streamlining the process of extracting valuable data and confirming the success of injection attempts.

### Automation Chain with Preprocess/Postprocess

Combining preprocessing and postprocessing creates a powerful automation chain. This integration supports seamless handling of both request and response scenarios, enabling attackers to manage complex workflows efficiently. By chaining preprocess and postprocess scripts, you can automate the intricacies of request modification and response parsing, effectively heightening the sophistication and efficiency of the attack operation.

## Practice

### Using Preprocess Option

To utilize the preprocess option in sqlmap, you can execute commands with custom preprocessing scripts that modify HTTP requests before they are sent to the server.

```bash
sqlmap -u "http://example.com/vuln" --preprocess=preprocess_script.py
```

#### Preprocessing Python Script

Here is an example of a simple Python script for preprocessing:

```python
# preprocess_script.py
import sys
from urllib.parse import urlparse

def preprocess_request(request):
    # Example: Add a custom header
    request.headers['Custom-Header'] = 'Value'
    return request

if __name__ == "__main__":
    # Read the request from stdin, process it and write to stdout
    request_data = sys.stdin.read()
    # Mock request manipulation
    modified_request = preprocess_request(request_data)  
    sys.stdout.write(modified_request)
```

The effect of this script is modifying the requests to bypass input validation filters by adding custom headers.

### Using Postprocess Option

To employ the postprocess option, run sqlmap with scripts designed to parse and analyze HTTP responses.

```bash
sqlmap -u "http://example.com/vuln" --postprocess=postprocess_script.py
```

#### Postprocessing Python Script

Below is an example of a Python script for postprocessing:

```python
# postprocess_script.py
import sys

def parse_response(response):
    # Example: Extract and log specific data from responses
    sensitive_data = "Extracted data: " + response
    return sensitive_data

if __name__ == "__main__":
    # Read the response from stdin, process it, and write to stdout
    response_data = sys.stdin.read()
    # Process response data
    extracted_data = parse_response(response_data)
    sys.stdout.write(extracted_data)
```

This results in the parsing and extraction of sensitive data from HTTP responses.

### Chaining Preprocess and Postprocess

To use both preprocessing and postprocessing in a single sqlmap run:

```bash
sqlmap -u "http://example.com/vuln" --preprocess=preprocess_script.py --postprocess=postprocess_script.py
```

By chaining these scripts, the attacker can automate the handling of complex injection scenarios, facilitating protocol abuse through structured and automated request processing and response analysis.

## Tools

- **sqlmap**