---
title: Using Conditional Statements for MySQL SQL Injection
description: Learn to exploit MySQL time-based SQL injection using conditional statements
  to infer data through response delays.
keywords:
- MySQL
- SQL injection
- conditional statements
- time-based attacks
- SLEEP function
- BENCHMARK
- IF statements
- database exploitation
---

# Using Conditional Statements

## Context

The objective of this guide is to teach how to exploit MySQL time-based SQL injection using conditional statements. This technique leverages the ability to evaluate expressions within SQL queries to infer database information based on response times. It assumes that readers have prior knowledge of conditional statements, time functions, and general MySQL time-based injection techniques.

## Theory

### Conditional Statements in SQL Injection

Conditional statements in SQL are used to evaluate expressions that control the flow of SQL queries. They can manipulate query logic depending on whether certain conditions are met, returning different outcomes based on true/false evaluations. This ability to execute alternate paths in SQL queries is core to crafting successful injections, especially in time-based attacks.

### Time Functions in MySQL

MySQL includes functions like `SLEEP()` and `BENCHMARK()` that can introduce delays in query execution. By leveraging these functions, attackers can construct queries that cause measurable time delays, allowing them to infer database states or information based on how long a response takes to return. This technique is known as time-based SQL injection and is potent when the attacker cannot directly view the data but can measure response times.

### Combining Conditional Statements with Time Functions

The power of conditional statements when combined with time functions lies in the ability to craft nuanced attacks that delay responses only under specific conditions. By using the `IF()` function in conjunction with `SLEEP()`, attackers can create queries that delay execution only if certain conditions are trueâ€”effectively allowing them to "ask" the database questions and get binary (true/false) answers based on response times.

## Practice

### Exploiting Conditional Time-Based SQL Injection

- **Identify Injectable Parameter**: Begin by locating a parameter in the web application that seems vulnerable to SQL injection. This often involves trial and error using tools like Burp Suite to inject various SQL snippets and observe for anomalous behavior.

- **Craft Basic Conditional Payload**:
    ```bash
    SELECT IF(1=1, SLEEP(5), 0); -- True condition, induces delay
    ```
  This simple payload will cause a delay if the condition (1=1) evaluates to true.

- **Test False Condition**:
    ```bash
    SELECT IF(1=0, SLEEP(5), 0); -- False condition, no delay
    ```
  This is expected to return instantly without delay, as the condition (1=0) is false.

- **Extract Data via Conditional Delays**:
    - **Determine Current Database User**:
        ```bash
        SELECT IF((SELECT user())='root', SLEEP(5), 0); -- Delays if true
        ```

    By crafting queries such as the above, an attacker can infer response delays that reveal whether certain data matches expected values (e.g., if the current user is 'root').

**Result**: By analyzing response times to these crafted SQL queries, the attacker can extract sensitive database information such as user roles and other configuration details that can be pivotal in crafting further attacks.

## Tools

- **sqlmap**: An automated tool for SQL injection and database takeover.
- **Burp Suite**: A powerful web vulnerability scanner that facilitates manual testing and injection discovery. 

By following these instructions, a user should be able to understand and apply conditional time-based SQL injection methods effectively in a controlled test environment.