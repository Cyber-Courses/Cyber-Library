---
title: Exploiting XXE for Advanced SSRF Attacks
description: Learn how to leverage XXE vulnerabilities for performing SSRF attacks,
  breaching network barriers and accessing sensitive data.
keywords:
- Exploiting XXE
- SSRF attacks
- XML external entity
- network segmentation bypass
- HTTP request manipulation
- cybersecurity
- server-side request forgery
---

# Exploiting XXE to Perform SSRF Attacks

## Context

This article aims to demonstrate how XML External Entity (XXE) vulnerabilities can be exploited to perform Server-Side Request Forgery (SSRF) attacks. By chaining these two vulnerabilities, an attacker can pivot around network boundaries, access internal resources, and potentially gather sensitive information from systems that are not directly accessible. To follow this guide, you should be familiar with XML parsing, entity expansion, the structure and function of HTTP requests, as well as the fundamentals of XXE and SSRF vulnerabilities.

## Theory

### Chaining XXE to SSRF

To understand how XXE can be leveraged to perform SSRF attacks, it's crucial to grasp the concept of chaining these two vulnerabilities. An XXE vulnerability allows an attacker to inject a malicious XML DOCTYPE declaration that defines an external entity. By carefully crafting this entity to reference internal network resources, the attacker can trick the server into making arbitrary HTTP requests.

The basic sequence of this attack involves crafting a DOCTYPE with an external entity, embedding the entity reference within an XML request, and delivering it to a vulnerable server. The server, processing the external entity, then makes an HTTP request to the attacker-specified target.

### Internal HTTP Request Manipulation

When a server processes a maliciously crafted XML with an XXE vulnerability, it might perform HTTP(S) requests to internal or restricted endpoints. This internal HTTP request manipulation can be leveraged to probe the internal network, exfiltrate data, or leverage internal services to launch further attacks.

Consider the data flow in this scenario: an attacker sends a malicious XML payload to a vulnerable server, which then makes an HTTP request to an internal service, potentially breaching network segmentation.

### Network Segmentation Bypass via SSRF

SSRF via XXE effectively turns the vulnerable server into a proxy, bridging the attacker's access to internal-only services. Once an attacker gains this foothold, they can enumerate internal networks, probe different services, or exfiltrate sensitive data, thereby bypassing typical network segmentation defenses.

The attack sequence includes using the XXE vulnerability to introduce SSRF payloads, examining internal network responses, and potentially abusing exposed services or data through this indirect access.

## Practice

### Manual Exploitation of XXE for SSRF

This section details the steps to manually exploit XXE vulnerabilities to perform SSRF attacks.

1. **Craft a Malicious XML Payload**  
    Define an external entity referencing an internal HTTP service using the following XML payload:

    ```xml
    <!DOCTYPE root [<!ENTITY xxe SYSTEM "http://127.0.0.1:8080/admin">]>
    <root>&xxe;</root>
    ```

2. **Send the Prepared Payload**  
    Use a tool like `curl` to send the payload to the vulnerable endpoint:

    ```bash
    curl -X POST -H "Content-Type: application/xml" --data-binary @malicious.xml https://target-app/upload
    ```

3. **Observe the Outcome**  
    Monitor internal service logs or side effects that indicate the server processed the request, looking for responses or behavior resulting from the SSRF attempt.

### Automated SSRF via XXE Using Burp Suite

For a more automated approach, we utilize Burp Suite for intercepting and modifying XML requests.

1. **Intercept XML Request**  
    Use Burp Suite Proxy to intercept the XML request sent to the server.

2. **Modify the Request with a Malicious Payload**  
    Insert an external entity payload that targets an internal network resource:

    ```xml
    <!DOCTYPE root [<!ENTITY xxe SYSTEM "http://192.168.1.10:8000/secret">]>
    <root>&xxe;</root>
    ```

3. **Forward the Request**  
    Forward the modified request to the server, observing its response.

4. **Analyze the Response**  
    Examine server responses or internal service logs for evidence of the SSRF attack, indicating successful exploitation.

## Tools

- **Burp Suite**
- **curl**