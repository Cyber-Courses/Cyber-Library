---
title: 'Classic XXE: Exploiting XML Entities'
description: Learn how Classic XXE exploits XML parsers to access files on Linux and
  Windows systems via external entities.
keywords:
- Classic XXE
- XML External Entity
- file disclosure
- Linux
- Windows
- DTD
- public entity
- XXE attack
- vulnerability
- XML parsing
---

# Classic XXE

## Context

The objective of exploring Classic XXE (XML External Entity) is to learn how to exploit XML parsers to retrieve files from targeted Linux and Windows systems. This technique uses public entity payloads to demonstrate how attackers can leverage vulnerabilities to extract sensitive information. Readers should already have an understanding of XML structure and parsing, DTD and entity declaration basics, and the general concept of XML External Entity Injection.

## Theory

### Classic XXE Attack Fundamentals

Classic XXE attacks exploit the capability of XML parsers to resolve external entities. In these attacks, an attacker defines a public entity within the Document Type Definition (DTD) of an XML file, referencing a sensitive file on the system using a `file://` URI. The malicious DTD is then processed by the XML parser, which will attempt to resolve the entity by accessing the file. This results in file content being included in the XML response sent back to the attacker.

### File Access via XXE on Linux and Windows

Vulnerable XML parsers are susceptible to file disclosure attacks if they have not been securely configured to disable external entity resolution. When these parsers encounter a `file://` URI in an entity definition, they indiscriminately attempt to access the specified file. The trust assumption here is that the application does not scrutinize XML inputs or restrict entity resolution and file URI schemes. The standard data flow involves XML input being processed by the vulnerable parser, leading to sensitive file data being read and included in the server response.

### Public Entity Usage in Classic XXE

A public entity in the context of XXE is an entity declared in the DTD. It is then referenced within the XML content to trigger an access to local files. During an attack, the malicious actor declares this entity in the DTD and references it within the XML document. Resolving this entity causes the server to access and return the contents of the file specified in the entity declaration.

## Practice

### Classic XXE File Disclosure on Linux

To exploit a vulnerable XML parser on a Linux server using a Classic XXE attack, follow these steps:

- Craft the payload with the following XML content to retrieve the `/etc/passwd` file:

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
    <foo>&xxe;</foo>
    ```

    This payload defines a public entity that attempts to access the `/etc/passwd` file.

- Submit the payload to the target application that uses the vulnerable XML endpoint. This can often be accomplished by sending the XML in a POST request to the application.

- Analyze the server’s response. If the attack is successful, the response content will include the contents of the `/etc/passwd` file, allowing you to gain access to sensitive information typically found in this file.

### Classic XXE File Disclosure on Windows

To apply the Classic XXE technique against a Windows server, use the following steps:

- Construct the XML payload to target the `C:\Windows\win.ini` file:

    ```xml
    <?xml version="1.0"?>
    <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///C:/Windows/win.ini"> ]>
    <foo>&xxe;</foo>
    ```

    This payload attempts to retrieve the contents of the `win.ini` file.

- Send the payload to the susceptible XML processor. This is typically done using a POST request directed to the endpoint that processes XML.

- Examine the response for the contents of `win.ini`. A successful attack will result in this file’s contents being included in the server’s response.

In both scenarios, a successful XXE attack leads to an unauthorized disclosure of sensitive file contents. The effectiveness of this technique hinges on the server's configuration and its handling of XML external entities.

## Tools

- **Burp Suite**
- **curl**