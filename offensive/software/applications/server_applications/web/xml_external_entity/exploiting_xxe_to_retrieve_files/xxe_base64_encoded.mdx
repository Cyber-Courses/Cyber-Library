---
title: Exploit XXE with Base64 Encoding Techniques
description: Learn how to use base64 encoding in XXE attacks to bypass filters and
  securely retrieve files.
keywords:
- XXE
- base64 encoding
- data URI scheme
- file retrieval
- obfuscation techniques
- vulnerability exploitation
- XML security
---

# XXE Base64 Encoded

## Context

This article discusses how to exploit XML External Entity (XXE) vulnerabilities using base64 encoding to retrieve files from a server. This technique leverages the data URI scheme to encode file contents, allowing the attacker to bypass certain filters and obfuscate payloads. Readers should have a foundational understanding of XML structure, base64 encoding, and classic XXE exploitation techniques, including other XXE variants like PHP wrapper and XInclude attacks.

## Theory

### Data URI Scheme in XXE

The data URI scheme allows embedding data directly within a URI, supporting various media types and encodings. When applied in XXE exploitation, this approach permits attackers to encode the contents of a file as base64 data, potentially evading input filters designed to thwart traditional file retrieval methods.

### Base64 Encoding Mechanism in XXE

Base64 encoding is used to transform binary or text data into ASCII format, making it suitable for transmission in XML documents. Within an XXE context, an attacker can craft a payload that references a file through a data URI containing a base64-encoded representation of that file. This encoded format ensures that the payload avoids potential detection by filters that might otherwise block suspicious direct access patterns.

### Obfuscation and Filter Bypass via Base64

Base64-encoded data URIs can successfully evade filters that explicitly block access attempts using the `file://` schema or detect restricted keywords. Applications that parse XML and resolve external entities without properly scrutinizing these encoded URIs are susceptible to this type of XXE attack.

### File Retrieval via Base64-Encoded XXE

The sequence for retrieving a file using a base64-encoded XXE payload involves:

1. **Defining an External Entity**: This references the target file using a data URI with base64 encoding.
2. **Referencing the Entity in XML**: The defined entity is invoked within the XML content.
3. **Receiving the Response**: The application returns the base64-encoded file content as part of its response.

## Practice

### Retrieve Local File via Base64-Encoded XXE Payload

To exploit a vulnerability using this technique, follow these steps:

- **Craft the Payload**:
  ```xml
  <!DOCTYPE foo [<!ENTITY xxe SYSTEM "data://text/plain;base64,/etc/passwd">]>
  <root>&xxe;</root>
  ```
  This XML payload defines an external entity that references the `/etc/passwd` file encoded using a data URI with base64 encoding.

- **Submit the Payload**: 
  Send the crafted payload to the vulnerable endpoint using an HTTP POST request or any method that the application supports. 

- **Capture the Response**:
  After submission, capture the application's response, which should contain the base64-encoded content of the file defined in the payload.

- **Decode the File Content**:
  Use the command below to decode the base64 string retrieved from the response:
  ```bash
  echo '<base64_string>' | base64 -d
  ```
  Replace `<base64_string>` with the actual base64 data obtained to reveal the file contents.

Successful execution will result in access to the contents of a local file, bypassing direct file retrieval restrictions inherent to the applicationâ€™s filters.

## Tools

- **Burp Suite**
- **curl**
- **base64**