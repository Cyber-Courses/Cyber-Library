---
title: 'Understanding XPath Injection: A Comprehensive Guide'
description: Learn how to identify and exploit XPath injection vectors in web applications
  with our comprehensive guide on injection basics.
keywords:
- XPath injection
- boolean logic injection
- predicate injection
- comment injection
- authentication bypass
- XPath syntax errors
---

# Injection Basics

## Context

The objective of this article is to equip you with the knowledge and techniques necessary to identify, craft, and exploit basic XPath injection vectors within web applications. Before diving into the practical aspects of XPath injection, it is assumed that you are already familiar with XML document structures, XPath query syntax, and the typical flow of requests and responses in web applications.

## Theory

### XPath Injection Fundamentals

XPath injection is a technique used to manipulate XPath queries through unsanitized user input, thereby altering how XML data is retrieved. At the core of this attack is the concept that user inputs, when directly integrated into XPath queries without proper sanitization, can modify the logic or structure of the queries. This vulnerability is particularly prevalent in applications that construct XPath queries using string concatenation methods.

### Boolean Logic Injection in XPath

Boolean logic injection exploits the ability to insert always-true expressions such as `' or '1'='1`. By injecting such predicates, attackers can force the query to evaluate under conditions that bypass any intended constraints, allowing unauthorized access or disclosure of information.

### Predicate and Comment Injection

Predicate injection involves modifying or appending conditions within XPath predicates by using crafted input. Complementarily, comment injection uses XPath comments (e.g., // or #) to truncate or neutralize parts of the query, potentially bypassing crucial logical checks or security constraints.

### XPath Syntax Errors and Exploitation

Introducing malformed input into an XPath query can trigger syntax errors. These errors often reveal the structure of the query or result in the disclosure of error messages. By submitting invalid input, an attacker can obtain valuable information about the backend processes and further exploit the vulnerability.

## Practice

### Boolean-Based XPath Injection for Authentication Bypass

- **Identify a Login or Input Field**: Look for forms or areas where user input feeds into an XPath query. These are prime targets for injection.
  
- **Submit a Payload**:
    - Inject the classic always-true condition with: 

    ```plaintext
    ' or '1'='1
    ```

    - For double-quoted queries, use:

    ```plaintext
    " or "1"="1
    ```

    - To combine numeric and string logic, try:

    ```plaintext
    x' or 1=1 or 'x'='y
    ```

- **Observe the Behavior**: If submission of these payloads results in unauthorized access or indicates that security controls have been bypassed, the application is vulnerable to XPath injection.

### Predicate and Comment Injection for Query Manipulation

- **Craft and Submit a Payload**:
    - To terminate predicates and insert logic, use:

    ```plaintext
    ' or ''='
    ```

    - Introduce logic to bypass checks with:

    ```plaintext
    ' or 1=1 or 'a'='a
    ```

    - Truncate additional query logic using comments:

    ```plaintext
    ' or '1'='1' //
    ```

- **Monitor Results**: Test these payloads to see if they can alter query outcomes or reveal query structures.

### XPath Syntax Error Induction for Information Disclosure

- **Inject Malformed Input**:
    - Use an unmatched single quote to break syntax:

    ```plaintext
    '
    ```

    - Test with a double-quote variant:

    ```plaintext
    "
    ```

- **Watch for Errors**: Pay attention to the error messages or stack traces returned by the application, as they may expose the underlying query structure or additional vulnerabilities.

## Tools

- **Burp Suite**
- **OWASP ZAP**
- **Fiddler**

These tools can assist you in intercepting and modifying web traffic, performing XPath injection attacks, and analyzing the responses for vulnerabilities.