---
title: 'XPath Injection Evasion Techniques: Strategies & Tools'
description: Explore strategies for bypassing filters & WAFs in XPath injection attacks
  using evasion techniques with examples.
keywords:
- XPath injection
- evasion techniques
- filter bypass
- WAF bypass
- payload obfuscation
- comment encoding
- hex encoding
- case manipulation
---

# Evasion Techniques

## Context

This article focuses on operational evasion techniques used to bypass input validation filters and Web Application Firewalls (WAFs) during XPath injection attacks. The reader is expected to have an understanding of XPath syntax and query structures, XML document structures, and web application architectures. Additionally, familiarity with basic XPath injection methods, node and attribute traversal in XPath, and XPath function exploitation is assumed.

## Theory

### Filter and WAF Evasion in XPath Injection

Evasion techniques are designed to manipulate payloads in such a way that they bypass input validation filters or WAFs during an XPath injection attack. These measures are crucial because filters and WAFs often block known malicious patterns. Effective obfuscation can help bypass these controls. Vulnerabilities arise when input validation and filtering are incomplete, allowing carefully crafted payloads to pass through unnoticed.

### Encoding and Obfuscation Strategies

Encoding and obfuscation tactics involve altering the appearance of payloads without changing their underlying logic. This strategy is employed to evade pattern-based detection systems. Attackers may encode, substitute, or manipulate payload characters to bypass filters and subsequently execute an injection.

## Practice

### Bypassing Filters with XPath Comment Encoding

- **Payload:** `' or 1=1 (:`
- This technique injects a comment to terminate the XPath query, effectively evading simple pattern filters. The payload is accepted, bypassing input validation and executing the injection logic.

### Hex Encoding of XPath Payloads

- **Payload:** `' or 0x31=0x31 or 'a'='`
- By using hex encoding for numbers, attackers can bypass filters that block numeric literals. The hex-encoded values evade detection based on numeric pattern filters.

### Unicode Normalization Bypass

- **Payload:** `' or 1Ôºù1 or 'a'='`
- This technique substitutes a standard equals sign with its Unicode full-width variant to bypass strict filters. The Unicode character is accepted, enabling the injection to succeed without raising alarms.

### Double Encoding in XPath Injection

- **Payload:** `%27%20or%201%3D1%20or%20%27a%27%3D%27`
- Double encoding the URL allows the payload to evade filters that only decode once. As a result, the double-encoded payload passes through single-pass decoding filters, executing the injection logic.

### Case Manipulation in XPath Keywords

- **Payload:** `' Or 1=1 Or 'a'='`
- This approach alters the case of keywords to evade filters that are case-sensitive. The payload execution is successful as it bypasses filters matching only lowercase patterns.

### Whitespace Injection and Obfuscation

- **Payload:** `'\tor\t1=1\tor\t'a'='`
- Injecting tab characters as whitespace helps evade filters that expect spaces. This non-standard whitespace successfully bypasses space-only filters, enabling the injection.

### Character Substitution in XPath Operators

- **Payload:** `' or 1!=2 or 'a'='`
- Using alternative operators such as `!=` instead of `=` can help bypass filters that block strict equality checks. Operator substitution thus evades such controls.

### Null Byte Injection in XPath Payloads

- **Payload:** `' or 1=1 or 'a'='\u0000`
- Appending a null byte at the end of a string effectively terminates the string, allowing attackers to bypass filters that process inputs following a null byte. This truncated input bypasses filter logic, facilitating injection.

## Tools

- **Burp Suite**
- **OWASP ZAP**
- **curl** 

These tools are commonly used in the practice of testing and exploiting web application vulnerabilities, including XPath injection evasion techniques.