---
title: Blind XPath Exploitation Techniques
description: Learn blind XPath injection methods to extract data without direct output
  using boolean and time-based strategies.
keywords:
- blind XPath injection
- data extraction
- boolean-based extraction
- time-based XPath
- character-by-character
- web security
- XPath query manipulation
---

# Blind Exploitation

## Context

In the realm of web security, blind XPath injection represents a sophisticated technique used to extract sensitive information from a system without receiving direct feedback in the form of error messages or data outputs. This method requires a deeper understanding of XPath query manipulation and the ability to interpret subtle behavioral changes in the system's responses. Familiarity with XPath syntax, boolean logic, HTTP request-response models, and basic XPath injection techniques is assumed.

## Theory

### Blind XPath Injection Fundamentals

Blind XPath injection attacks occur when vulnerabilities in a web application allow an attacker to insert crafted XPath queries into a web request. While no direct outputs or error messages are returned, attackers can deduce information by noting variations in the applicationâ€™s behavior or response times.

### Boolean-Based Blind Extraction

This method relies on sending carefully structured payloads that can return a boolean result (true or false) to the attacker, who can then infer information from the presence or absence of certain behaviors in the application's HTTP responses, such as changes in content length or HTTP status codes.

### Character-by-Character Data Extraction

This approach involves extracting data one character at a time by using XPath functions such as `substring()`, `string-length()`, and `codepoints-to-string()`. By iteratively gauging each character using conditional logic, an attacker can gradually reconstruct sensitive information such as passwords or session tokens.

### Time-Based Blind XPath

Time-based blind XPath injection leverages time delays introduced into XPath queries that are conditionally true. This method exploits protocol weaknesses where XPath processors allow time-based functions which, when used correctly, can indicate true or false outcomes through measurable response delays.

## Practice

### Boolean-Based Blind XPath Extraction

- Identify a parameter vulnerable to XPath injection.
- Use a crafted payload to check if a certain condition is true. For example, to check if the length of the admin's password is 8:
  ```http
  ' or string-length(//user[username='admin']/password)=8 or '1'='2
  ```
- Observe any differences in the application's response to determine if the condition is met.
- Incrementally adjust your payload to determine the correct string length.
- For character-by-character extraction, start with testing specific characters:
  ```http
  ' or substring(//user[username='admin']/password,1,1)='a' or '1'='2
  ```
- Repeat the process for each character until the entire string is exfiltrated.

**Outcome**: Extracted sensitive data through logical boolean payloads, identifying the admin password.

### Time-Based Blind XPath Extraction

- Craft payloads that induce noticeable delays for true conditions using functions like `ms:delay()` if supported by the XPath processor:
  ```http
  ' or (substring(//user[username='admin']/password,1,1)='a' and ms:delay(5000)) or '1'='2
  ```
- Carefully measure the time taken to receive the response. A longer delay signifies a true condition, allowing inference of each character's correctness.

**Outcome**: Data extraction is achieved by associating response time with query results, deducing sensitive passwords cipher character.

### Automated Blind XPath Extraction with Character Set Brute Force

- Use a script or tool to automate the extraction process, making it faster and reducing manual efforts, as shown in this pseudocode:
  ```python
  for i in range(1, password_length+1):
      for c in charset:
          payload = f"' or substring(//user[username='admin']/password,{i},1)='{c}' or '1'='2"
          send_request(payload)
          if response_indicates_true():
              password += c
              break
  ```
- The script iterates over each character position, testing against a character set to reconstruct the entire string value automatically.

**Outcome**: Automated character-by-character extraction of sensitive data using blind XPath injection.

## Tools

- **Burp Suite**
- **OWASP ZAP**
- **custom Python scripts**