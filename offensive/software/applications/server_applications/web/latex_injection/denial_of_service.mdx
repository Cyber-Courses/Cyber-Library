---
title: Denial of Service in LaTeX Web Applications
description: Learn how LaTeX injection can lead to denial-of-service attacks by exhausting
  server resources and disrupting web applications.
keywords:
- Denial of Service
- LaTeX injection
- resource exhaustion
- infinite loops
- recursive macro expansion
- web server vulnerability
- CPU overload
- memory depletion
- web application security
---

# Denial of Service

## Context

This guide focuses on executing denial-of-service (DoS) attacks through LaTeX injection. These attacks target the resource-intensive nature of LaTeX processing in web applications to deplete server resources, causing disruptions in service availability. Prior knowledge of LaTeX document structures, web server resource management, and general LaTeX injection methodologies is assumed.

## Theory

### Resource Exhaustion via LaTeX Injection

Denial of Service (DoS) attacks leveraging LaTeX injection exploit constructs within LaTeX that require significant computational resources. By intentionally designing codes that overwhelm CPU or memory capacity, attackers can slow down or crash web applications. Applications that compile user-supplied LaTeX without strict resource limits are particularly vulnerable to these attacks.

### Infinite Loops and Recursive Expansion in LaTeX

Infinite loops utilize LaTeX primitives, such as `\loop` and `\repeat`, to create endless compilation cycles. Similarly, recursive macro expansions, exemplified by `\def\x{\x\x}\x`, cause exponential resource consumption by repeatedly expanding macros. These techniques involve injecting loop or recursive macro payloads into LaTeX input fields handled by the server, leading to resource exhaustion.

### Threat Surface: Web LaTeX Compilation

In the data flow from user input to web application to LaTeX compiler, inadequate resource management can lead to denial of service through resource exhaustion. The assumption that user-supplied LaTeX input is benign and meant for legitimate document generation increases vulnerability to such attacks.

## Practice

### Infinite Loop Injection with `\loop ... \repeat`

- **Payload:**

  ```latex
  \newcount\foo
  \foo=1
  \loop
    \advance\foo by 1
  \repeat
  ```

  This payload creates an infinite loop, consuming the CPU indefinitely until the process is manually terminated or reaches its time limit.

- **Execution:**
  - Submit the above payload into a LaTeX input field processed by the target web application.
  - Monitor server CPU utilization, noting any symptoms of denial of service.
  
- **Outcome:** The web server's CPU resources become saturated, potentially leading to a service slowdown or compilation timeout.

### Recursive Macro Expansion (LaTeX Bomb)

- **Payload:**

  ```latex
  \def\x{\x\x}\x
  ```

  This payload defines a recursive macro that continuously expands, rapidly depleting memory and CPU resources.

- **Execution:**
  - Inject the payload into a LaTeX-enabled input field and initiate its compilation.
  - Observe resource consumption and server responsiveness post-injection.

- **Outcome:** The excessive consumption of CPU and memory could crash the LaTeX processing service or severely degrade performance.

### Memory Exhaustion via Large Array Allocation

- **Payload:**

  ```latex
  \newcount\foo
  \foo=100000000
  \loop
    \ifnum\foo>0
    \advance\foo by -1
  \repeat
  ```

  This payload causes the server to iterate a massive number of times, consuming significant memory and CPU resources.

- **Execution:**
  - Place the payload into the LaTeX input field and submit it for processing by the compiler.
  - Track the server's memory usage during and after processing.

- **Outcome:** Server memory is exhausted, leading to potential process termination or overall system instability.

## Tools

- **curl**
- **Burp Suite**