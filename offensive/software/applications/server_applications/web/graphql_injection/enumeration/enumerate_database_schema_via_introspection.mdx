---
title: 'GraphQL Introspection: Enumerate Database Schema'
description: Learn how to leverage GraphQL introspection to enumerate and explore
  database schemas for potential vulnerabilities.
keywords:
- GraphQL introspection
- database schema enumeration
- introspection query
- GraphQL security
- schema exposure
- __schema
- __type introspection
- GraphQL vulnerability
- introspection mechanism
---

# Enumerate Database Schema via Introspection

## Context

The purpose of this instructional guide is to enable you to enumerate a GraphQL application's database schema using introspection queries. This attack leverages the ability to query and examine the application's database structure, gaining insights potentially useful for crafting further attacks or accessing sensitive data.

To effectively utilize this guide, you should have an understanding of the following concepts:

- GraphQL schema structure and terminology.
- Crafting and sending GraphQL queries.
- The concept and mechanics of GraphQL introspection.
- Basic GraphQL injection techniques.

## Theory

### GraphQL Introspection Mechanism

Introspection is a built-in feature of GraphQL that allows a client to query the schema itself. Using introspection queries, you can retrieve detailed information about types, fields, and their relationships within the GraphQL schema. 

This mechanism is particularly useful for developers when exploring APIs. However, if improperly configured and exposed, it becomes a vulnerability. Attackers can use it to uncover the entire structure of a backend schema, including types, fields, and directives. This enumeration might disclose critical insights about the database structure and application logic.

### Key Introspection Queries and Fragments

The cornerstone of introspective enumeration lies in two meta-fields: `__schema` and `__type`. These are essential elements in any introspection query, allowing attackers to pull comprehensive details about the schema. Additionally, GraphQL supports fragments, which enable reusing field selections across multiple queries, thereby streamlining complex introspection queries.

Attackers typically craft introspection queries that target these meta-fields. This enables them to enumerate all types and fields, gaining insights that could unmask vulnerabilities, facilitate privilege escalation, or lead to unauthorized sensitive data access.

### Threat Surface: Schema Exposure Risks

Schema enumeration can expose hidden types, administrative fields, or sensitive relationships that are not documented or intended for public access. This knowledge enables attackers to conduct targeted exploitation. When exposed, these internal components of the application may facilitate privilege escalation or unauthorized access to sensitive data, presenting a significant security risk.

## Practice

### Enumerate All Types and Fields via Introspection Query

To enumerate all types and fields, a comprehensive introspection query should be crafted and submitted. The following payload represents the request required to access this data:

```json
{
  "query": "query IntrospectionQuery { __schema { types { name kind fields { name type { name kind ofType { name kind } } } } } }"
}
```

You can send this payload using a tool like `curl`:

```bash
curl -X POST https://target/graphql -H 'Content-Type: application/json' --data-binary @introspection_query.json
```

**Outcome:** This operation will result in the retrieval of a full list of types and fields available in the GraphQL schema, exposing the underlying database structure.

### Enumerate Specific Type Details Using __type

To gain details about a specific type, you can utilize the `__type` meta-field to query the desired information. Replace the placeholder `User` with any type you wish to inspect:

```json
{
  "query": "query { __type(name: \"User\") { name fields { name type { name kind } } } }"
}
```

Execute this query similarly using `curl`:

```bash
curl -X POST https://target/graphql -H 'Content-Type: application/json' --data-binary @type_query.json
```

**Outcome:** This query will reveal detailed information about the `User` type, including its fields and their types.

### Automated Schema Dump Using GraphQL Voyager

For an automated approach, tools like GraphQL Voyager can visualize and dump the schema if introspection is enabled:

```bash
graphql-voyager https://target/graphql
```

**Outcome:** This results in automated extraction and visualization of the entire GraphQL schema, offering a user-friendly and comprehensive view of the data available via introspection.

## Tools

- **curl**
- **GraphQL Voyager**