---
title: Exploiting GraphQL Mutations for Data Modification
description: Learn how to exploit GraphQL mutations for unauthorized data modifications
  using injection techniques.
keywords:
- GraphQL mutations
- mutation injection
- data modification
- GraphQL schema
- GraphQL security
- injection attack
- malicious payloads
---

# Mutations

## Context

In this article, we will explore how to exploit GraphQL mutations for unauthorized data modification using injection techniques. To fully engage with this content, it is assumed that you have a good understanding of the GraphQL schema structure and introspection, are familiar with standard GraphQL query syntax and HTTP request crafting, and possess a basic understanding of general GraphQL injection methodologies.

## Theory

### GraphQL Mutations and Their Security Implications

Mutations in GraphQL are operations designed to allow clients to modify server-side data, such as creating, updating, or deleting entries. These operations are integral to the functionality provided by GraphQL, enabling dynamic interactions within applications. However, because mutations often incorporate user input, they present a significant target for injection attacks. The vulnerability arises when input validation is insufficient, potentially allowing an attacker to alter data in unauthorized ways or escalate privileges within the application.

### Mutation Injection Attack Surface

The attack surface for mutation injections encompasses identifying mutation endpoints, analyzing their input parameters, and crafting malicious payloads that alter data. Applications frequently assume that authenticated users will only perform authorized mutations, but this trust can be misplaced if input validation is weak. The flexible input structure of GraphQL can allow attackers to hide malicious intent within complex mutation objects, making exploitation less conspicuous.

### Risks of Malicious Mutations

When executed successfully, mutation injection can lead to several detrimental outcomes. These include unauthorized data creation, modification, or deletion, potentially disrupting application logic or damaging data integrity. Furthermore, if mutation fields lack granular access control, the risk of abuse increases, enabling attackers to execute high-impact actions.

## Practice

### Manual Mutation Injection for Unauthorized Data Modification

Manual injection allows attackers to exploit specific mutation fields by crafting and sending HTTP requests with payloads that modify, delete, or create data improperly.

- **Change User Privilege**:
  
  Execute the following command to send a crafted mutation, attempting to escalate user privileges:
  
  ```bash
  curl -X POST https://target/graphql -H 'Content-Type: application/json' -d '{"query": "mutation { updateUser(id: \"1\", role: \"admin\") { id role } }"}'
  ```
  
  This request attempts to change the user with ID `1` to have `admin` privileges.

- **Delete Another User**:
  
  Inject a mutation to delete another user by executing:
  
  ```http
  mutation { deleteUser(id: "2") { id } }
  ```

- **Inject JavaScript for XSS**:
  
  Use the following mutation to inject JavaScript into a post, testing for stored XSS vulnerabilities:
  
  ```bash
  curl -X POST https://target/graphql -H 'Content-Type: application/json' -d '{"query": "mutation { createPost(input: {title: \"Injected\", content: \"<script>alert(1)</script>\"}) { id } }"}'
  ```

  This script alerts '1' whenever the injected content is rendered by any user's browser.

The outcome of these injections can lead to unauthorized data modification or deletion, or the execution of malicious scripts by other users.

### Automated Mutation Fuzzing for Injection Discovery

Automated fuzzing tools can be used to identify vulnerable mutation fields more efficiently.

- **Fuzzing Mutations**:
  
  Run the `graphql-cop` tool using:
  
  ```bash
  python3 graphql-cop.py -u https://target/graphql --fuzz-mutations
  ```

  This process will automatically explore mutation fields, identifying those susceptible to injections or potential privilege escalations.

Upon completion, the tool reveals any mutation fields vulnerable to tampering, enabling more precise targeting of subsequent assaults.

## Tools

- **curl**
- **graphql-cop**