---
title: Master SQL Injection with Built-in Tamper Scripts
description: Explore built-in tamper scripts in sqlmap to evade WAFs in SQL injection.
keywords:
- tamper scripts
- WAF evasion
- sqlmap
- SQL injection
- web application firewalls
- apostrophemask
- base64encode
- randomcase
---

# Built-in Tamper Scripts

## Context

This article explains the use of built-in tamper scripts in sqlmap for evading Web Application Firewalls (WAFs) during SQL injection attacks. It assumes that you have a fundamental understanding of SQL injection, the role of web application firewalls, and the structure of HTTP requests.

## Theory

### Purpose of Tamper Scripts

Tamper scripts are designed to modify SQL payloads in order to bypass WAFs that protect web applications. The primary function of these scripts is to alter the syntax of the payloads so that they can evade detection, without affecting the intended logic of the payloads.

### Common Tamper Techniques

Web Application Firewalls often rely on pattern matching to detect and block SQL injection attempts. Tampering disrupts these expected patterns, enabling the attack payloads to pass through undetected. The general attack sequence involves modifying the payload, sending the altered request, and then analyzing the response to see if the bypass was successful.

### Specific Built-in Tamper Scripts

Many built-in tamper scripts come with sqlmap, each designed to tackle specific evasion challenges. For instance:

- **`apostrophemask.py`**: Masks apostrophes in SQL payloads.
- **`base64encode.py`**: Encodes SQL payloads using Base64, which can trick basic input filters.
- **`randomcase.py`**: Randomizes the case of SQL keywords to evade naive signature-based detection systems.

Each script offers a unique way to alter payloads, targeting different WAF evasion techniques such as encoding or comment insertion.

## Practice

### Using Built-in Tamper Scripts in sqlmap

To effectively use built-in tamper scripts in sqlmap, follow these steps:

- **Step 1: Use `apostrophemask.py` to mask apostrophes in SQL payloads.**
    
    ```bash
    sqlmap -u "http://example.com/vuln" --tamper=apostrophemask.py
    ```

- **Step 2: Use `base64encode.py` to encode payloads in Base64.**

    ```bash
    sqlmap -u "http://example.com/vuln" --tamper=base64encode.py
    ```

- **Step 3: Use `randomcase.py` to randomize the case of SQL keywords.**

    ```bash
    sqlmap -u "http://example.com/vuln" --tamper=randomcase.py
    ```

The successful execution of these commands can potentially bypass WAF rules by altering the SQL payloads in a manner that avoids detection.

## Tools

- **sqlmap**

Using these built-in tamper scripts effectively can enhance the efficacy of SQL injection attacks by evading protective mechanisms put in place by web application firewalls. Always ensure that you have proper authorization before conducting any tests on live systems.