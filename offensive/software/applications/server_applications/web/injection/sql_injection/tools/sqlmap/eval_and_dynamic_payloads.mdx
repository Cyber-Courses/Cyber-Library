---
title: Dynamic Payloads & Eval in SQL Injection Attacks
description: Discover how to use sqlmap's --eval for dynamic SQL injection payloads
  and token manipulation.
keywords:
- sql injection
- dynamic payloads
- sqlmap --eval
- token manipulation
- cookie manipulation
- JWT manipulation
- authentication bypass
- privilege escalation
- runtime payloads
---

# Eval and Dynamic Payloads

## Context

The objective of this article is to explore how to utilize sqlmap's `--eval` option for generating dynamic payloads and manipulating tokens and cookies during SQL injection attacks. This technique leverages runtime data to create adaptive payloads, enabling a more efficient and context-aware exploitation process. Readers are expected to be familiar with the concepts of HTTP cookies, web tokens, hash functions, and timestamp mechanisms, as well as basic sqlmap usage, Boolean injection discovery, and request handling for injections.

## Theory

### Dynamic Payload Construction

Dynamic payloads are designed to adapt to the conditions at runtime, significantly enhancing the effectiveness of an attack. By leveraging contextual information from the target environment, these payloads can modify themselves to better align with the specific server responses or security mechanisms in place.

### Eval Function Usage in Sqlmap

Sqlmap's `--eval` option allows attackers to execute Python code on-the-fly to manipulate HTTP requests dynamically. This feature is particularly powerful for modifying tokens or cookies in real-time, adapting the payloads to the server's responses or generating new parameters dynamically.

### Token Security Implications

Manipulating tokens can reveal vulnerabilities related to authentication and authorization. Many applications rely heavily on tokens without thoroughly validating their integrity, presenting an opportunity for attackers to exploit token-based authentication schemes to bypass security measures or escalate privileges.

### Dynamic Cookie Manipulation

The ability to dynamically alter cookies presents opportunities to change session states or elevate privileges illegally. Attackers can leverage sqlmap's `--eval` to transform cookies on-the-fly based on server responses, enabling a flexible approach to session hijacking or privilege escalation.

## Practice

### Using --eval for Dynamic Payloads

Sqlmap facilitates the creation of dynamic payloads through its `--eval` option, enabling real-time manipulation of request parameters.

- **Generate a dynamic session token**:
  
  ```bash
  sqlmap -u "http://example.com/vuln" --eval="import hashlib; token=hashlib.md5('secret').hexdigest()" --cookie="session=token"
  ```

  This command generates a hash-based token using Pythonâ€™s `hashlib` and injects the computed token into the session cookie. The token is dynamically generated at runtime, adapting the request to exploit potential vulnerabilities more effectively.

- **Create a signed token for manipulation**:
  
  ```bash
  sqlmap -u "http://example.com/vuln" --eval="import flask_unsign; token=flask_unsign.sign({'user':'admin'}, 'secret')" --cookie="session=token"
  ```

  Here, `flask_unsign` is used to create a signed token, which is then injected into the session cookie. This allows an attacker to simulate an administrative session, potentially bypassing authentication mechanisms.

#### Outcome

Using dynamic payloads crafted with the `--eval` function, attackers can bypass authentication measures by manipulating session tokens effectively.

### Dynamic JWT Token Manipulation

Json Web Tokens (JWT) are commonly used for secure transmission of information between parties. Manipulating these tokens can lead to privilege escalation vulnerabilities.

- **Craft a JWT token with elevated privileges**:

  ```bash
  sqlmap -u "http://example.com/vuln" --eval="import jwt; token=jwt.encode({'user':'admin'}, 'secret', algorithm='HS256')" --cookie="jwt=token"
  ```

  This command encodes a JWT token with elevated privileges using the `jwt` library, then injects it into the JWT cookie. The crafted token, assuming administrative privileges, can help in bypassing access controls.

#### Outcome

By injecting crafted JWT tokens, attackers can escalate privileges, gaining unauthorized access to sensitive data or functionalities.

## Tools

- **sqlmap**
- **hashlib**
- **flask_unsign**
- **jwt**

These tools facilitate the creation and manipulation of dynamic payloads, enhancing the attacker's ability to craft context-aware exploits efficiently.