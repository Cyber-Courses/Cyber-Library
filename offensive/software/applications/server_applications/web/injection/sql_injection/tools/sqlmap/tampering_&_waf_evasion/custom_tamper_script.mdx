---
title: Create Custom Tamper Scripts for SQLMap WAF Evasion
description: Learn to develop custom tamper scripts for SQLMap to bypass WAFs and
  enhance SQL injection efficiency.
keywords:
- custom tamper script
- SQLMap
- WAF evasion
- SQL injection
- payload modification
- script registration
- priority handling
- encoding strategies
---

# Custom Tamper Script

## Context

Custom tamper scripts are a powerful tool in SQLMap to bypass web application firewalls (WAF) during a SQL injection attack. This topic aims to guide you through creating and deploying your own tamper script, allowing you to evade restrictions set by security filters. To fully benefit from this guide, you should already understand SQL injection mechanisms, the structure of HTTP requests, and the basics of web application firewalls.

## Theory

### Priority Handling in Scripts

In SQLMap, the execution order of tamper scripts is crucial, especially when multiple scripts are employed. This order can be controlled by defining a priority within the script. The priority setting ensures that scripts execute in a logical sequence, preventing conflicts or ineffective payload modifications.

### Dependency Management in Scripts

Tamper scripts can specify dependencies on other scripts, ensuring that those required are loaded first. Dependency management is crucial for complex payload modifications where one script's output becomes the input to another. By declaring these dependencies, you can coordinate multiple scripts to work cohesively without manual intervention.

### Payload Modification Techniques

At the core of a tamper script is its ability to modify SQL payloads to bypass WAF filtering patterns. This involves understanding the specific controls a WAF applies, such as blocking certain keywords or symbols, and rewriting the payload to mask these signatures. For instance, simple modifications might include replacing spaces with comments or encoding characters to avoid detection.

### Script Registration Process

For a custom tamper script to be recognized and executed by SQLMap, it must be correctly registered. Registration involves placing your script in SQLMap's tamper directory and ensuring the file is executable. This setup is fundamental to integrate your tamper script seamlessly with SQLMap's functionalities.

### Payload Return Mechanisms

A tamper script must return the modified payload through the `return payload` statement. After processing inputs to bypass security controls, the altered payload is returned for SQLMap to use in injection attempts, maintaining the operational flow within the tool.

### Encoding Strategies for Evasion

Encoding techniques such as base64 or URL encoding can obfuscate payloads, making them more difficult for WAF to detect. Using these methods strategically within a tamper script can increase the chances of a successful injection, as they conceal malicious signatures from standard filtering processes.

## Practice

### Creating a Custom Tamper Script

To develop a custom tamper script, follow these steps:

- **Create a new Python file for the tamper script.** This file will contain the logic for modifying SQLMap payloads.

    ```bash
    touch custom_tamper.py
    ```

    This command creates the script file in the SQLMap tamper directory.

- **Define the tamper function with the required parameters.** The function should accept a payload and return a modified version.

    ```python
    def tamper(payload, **kwargs):
        return payload.replace(' ', '/**/')
    ```

    In this example, the script replaces spaces with comments to bypass WAF.

- **Set the script's priority if needed.** Use the `__priority__` variable to control the execution order.

- **Register the script with SQLMap.** Ensure the script is in the tamper directory and executable.

   This process completes the setup needed for integration with SQLMap.

### Testing the Custom Tamper Script

To verify the script's functionality:

- Run SQLMap with the custom tamper script to test its effectiveness.

    ```bash
    sqlmap -u "http://example.com/vuln" --tamper=custom_tamper
    ```

- SQLMap should confirm the use of the custom tamper script.

    ```
    [INFO] using custom tamper script 'custom_tamper'
    ```

This test will determine if the custom script successfully evades the WAF.

## Tools

- **SQLMap**