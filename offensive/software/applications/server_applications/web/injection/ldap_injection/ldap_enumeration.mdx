---
title: Comprehensive Guide to LDAP Enumeration
description: Explore LDAP enumeration techniques for uncovering directory structures,
  user accounts, and schema definitions in cybersecurity.
keywords:
- LDAP enumeration
- directory structure
- user accounts
- schema definitions
- LDAP protocol
- anonymous bind
- naming contexts
- organizational units
- search filters
---

# LDAP Enumeration

## Context

LDAP Enumeration involves extracting valuable data from the Lightweight Directory Access Protocol (LDAP) directories. This technique is crucial for offensive operators aiming to gather intelligence on a target's directory structure, user accounts, groups, and schema definitions. A solid understanding of the LDAP protocol, directory services, and basic LDAP injection techniques is assumed for effective enumeration.

## Theory

### LDAP Directory Structure and Naming Contexts

LDAP directories function as hierarchical databases storing various objects, including users, groups, and organizational units (OUs). These objects are organized within a directory tree, each branch starting with a Naming Context, often referred to as the base DN. Understanding the layout of these directory trees and the object classes they contain is vital for effective enumeration.

### Anonymous and Authenticated LDAP Enumeration

Some LDAP servers are misconfigured, permitting anonymous binds that allow unauthenticated users to query directory information. This vulnerability model makes it possible for attackers to exploit weak access controls, enumerating users, groups, and OUs without credentials.

### Enumeration Vectors and Techniques

Attackers employ LDAP search filters to extract detailed information about the directory's contents. Weaknesses in protocol handling, such as accepting null base searches and wildcard filters, can expose entire directory sections. Crafting specific filters may allow operators to bypass restrictions, extending the reach of their enumeration efforts.

## Practice

### Anonymous LDAP Bind and Directory Structure Enumeration

By performing an anonymous bind and using basic queries, attackers can discover available naming contexts and enumerate the directory's structure.

- Use the following command to identify base DNs via anonymous bind:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -s base -b "" namingContexts
    ```
  
- Enumerate objects within the discovered base DN:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "<base_dn>" -s sub "(objectClass=*)"
    ```

The outcome of these commands will provide insights into the directory's structure, listing available naming contexts and objects stored within them.

### User and Group Enumeration via LDAP Search Filters

Enumeration of users and groups can offer insights into potentially exploitable accounts and privilege structures.

- To retrieve user objects:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "<base_dn>" "(objectClass=user)"
    ```

- For group objects enumeration:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "<base_dn>" "(objectClass=group)"
    ```

These operations extract detailed attributes of user and group accounts, facilitating further exploitation opportunities.

### Organizational Unit (OU) and Schema Enumeration

Enumeration of organizational units and schema information helps in understanding the directory's segmentation and data schema.

- List all organizational units:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "<base_dn>" "(objectClass=organizationalUnit)"
    ```

- Enumerate LDAP schema definitions:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "cn=schema,cn=configuration,<base_dn>" -s sub "(objectClass=*)"
    ```

This enumeration provides a map of the OUs and schema definitions, crucial for understanding the directory's logic and potential manipulation techniques.

### Null Base Search for Full Directory Dump

The null base search technique attempts to pull all directory objects in one query, making it powerful but dependent on server configurations.

- Execute a null base search:
    ```bash
    ldapsearch -x -H ldap://<target_ip> -b "" -s sub "(objectClass=*)"
    ```

Successfully performing this can expose the entire directory's contents, offering an exhaustive view of the available objects and their attributes.

## Tools

- **ldapsearch**
- **nmap**
- **ldapdomaindump**