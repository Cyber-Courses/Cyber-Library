---
title: Exploiting Default LDAP Attributes via Injection
description: Learn how to exploit default LDAP attributes for information disclosure
  and privilege escalation using injection techniques.
keywords:
- LDAP attributes
- LDAP injection
- information disclosure
- privilege escalation
- default attributes
- cn
- sn
- mail
- userPassword
---

# Default Attributes

## Context

The objective of this article is to enable offensive operators to identify and exploit default LDAP attributes via injection techniques for the purpose of information disclosure and privilege escalation. It assumes that the reader possesses knowledge of LDAP directory structures and schemas, LDAP query language and filter construction, attribute-based access control within LDAP, and general LDAP injection exploitation techniques.

## Theory

### Role of Default Attributes in LDAP

Default attributes in LDAP are standard fields that typically appear in most directory entries. These fields often hold sensitive or identifying information. Many LDAP implementations expose a predictable set of default attributes, especially for user and group objects. This predictable exposure allows attackers to target these attributes to extract sensitive data or escalate privileges via LDAP injection.

### Common Default LDAP Attributes and Their Offensive Value

Attributes such as `cn` (common name), `sn` (surname), `mail` (email address), `userPassword`, `memberOf`, `samAccountName`, and `userPrincipalName` are customarily present and hold substantial offensive value for attackers. Understanding these attribute names enables precise targeting when crafting injection queries. The typical attack sequence involves enumerating these attribute names, injecting queries to retrieve their values, and analyzing them for potential privilege escalation or lateral movements.

### Attribute Disclosure via LDAP Injection

To disclose attribute information through LDAP injection, attackers craft payloads designed to expand attribute lists in search results or bypass attribute-based restrictions. This often involves injecting wildcards or logical operators that manipulate the server into returning all attributes for a given entry.

## Practice

### Enumerating and Extracting Default LDAP Attributes via Injection

1. **Identify an injectable LDAP query parameter within the web application.**
   - Locate user input fields that reflect directly in LDAP queries, such as login forms or search fields.

2. **Inject a filter payload to match all objects and return all attributes.**
   ```sql
   *) (|(objectClass=*))
   ```
   - This payload forces the server to return all possible attributes by matching every object.

3. **Observe the returned attributes in the application's response.**
   - The response should display fields like `cn`, `sn`, `mail`, `userPassword`, `memberOf`, etc., depending on which attributes are exposed.

4. **Explicitly request a list of default attributes in the injection payload.**
   ```sql
   (&(uid=*)(|(cn=*)(sn=*)(mail=*)(userPassword=*)(memberOf=*)(samAccountName=*)(userPrincipalName=*)(displayName=*)(telephoneNumber=*)(description=*)(department=*)(title=*)))
   ```
   - This payload is designed to extract a comprehensive set of default attributes by leveraging logical operators.

5. **Analyze extracted attribute values for sensitive information or escalation opportunities.**
   - Review the results for credentials, group memberships, or any internal contact details that might be leveraged for further exploitation.

Upon successful execution, this technique allows attackers to obtain sensitive default attribute values, which can then be used for further exploitation or privilege escalation.

## Tools

- **Burp Suite**
- **ldapsearch**
- **Postman**