# 137,138,139 - Pentesting NetBios


# üëâ¬†Overview

---

### üëÄ¬†What ?

Pentesting NetBIOS refers to the process of exploiting the vulnerabilities in the Network Basic Input/Output System (NetBIOS), a software protocol that allows applications on separate computers to communicate over a local area network (LAN). It's commonly used in Windows-based systems.


### üßê¬†Why ?

Pentesting NetBIOS is crucial as it is a common protocol found in corporate networks, especially those that rely heavily on Windows-based systems. If left unchecked, vulnerabilities in NetBIOS can lead to unauthorized access, data breaches, and potential compromise of the entire network.


### ‚õèÔ∏è¬†How ?

Performing a pentest on NetBIOS involves several steps. First, you need to enumerate NetBIOS to identify active hosts in the network. Tools like Nbtscan or NMAP can be used in this process. Next, you would establish a null session with the target, which can be done using tools like Enum4linux or NBTEnum. Once the null session is established, information like user lists, machine lists, and shared resources can be extracted. Finally, the pentester would attempt to exploit any identified vulnerabilities to gain unauthorized access or disrupt the network's operations.


### ‚è≥¬†When ?

Pentesting NetBIOS should be performed regularly, especially when new systems are added to the network or after significant changes have been made to the network's infrastructure. Regular pentesting helps to ensure that any vulnerabilities are identified and addressed promptly.


# ‚öôÔ∏è¬†Technical Explanations

---

NetBIOS, or Network Basic Input/Output System, is a software protocol that facilitates communication between applications on separate computers within a local area network (LAN). Originally designed for early Windows versions, it's still widely used in many Windows-based networks today.

NetBIOS operates at the session layer of the OSI model, which manages communication sessions between computers. It consists of three main services: name services (port 137), datagram services (port 138), and session services (port 139).

1. Name Services (port 137): This service is responsible for identifying systems in the network by their NetBIOS names, which is necessary for establishing sessions between computers.
2. Datagram Services (port 138): This service enables data packets to be sent between computers without the need for a pre-established session, useful for sending data that doesn't require confirmation of receipt.
3. Session Services (port 139): This service manages connections between computers, allowing for reliable data transmission through a session-based communication.

Pentesters often target these ports as they can reveal significant information about the network. For instance, the NetBIOS name table for each device can provide the device's name, its domain, and the version of Windows it's running. Such information can be critical in identifying vulnerabilities within the network's security.

To exploit these vulnerabilities, pentesters typically follow a process that involves enumerating NetBIOS to identify active hosts, establishing a null session with the target to extract valuable data, and then exploiting any discovered vulnerabilities.

NetBIOS pentesting should be performed regularly, particularly when new systems are added or significant changes are made to the network's infrastructure. This proactive approach helps ensure any vulnerabilities are identified and addressed promptly, thereby maintaining the network's security.

Here is a high-level example of a NetBIOS pentest process:

1. **NetBIOS enumeration:** This is the process of identifying active hosts in a network. For this, we can use the tool `nbtscan`. Here's an example command: `nbtscan -r 192.168.1.0/24`. This command will scan the entire subnet, providing details about each host, such as MAC address, NetBIOS name, and the Windows version.
2. **Establishing a null session:** A null session allows a pentester to connect to a Windows machine without providing a username or password. For this, we can use the tool `enum4linux`. Here's an example command: `enum4linux -a 192.168.1.101`. This command will run all basic checks on the target host (192.168.1.101), including listing users, shares, and more.
3. **Extracting valuable data:** Once the null session is established, we can extract information like user lists, machine lists, and shared resources. This can be done using the same `enum4linux` tool. For instance, using `enum4linux -U 192.168.1.101` will list all users on the target host.
4. **Exploiting identified vulnerabilities:** Once vulnerabilities are identified, they can be exploited to gain unauthorized access or disrupt the network's operations. This step is highly dependent on the identified vulnerabilities and the specific security measures in place.

Please note that this is a simplified example for educational purposes. Always ensure you have proper authorization before conducting any pentesting activities.
