# Upgrade Header Smuggling


# üëâ¬†Overview

---

### üëÄ¬†What ?

> Upgrade Header Smuggling is a cyber-attack that manipulates the HTTP Upgrade header to bypass security controls and smuggle unauthorized data through a network. The fundamental concept behind this attack is the exploitation of the HTTP protocol's ability to switch from its standard protocol to another, such as from HTTP/1 to HTTP/2, WebSocket, etc., through the Upgrade header.
> 

### üßê¬†Why ?

> Understanding Upgrade Header Smuggling is crucial because it is a sophisticated attack that can bypass many security measures. It can lead to unauthorized access to sensitive data, data exfiltration, and even system compromise. Therefore, anyone involved in network security, web application development, or cybersecurity should be aware of this attack.
> 

### ‚õèÔ∏è¬†How ?

> To take advantage of Upgrade Header Smuggling, attackers typically send a malformed HTTP request with conflicting information in the Upgrade and Connection headers. This can cause intermediate caching servers and back-end servers to disagree on how to handle the request, allowing the attacker to smuggle a request through that should have been blocked. To protect against this, ensure that your systems are patched and up-to-date, use a web application firewall that can detect smuggling attempts, and consider disabling or limiting the use of the HTTP Upgrade header when it's not necessary.
> 

### ‚è≥¬†When ?

> Upgrade Header Smuggling attacks have been a known threat since the early 2000s, with the rise of HTTP/1.1 and the introduction of the Upgrade header. However, they've gained more attention in recent years due to the increasing complexity and sophistication of web applications and services.
> 

# ‚öôÔ∏è¬†Technical Explanations

---

At a technical level, Upgrade Header Smuggling involves sending an HTTP request where the Upgrade and Connection headers disagree. The Connection header is supposed to signal which other headers should persist into the transformed protocol after the upgrade. If the Connection header does not list the Upgrade header, but the Upgrade header is still present, this can cause disagreement between servers about whether to upgrade the protocol or not. If the intermediary (such as a reverse proxy or load balancer) decides not to upgrade but the back-end server does, this can allow the attacker to smuggle a request through the intermediary that it would otherwise have blocked.
