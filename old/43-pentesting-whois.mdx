# 43 - Pentesting WHOIS


# 👉 Overview

---

### 👀 What ?

Pentesting WHOIS is the process of performing a penetration test on the WHOIS protocol. WHOIS is a query and response protocol which is used for querying databases to determine the owner of a domain name, an IP address, or an autonomous system number. The fundamental concept underlying pentesting WHOIS is to find vulnerabilities that could allow unauthorized access or reveal sensitive information.


### 🧐 Why ?

Pentesting WHOIS is important for a number of reasons. Firstly, it can reveal vulnerabilities in the WHOIS protocol or in the way it is implemented, which could be exploited by attackers to gain unauthorized access or information. Secondly, it can help to ensure that sensitive information is not being unnecessarily exposed by the WHOIS protocol. Our readers should be interested in this topic because, as users of the internet, they are affected by the security of the domain names and IP addresses they interact with.


### ⛏️ How ?

To perform a pentest on WHOIS, you first need to have a thorough understanding of the WHOIS protocol. This includes knowing the types of requests and responses it supports, and the format of these requests and responses. Once you have this understanding, you can use a tool such as Nmap or WHOIS to send specially crafted requests to the WHOIS server and observe the responses. By analyzing these responses, you can identify potential vulnerabilities or leaks of sensitive information.


### ⏳ When ?

Pentesting WHOIS has been practiced since the early days of the internet, when the WHOIS protocol was first developed. However, it has become increasingly important in recent years, as the number of domain names and IP addresses has exploded, and as the security of these has become a major concern.


# ⚙️ Technical Explanations

---

WHOIS is a query and response protocol used for querying databases to determine the owner of a domain name, an IP address, or an autonomous system number. It operates over the Transmission Control Protocol (TCP), with clients connecting to a WHOIS server on TCP port 43 to send a text request. The server responds with information about the requested domain name or IP address.

Pentesting WHOIS involves identifying vulnerabilities in the protocol or its implementation that could be exploited by attackers to gain unauthorized access or information. This is achieved by sending unexpected requests to the server and observing its responses.

One common vulnerability is a buffer overflow, which occurs when the server doesn't handle requests longer than it expects properly. This could potentially allow an attacker to execute arbitrary code on the server.

In terms of information disclosure, the server may reveal the contact details of the domain name owner, which could be used for phishing attacks. Therefore, pentesting WHOIS can also help ensure that sensitive information isn't being unnecessarily disclosed.

To perform a successful pentest, a deep understanding of the WHOIS protocol is necessary, including the types of requests and responses it supports, and their format. Tools like Nmap or WHOIS can be used to send specially crafted requests to the server.

The importance of pentesting WHOIS has grown with the significant increase in the number of domain names and IP addresses, making their security a major concern. It's been practiced since the early days of the internet, and remains a crucial aspect of internet security.

An example of performing a WHOIS pentest might involve using the Nmap tool to query the WHOIS server. This can be done using the following command line in a terminal:

```bash
nmap -p43 --script whois-ip <target-ip-address

```

In this command:

- `nmap` is the tool being used.
- `p43` specifies port 43, which is the default port used by the WHOIS protocol.
- `-script whois-ip` asks Nmap to execute the whois-ip NSE script. NSE (Nmap Scripting Engine) scripts are used to automate a wide variety of networking tasks.
- `<target-ip-address` should be replaced with the IP address you are testing.

The output of this command will give you details about the owner of the IP address.

To perform a test for buffer overflow vulnerability, you might try sending a very long request to the server. This could be done with a tool like Netcat, with a command like this:

```bash
echo "a-long-string-of-characters" | nc <target-ip-address43

```

In this command, replace `"a-long-string-of-characters"` with a string of characters longer than the server expects, and replace `<target-ip-address` with the IP address of the server you are testing.

If the server crashes or behaves unexpectedly, it might be vulnerable to buffer overflow.

Remember, these tests should only be performed on servers where you have permission to test, for educational purposes. Unauthorized testing could be illegal or unethical.
