# 47808/udp - Pentesting BACNet


# üëâ¬†Overview

---

### üëÄ¬†What ?

BACnet, or Building Automation and Control Networks, is a communication protocol for building automation and control networks. It operates on UDP port 47808 and allows communication between various devices in building automation systems, such as air conditioning systems, fire alarm systems, security systems, and more.


### üßê¬†Why ?

Understanding and testing BACnet systems is crucial due to their extensive use in building management systems. A compromised BACnet system could lead to unauthorized control over building systems, potentially leading to significant safety risks and financial losses. Hence, it is essential to conduct penetration testing to identify and mitigate any vulnerabilities.


### ‚õèÔ∏è¬†How ?

To pentest a BACnet system, first, you need to understand the BACnet protocol and the specific implementation you are testing. Use a network sniffer like Wireshark to monitor the traffic on UDP port 47808. Look for any unusual or unencrypted traffic that could indicate a vulnerability. Then, use a tool like BACpypes or VTS to send custom BACnet packets to the system and observe the response. Always remember to conduct these tests ethically, and with proper permissions.


### ‚è≥¬†When ?

BACnet was first developed in 1995 by the American Society of Heating, Refrigerating and Air-Conditioning Engineers (ASHRAE). Since then, it has been widely used in building automation systems worldwide. As such, pentesting these systems has become an increasingly important part of cybersecurity practices.


# ‚öôÔ∏è¬†Technical Explanations

---

BACnet, short for Building Automation and Control Networks, is a widely used communication protocol for building automation systems. It utilizes various data link/physical layers, including IPv6, Ethernet, and MSTP, and operates on UDP port 47808 for IP networks.

The protocol facilitates communication between diverse devices in building automation systems, such as air conditioning systems, fire alarm systems, security systems, and more. This interoperability allows for a systems-level view and control of a building's operations.

The BACnet Application Layer offers a range of services, including the ability to read and write property services, enabling system control. For example, through these services, a user could adjust the temperature set point of an air conditioning system or disarm a security system.

Given the critical nature of the systems it interfaces with, BACnet systems are a potential target for cyber-attacks, making them a crucial subject for penetration testing. During a pentest, a tester seeks to identify vulnerabilities in these services, such as inadequate authentication or lack of encryption. These vulnerabilities could be exploited to manipulate the building systems controlled by the BACnet protocol, posing significant safety risks and potential financial losses.

To conduct a penetration test, a tester needs to understand the BACnet protocol and the specific implementation under scrutiny. Network sniffers like Wireshark can be used to monitor the traffic on UDP port 47808, searching for abnormal or unencrypted traffic that may suggest a vulnerability. Tools like BACpypes or VTS can then be used to send custom BACnet packets to the system and observe the response, thereby identifying potential security threats.

However, it's crucial to note that all tests should be conducted ethically and with appropriate permissions to avoid any legal implications.

For instance, let's say that you are pentesting a BACnet system that controls an air conditioning system in a commercial building. Here's a step-by-step process:

1. **Understanding the BACnet Protocol:** Begin with understanding the BACnet protocol's basics and how it interacts with the air conditioning system. You could refer to documentation available on ASHRAE's website or other credible sources.
2. **Monitoring Traffic:** Use a network sniffer like Wireshark to monitor network traffic. You would set it to capture packets on UDP port 47808, which is used by BACnet. A typical command might look like this:

```bash
wireshark -i eth0 -k -Y "udp.port == 47808"

```

This command tells Wireshark to start capturing on the 'eth0' interface, start the capture immediately (`-k`), and filter for UDP traffic on port 47808.

1. **Analyzing Traffic:** Review the captured traffic for any unusual patterns or unencrypted traffic that may indicate a vulnerability. For instance, you might look for plain text passwords or unencrypted command packets that could be intercepted and manipulated.
2. **Testing Vulnerabilities:** Use a tool like BACpypes to send custom BACnet packets to the system. This could be done to see if the system accepts commands from unauthorized sources or if it behaves unpredictably when sent malformed packets. An example command might be:

```bash
bacpypes write 192.0.2.1 analogInput:1 presentValue 72

```

This command tells BACpypes to write a value of '72' to the 'presentValue' property of the 'analogInput:1' object on the device at IP address '192.0.2.1'. If the command succeeds without proper authentication, you've discovered a vulnerability.

1. **Reporting:** Document your findings and share them with the appropriate team to ensure any vulnerabilities are addressed.

Remember, all these activities should be conducted ethically and with proper permissions.
