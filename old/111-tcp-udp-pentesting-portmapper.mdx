# 111/TCP/UDP - Pentesting Portmapper


# üëâ¬†Overview

---

### üëÄ¬†What ?

Portmapper, also known as port 111/TCP/UDP, is a server that converts RPC program numbers into Internet protocol port numbers. It is an essential component of the RPC system, which allows different software components to communicate across a network. Pentesting Portmapper involves assessing the vulnerabilities of this service to potential cyber attacks.


### üßê¬†Why ?

Understanding and testing Portmapper is crucial due to its significant role in network communications. If a hacker exploits vulnerabilities in Portmapper, they can interfere with the communication between software components, negatively affecting the operation of network services or even gaining unauthorized access to the system.


### ‚õèÔ∏è¬†How ?

To conduct pentesting on Portmapper, the first step is to scan the network for port 111 using a tool like Nmap. Once you've identified machines with Portmapper open, you can use tools like Rpcinfo to gather more information about the services running on those machines. This information can reveal potential vulnerabilities, which can then be exploited using various techniques. Always remember to follow ethical guidelines and only perform pentesting on systems you are authorized to test.


### ‚è≥¬†When ?

The practice of pentesting Portmapper has been prevalent since the inception of the RPC system, as it was quickly identified as a potential point of vulnerability. As our reliance on network communication continues to grow, the importance of securing services like Portmapper has only become more critical.


# ‚öôÔ∏è¬†Technical Explanations

---

Portmapper, also known as Port 111/TCP/UDP, is an integral part of the Remote Procedure Call (RPC) system. It functions as a server, translating RPC program numbers into Internet protocol port numbers. Each RPC service is assigned a unique port number, which is communicated to the Portmapper upon the service's initiation. Consequently, Portmapper makes this information accessible to clients.

The communication between the client and Portmapper can be exploited by potential attackers. An intruder can send a specially crafted request to the Portmapper, which would cause it to disclose critical information about the network's RPC services. This data, which includes the opened ports and the services running on them, can provide an attacker with an opportunity to identify and exploit possible vulnerabilities.

Penetration testing, or pentesting, is an essential method to identify these vulnerabilities. The process involves a simulated cyberattack on the system that hosts the Portmapper service. The first step in pentesting Portmapper is to scan the network for open Port 111 using tools like Nmap. Once the machines running Portmapper are identified, tools like Rpcinfo can be used to gather more information about the services they host.

The analysis of this collected data can reveal potential security vulnerabilities, which could be further exploited in the testing process. It's important to note, however, that pentesting should only be conducted on systems for which explicit authorization has been given, and the ultimate aim should be to identify vulnerabilities to mitigate them, enhancing the overall security of the system.

Here's a detailed, educational example of how you could conduct pentesting on Portmapper:

1. **Network Scanning:** The first step is to identify machines in the network that have Portmapper open. For this, you can use a tool like Nmap. The command would look something like this:
    
    ```
    nmap -p 111 192.168.1.0/24
    
    ```
    
    In this command, `-p 111` specifies the port number you're scanning for (Portmapper), and `192.168.1.0/24` is the range of IP addresses you're scanning. The output of this command will list all machines in the specified IP range that have port 111 open.
    
2. **Service Enumeration:** Once you've identified machines with Portmapper open, you can use a tool like Rpcinfo to gather more information about the services running on those machines. Here's how you might use Rpcinfo:
    
    ```
    rpcinfo -p 192.168.1.100
    
    ```
    
    In this command, `192.168.1.100` is a placeholder for the IP address of the machine you're investigating. The output of this command will list all RPC services running on the specified machine, along with their program numbers and port numbers.
    
3. **Vulnerability Identification:** Analyze the output from these commands to identify potential vulnerabilities. For example, if a service is running on an open port that shouldn't be, that could be a vulnerability. If a service is running as root when it doesn't need to, that could be another vulnerability.

Remember, this example is for educational purposes only. Always ensure you have explicit authorization before conducting any pentesting activities, and always aim to identify vulnerabilities in order to mitigate them and enhance the overall security of the system.
