# 264 - Pentesting Check Point FireWall-1


# üëâ¬†Overview

---

### üëÄ¬†What ?

Check Point FireWall-1 is a first-generation firewall system that provides security for computer networks. It employs a stateful inspection firewall, which is a blend of packet filtering and application-level gateways to monitor TCP/IP connections and to make real-time decisions regarding network traffic permissions.


### üßê¬†Why ?

Pentesting, or penetration testing, of Check Point FireWall-1 is crucial as it helps organizations identify potential vulnerabilities in their network security system. With the increasing sophistication of cyber attacks, it's important for organizations to take a proactive approach towards their network security. Pentesting Check Point FireWall-1 allows for the identification and rectification of security flaws, thereby ensuring a robust defense against potential cyber threats.


### ‚õèÔ∏è¬†How ?

To perform a pentest on Check Point FireWall-1, the first step is to gather information about the target system, such as IP addresses and open ports. The next step is scanning, where tools like Nmap can be used to identify services running on the target. Following this, vulnerabilities in the system are identified, often with the help of automated tools like Nessus. Once vulnerabilities are identified, they are exploited to gain unauthorized access or disrupt the normal functioning of the system. Finally, a detailed report is created, outlining the vulnerabilities found and the steps taken to exploit them, along with recommendations for remediation.


### ‚è≥¬†When ?

Pentesting should be performed regularly to ensure the ongoing security of an organization's network. Specifically for Check Point FireWall-1, pentesting should be carried out whenever there are significant changes to the network architecture, firewall configuration, or when new vulnerabilities are discovered in the system.


# ‚öôÔ∏è¬†Technical Explanations

---

Check Point FireWall-1 is a stateful inspection firewall that incorporates elements of both packet filtering and application-level gateways to monitor and control network traffic. A stateful inspection firewall, unlike a static packet filtering firewall, examines various attributes of each individual packet that traverses the firewall. These attributes include the source and destination IP addresses, TCP sequence numbers, port numbers, and other TCP flags.

The firewall maintains a dynamic state table that keeps track of all active sessions traversing the firewall. This allows it to make real-time decisions about whether to allow or deny traffic based on the state and context of the packet within a given session, rather than relying solely on static predefined rules. This approach offers a more granular level of control and more advanced security features.

In a penetration test, the tester would try to identify and exploit potential vulnerabilities in the firewall's security policies and procedures. This could involve manipulating the attributes of packets or sessions to deceive the firewall and bypass its security policies. One common method used in such attacks is IP spoofing, which involves altering the IP packet header to make it appear as though the packet is coming from a trusted source.

By successfully spoofing an IP address, an attacker can gain unauthorized access to the network, hijack sessions or take over accounts, and cause a variety of other security breaches. Therefore, regular penetration testing is essential to help identify and address these potential vulnerabilities, ensuring the robustness and integrity of the network security system.

For example, imagine an organization uses Check Point FireWall-1 to safeguard its network. A penetration tester would start by gathering information about the system using commands like `nmap`:

```
nmap -sS -p- 192.168.0.1

```

This command performs a SYN scan (`-sS`) on all ports (`-p-`) of the IP address `192.168.0.1`. This could help identify open ports and services running on the system.

Next, the tester might use a tool like Nessus to identify vulnerabilities:

```
nessus -T html -o /path/to/output.html 192.168.0.1

```

Here, the `-T` switch specifies the output format (HTML), `-o` specifies the output file, and `192.168.0.1` is the target IP address. The output file would provide details about potential vulnerabilities.

To exploit any identified vulnerabilities, the tester might use a tool like Metasploit. For instance, if a vulnerability was found in a certain service (e.g., SSH), the tester could use a Metasploit module to exploit it:

```
msfconsole
use exploit/unix/ssh/sshexec
set RHOSTS 192.168.0.1
set USERNAME root
set PASSWORD toor
run

```

In this example, `msfconsole` starts Metasploit's console interface. `use exploit/unix/ssh/sshexec` selects an exploit module for SSH. `set RHOSTS 192.168.0.1` sets the target IP address. `set USERNAME root` and `set PASSWORD toor` set the username and password, which the tester might have obtained through other means. Finally, `run` executes the exploit.

If the exploit is successful, the tester gains unauthorized access to the system, demonstrating a vulnerability that the organization needs to address. The tester would then document all findings, methods, and recommendations in a detailed report.
