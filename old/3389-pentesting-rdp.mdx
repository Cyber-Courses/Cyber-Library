# 3389 - Pentesting RDP


# üëâ¬†Overview

---

### üëÄ¬†What ?

3389 is the default port for the Remote Desktop Protocol (RDP). RDP is a proprietary protocol developed by Microsoft to provide a user with a graphical interface to connect to another computer over a network connection. Pentesting, or penetration testing, RDP involves testing the remote desktop service for vulnerabilities that could be exploited by an attacker.


### üßê¬†Why ?

RDP is widely used in corporate environments to manage Windows systems remotely. However, if not properly secured, RDP can be a major security weak point. An unprotected RDP port can allow an attacker to gain access to the network and potentially sensitive information. It is therefore essential to understand the potential vulnerabilities of RDP, and how to secure it against attacks.


### ‚õèÔ∏è¬†How ?

Pentesting RDP involves several steps. First, identify the target system and verify that it is running RDP. This can be done using tools like Nmap. Next, use a tool like Hydra or Crowbar to perform a brute force attack, attempting to guess the username and password. Another approach is to use an RDP client like rdesktop or FreeRDP to attempt to exploit known vulnerabilities in the RDP protocol or service itself. Finally, always ensure to patch your systems and use strong, unique passwords for all accounts.


### ‚è≥¬†When ?

RDP has been a target for attacks since it was first introduced in Windows NT 4.0 in 1996. The need for pentesting RDP has grown as the protocol has become more widely used and new vulnerabilities have been discovered. Today, it is an essential part of any penetration tester's toolkit.


# ‚öôÔ∏è¬†Technical Explanations

---

Remote Desktop Protocol (RDP) is a technology developed by Microsoft that provides a user with a graphical interface to connect to another computer over a network connection. It operates by transmitting keyboard and mouse events from one computer (client) to another (server) over a network connection.

On the server side, RDP uses its own video driver to capture the rendered display output. It constructs this rendering information into network packets using the RDP protocol and sends them over the network to the client. This process is akin to streaming a video, where the server's screen output is captured, encoded into a network-friendly format, and then transmitted to the client.

On the client side, RDP receives these rendering data packets and interprets them into corresponding Microsoft Windows graphics device interface (GDI) API calls. Essentially, it decodes the data and presents it on the client's display. This enables the user to interact with the remote system as if they were physically present at the machine.

However, this functionality also brings security concerns. If not properly secured, RDP can be a significant security weak point. For instance, an attacker could potentially intercept the network packets and gain access to the system. This method, known as a Man-in-the-Middle (MitM) attack, involves the attacker secretly relaying and possibly altering the communication between two parties who believe they are directly communicating with each other.

Moreover, vulnerabilities in the RDP service itself can be exploited to gain unauthorized access. Over the years, several such vulnerabilities have been discovered and subsequently patched by Microsoft. But systems running outdated versions of RDP may still be susceptible to these issues. Hence, penetration testing or 'pentesting' RDP is crucial to uncover and address these vulnerabilities.

Pentesting RDP can involve several techniques. Brute force attacks can be launched to guess the username and password, often using automated tools. Known vulnerabilities in the RDP protocol or service can be exploited using various software. Regular patching and updating of systems, along with the use of strong, unique passwords, can greatly enhance the security of RDP connections.

Let's take a look at a real but educational example of penetration testing (pentesting) RDP using the tool `nmap` for discovery and `Hydra` for brute force attack.

**Step 1: Discovery with nmap**

First, we need to discover if the target system is running the RDP service. We use `nmap`, a powerful and flexible open-source utility for network discovery and security auditing.

Here is an example command:

```
nmap -p 3389 target_ip

```

This command scans the port 3389 (default RDP port) on the target system specified by "target_ip". If the port is open, that means the system is running the RDP service.

**Step 2: Brute Force Attack with Hydra**

After discovering that RDP is running, we can try a brute force attack with `Hydra`. It is a parallelized login cracker which supports numerous protocols to attack, and RDP is one of them.

Here is an example command:

```
hydra -t 1 -V -f -l administrator -P password_list.txt rdp://target_ip

```

The parameters are as follows:

- `t 1`: This sets the number of parallel connections to 1.
- `V`: This turns on verbose mode, showing every attempt.
- `f`: This stops the attack once a password is found.
- `l administrator`: This specifies the login username to use (in this case, "administrator").
- `P password_list.txt`: This points to a file containing a list of passwords to try.
- `rdp://target_ip`: This is the target for the attack.

Remember, these steps are for educational purposes only and should never be used for illegal activities. Always obtain explicit permission before conducting any form of penetration testing.
