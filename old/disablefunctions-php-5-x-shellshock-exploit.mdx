# disable_functions - PHP 5.x Shellshock Exploit


# üëâ¬†Overview

---

### üëÄ¬†What ?

> The disable_functions is a configuration directive in PHP. It allows the server administrator to disable certain functions for security reasons. The PHP 5.x Shellshock Exploit is a vulnerability that allows an attacker to exploit this feature in order to execute arbitrary commands on a server using a compromised PHP application.
> 

### üßê¬†Why ?

> Understanding the disable_functions directive and the PHP 5.x Shellshock Exploit is key for both developers and security professionals. For developers, it helps them write more secure code by understanding the potential vulnerabilities that can be exploited. For security professionals, it helps them in penetration testing and vulnerability assessment activities to identify potential security weaknesses in PHP applications.
> 

### ‚õèÔ∏è¬†How ?

> To use disable_functions to your advantage, you need to understand which functions can be potentially exploited. Some of these include exec, system, and passthru, which allow command execution; and include, require, and fopen, which allow file inclusion. To implement disable_functions in your PHP configuration, you simply list the functions you want to disable, separated by a comma, like so: disable_functions = exec,system,passthru,include,require,fopen. Once done, restart your PHP service for the changes to take effect.
> 

### ‚è≥¬†When ?

> The use of disable_functions has been a standard security practice in PHP development since the early versions of PHP. The PHP 5.x Shellshock Exploit was discovered in 2014, and it has since been patched in later versions of PHP.
> 

# ‚öôÔ∏è¬†Technical Explanations

---

The 'disable_functions' directive is a security feature in PHP that allows server administrators to disable certain functions that could potentially be exploited. At the runtime level, specified functions are disabled, meaning that even if a PHP script attempts to call one of these functions, it will not execute.

An exploit known as the 'PHP 5.x Shellshock Exploit' takes advantage of the 'disable_functions' directive. This exploit uses a special environment variable to bypass the 'disable_functions' directive, allowing arbitrary commands to be executed. This could potentially allow an attacker to gain unauthorized access to the server or execute malicious activities.

The exploit became widely known in 2014 and affected PHP versions 5.x. However, it has been patched in later versions of PHP, highlighting the importance of keeping your PHP version up-to-date.

Furthermore, it's also recommended to keep all server software and scripts updated to further safeguard from potential vulnerabilities. Regularly reviewing and updating the list of disabled functions in your PHP configuration could also enhance the security of your server.

In terms of which functions to disable, it's important to consider which ones could potentially be exploited. Functions that allow command execution (such as 'exec', 'system', and 'passthru') and functions that allow file inclusion (like 'include', 'require', and 'fopen') are commonly disabled to mitigate potential risks.

To implement 'disable_functions' in your PHP configuration, you list the functions you want to disable, separated by commas. For instance, your configuration might look like this: 'disable_functions = exec,system,passthru,include,require,fopen'. After updating your configuration, it's necessary to restart your PHP service for the changes to take effect.

Understanding the 'disable_functions' directive and the PHP 5.x Shellshock Exploit is crucial for developers and security professionals alike. For developers, it can guide them towards writing more secure code. For security professionals, it aids in penetration testing and vulnerability assessment activities.

Let's consider an example where we are working with a PHP application, and we want to enhance its security by using the 'disable_functions' directive.

Step 1: Access PHP Configuration
Access your PHP configuration file, which is typically named 'php.ini'. This file is usually located in the etc directory.

```bash
cd /etc
vi php.ini

```

Step 2: Disable Functions
In the 'php.ini' file, find the line starting with 'disable_functions'. Add the functions you want to disable, separated by commas. In this case, we disable 'exec', 'system', 'passthru', 'include', 'require', and 'fopen'.

```bash
disable_functions = exec,system,passthru,include,require,fopen

```

Step 3: Save and Exit
Save the 'php.ini' file, and exit the text editor.

Step 4: Restart PHP Service
For the changes to take effect, you need to restart your PHP service. The command to do this depends on your server's operating system. On a Linux server, you might use:

```bash
service php-fpm restart

```

In this example, we disabled six functions that could potentially be exploited. Any PHP script that attempts to call these functions will not execute them, enhancing the security of your application. Remember to keep your PHP version up-to-date to protect against known vulnerabilities like the PHP 5.x Shellshock Exploit.
