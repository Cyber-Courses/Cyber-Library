# Second Order Injection - SQLMap


# 👉 Overview

---

### 👀 What ?

> Second Order Injection is a type of SQL (Structured Query Language) injection where the payload is stored and invoked in a subsequent operation, rather than being immediately executed. In this type of attack, the malicious input is not directly used in the construction of an SQL query, but stored in a database for later use, thus being invoked in a different context and potentially bypassing initial security checks.
> 

### 🧐 Why ?

> Understanding Second Order Injection is crucial for both developers and security professionals. For developers, this knowledge helps to build more secure applications by understanding how adversaries may exploit their systems. Security professionals, on the other hand, can use this knowledge to identify vulnerabilities during penetration tests and to defend against such attacks. The concept is important as it highlights the multi-step and often complex nature of advanced SQL injection attacks that can bypass traditional security measures.
> 

### ⛏️ How ?

> To exploit Second Order Injection, an attacker would first inject malicious SQL code into a database. This code is not immediately harmful, as it is designed to be stored for later use. Later on, the stored malicious code gets executed when the application uses the stored data in a SQL query. An example might be a user registration form where an attacker could input malicious SQL code into a username field. This code would then be stored in the database and executed when the application references the username in a subsequent operation.
> 

### ⏳ When ?

> Second Order Injection attacks have been in use since the early 2000s, but gained prominence with the increased use of web applications and the widespread use of databases to store user data. These attacks are relevant whenever an application uses user input in SQL queries, especially when that input is stored for later use.
> 

# ⚙️ Technical Explanations

---

At its core, Second Order Injection involves two steps: insertion and activation. In the insertion phase, the attacker injects their payload into a database, typically through a web application's user interface. This payload is not immediately harmful, and is designed to be undetectable by traditional means. In the activation phase, the application retrieves the stored data, including the attacker's payload, and uses it in a SQL query. If the application does not properly sanitize this input, the attacker's payload will be executed, potentially leading to unauthorized access, data loss, or other harmful effects.
