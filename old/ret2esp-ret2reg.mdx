# Ret2esp / Ret2reg


# 👉 Overview

---

### 👀 What ?

Ret2esp/Ret2reg, also known as return-to-register or return-to-libc, is a method of exploiting a buffer overflow vulnerability in a software program. This technique is used to bypass certain security mechanisms and execute arbitrary code.


### 🧐 Why ?

Understanding Ret2esp/Ret2reg is crucial for both attackers and defenders in the realm of cybersecurity. For attackers, it provides a method to exploit applications and gain unauthorized access to systems. For defenders, understanding this technique is key to developing effective security measures and strategies to prevent such attacks.


### ⛏️ How ?

Ret2esp/Ret2reg is executed by first causing a buffer overflow, which allows the attacker to overwrite the return address stored on the stack. The new return address leads to a location within the stack (esp) or a register (reg), which contains the attacker’s malicious code. This results in the execution of the malicious code when the function returns.


### ⏳ When ?

Ret2esp/Ret2reg exploitation has been in use since the late 1990s. It remains a relevant technique today due to the prevalence of buffer overflow vulnerabilities in software.


# ⚙️ Technical Explanations

---

Buffer overflow is a common software vulnerability where a program writes data outside of the memory it has allocated for it. By carefully crafting the input, an attacker can overwrite important control information, such as the return address stored on the stack. In a Ret2esp/Ret2reg attack, the attacker overwrites this return address with the address of their malicious code. This means when the function returns, it does not go back to the original caller, but instead jumps to the attacker's code. Since the code is executing within the process's existing memory space, it bypasses protections such as non-executable stack or heap memory.
