# One Gadget


# üëâ¬†Overview

---

### üëÄ¬†What ?

> One Gadget is a tool used in cybersecurity, particularly in the field of penetration testing. It is essentially a software utility that helps in finding one gadget functions in binaries. A one gadget function is a piece of code that, when called, gives the attacker full control over the system. It is typically found within the context of Return Oriented Programming (ROP) attacks, where an attacker exploits a vulnerable program to make it execute malicious code.
> 

### üßê¬†Why ?

> Understanding and using One Gadget is important because it provides an efficient way to identify one gadget functions in binaries, which are crucial in executing successful ROP attacks. These attacks are a common threat in cybersecurity, being a popular technique used by attackers to exploit vulnerabilities in programs and gain unauthorized control over systems. Therefore, being able to identify and understand one gadget functions is a valuable skill for those involved in cybersecurity, particularly penetration testers and security researchers.
> 

### ‚õèÔ∏è¬†How ?

> One Gadget can be used by first installing it on your system, typically done via the command line. Once installed, you can use it to analyze binaries and find one gadget functions. The tool provides several options to filter and sort the results, allowing you to find the most suitable one gadget function for your specific needs. It also provides detailed information about each function, such as its location and the conditions required to execute it successfully.
> 

### ‚è≥¬†When ?

> The use of One Gadget in cybersecurity started around the early 2010s, correlating with the rise of ROP attacks. It has since become a standard tool in penetration testing and security research.
> 

# ‚öôÔ∏è¬†Technical Explanations

---

One Gadget is a tool used in penetration testing and cybersecurity. It operates by analyzing the binary code of a program. More specifically, it searches for sequences of instructions, or 'gadgets', that conclude with the 'exec' system call. This system call is crucial as it provides the attacker with full control over the system.

These gadgets are typically found in the binary‚Äôs text segment, which houses the program‚Äôs executable code. To locate these gadgets, One Gadget employs specific algorithms to disassemble the binary into assembly code. Once the binary is broken down into assembly code, the tool then continues to analyze this code in search of gadgets.

Upon identifying these gadgets, One Gadget doesn't stop there. It further ranks the gadgets based on a set of criteria. These criteria include the number of conditions required to execute the gadgets successfully and the probability of the gadgets functioning in a real attack scenario. This ranking system allows users to select the most suitable gadget for their specific needs.

In essence, One Gadget is a highly specialized tool, crucial for penetration testers and security researchers. Its ability to efficiently locate and rank gadgets in binary code makes it significantly valuable in the cybersecurity domain, especially in the context of Return Oriented Programming (ROP) attacks.

For instance, suppose you're dealing with a binary file named 'vulnerable_program'. First, you would install One Gadget using the command line:

```bash
gem install one_gadget

```

After installation, you can use One Gadget to analyze 'vulnerable_program':

```bash
one_gadget vulnerable_program

```

This command would output a list of potential one gadget functions within the binary, each with an address and conditions for successful execution. The output might look something like this:

```bash
0x3a80c execve("/bin/sh", esp+0x28, environ)
constraints:
  esi is the GOT address of libc
  [esp+0x28] == NULL

```

Here, '0x3a80c' is the address of the one gadget function in the binary. The function 'execve("/bin/sh", esp+0x28, environ)' gives the attacker control over the system by executing a shell. The conditions for this function to execute successfully are also provided: 'esi' must be the GOT address of libc, and '[esp+0x28]' must be NULL.

Analyzing and understanding these outputs is crucial in planning an effective ROP attack. You would choose the function that best fits your needs based on its conditions and your knowledge about the target system. This step-by-step process illustrates how One Gadget can be used in a practical scenario.
