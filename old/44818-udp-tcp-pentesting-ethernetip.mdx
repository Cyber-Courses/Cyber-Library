# 44818/UDP/TCP - Pentesting EthernetIP


# üëâ¬†Overview

---

### üëÄ¬†What ?

> Ethernet/IP (Ethernet Industrial Protocol) is an industrial network protocol that adapts CIP (Common Industrial Protocol) to standard Ethernet. It is used globally in factory, hybrid and process applications by various industries. Port 44818 is the standard port over which EthernetIP operates, both for TCP and UDP protocols.
> 

### üßê¬†Why ?

> Understanding and pentesting EthernetIP is crucial as it forms the backbone of many industrial systems. If compromised, these systems can cause significant disruption and financial losses. Also, as it operates over the internet, it can be exposed to a variety of external threats, making it a target for cyber attackers.
> 

### ‚õèÔ∏è¬†How ?

> To perform a penetration test on EthernetIP, you need specialized tools like nmap, Wireshark, or Nessus. Start by scanning the network to identify devices that use EthernetIP. Once you've identified a target, use packet sniffing tools to capture and analyze the data packets. Look for vulnerabilities such as weak or default passwords, outdated firmware, or misconfigured settings. Always remember to follow ethical guidelines when conducting a pentest.
> 

### ‚è≥¬†When ?

> Pentesting a system or network component like EthernetIP should be done regularly, especially if changes have been made to the system. It's also recommended to conduct a pentest after a security incident to ensure that the vulnerability has been properly addressed.
> 

# ‚öôÔ∏è¬†Technical Explanations

---

Ethernet/IP (Ethernet Industrial Protocol) is an industrial network protocol that is adapted from CIP (Common Industrial Protocol) to standard Ethernet. It operates on port 44818, utilizing both TCP (Transmission Control Protocol) and UDP (User Datagram Protocol). The choice between TCP and UDP depends on the nature of the communication required.

TCP is used for explicit message or request-response type of communication. It is a connection-oriented protocol, meaning it ensures the delivery of packets from source to destination. This makes it reliable but slower compared to UDP. During penetration testing, the tester needs to be aware that TCP communication can be susceptible to certain types of attacks like spoofing, where an attacker can masquerade as a trusted network device, and session hijacking, where an attacker can take control of a user session.

On the other hand, UDP is used for implicit or time-critical messaging. It is a connectionless protocol, which means it does not guarantee the delivery of packets. Therefore, it's faster but less reliable than TCP. UDP is often used in real-time scenarios such as video streaming where speed is more important than accuracy. In the context of penetration testing, UDP communication can be exploited through amplification attacks. In these attacks, an attacker sends a small amount of data to a network service on a server, which responds with a larger amount of data. This can overload the server's network and cause a Denial of Service (DoS).

Penetration testing of systems utilizing Ethernet/IP should be done regularly due to the critical nature of the systems they often operate. Tools like nmap, Wireshark, or Nessus can be used for network scanning and packet analysis. The tester should look for vulnerabilities like weak or default passwords, outdated firmware, or misconfigured settings. It is crucial to remember to adhere to ethical guidelines when conducting penetration testing.

Here is an example of a penetration test on a system that uses Ethernet/IP:

1. **Network Scanning:** The first step is to scan the network for devices using Ethernet/IP. For this, we use the nmap tool. Here is an example of an nmap command:

```
nmap -p 44818 192.168.1.0/24

```

This command scans all devices in the 192.168.1.0/24 network for port 44818, which is used by Ethernet/IP.

1. **Packet Analysis:** Let's assume we found a device at IP 192.168.1.100. The next step is to analyze the packets sent to and from this device. We use Wireshark for this:

```
wireshark -i eth0 host 192.168.1.100

```

This command captures packets on the eth0 interface to and from the host 192.168.1.100.

1. **Analyzing the Results:** In Wireshark, we can filter for Ethernet/IP packets using the filter `eth.type == 0x22f0`. We look for signs of weak or default passwords, outdated firmware, or misconfigured settings.
2. **Exploiting Vulnerabilities:** If we find a vulnerability, we can try to exploit it. For instance, if we find a default password, we could try to log in. This should only be done with explicit permission and for educational purposes.

Remember, the goal of a penetration test is to identify vulnerabilities so they can be fixed. Always follow ethical guidelines when conducting a penetration test.
