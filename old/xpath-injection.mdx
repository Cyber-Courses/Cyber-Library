# XPATH injection


# 👉 Overview

---

### 👀 What ?

XPath Injection is an attack technique used to exploit applications that construct XPath (XML Path Language) queries from user-supplied input to manipulate or access data stored in XML documents. XPath is a language that is used to select nodes from an XML document. This makes XPath an attractive target for injection attacks, where malicious strings of code are inserted into a program's database query.


### 🧐 Why ?

XPath Injection is a significant security risk because it can be used to bypass authentication mechanisms, reveal sensitive information, and even execute arbitrary code, leading to a complete system compromise. Understanding XPath Injection is important for both developers and penetration testers. For developers, understanding XPath Injection can help them build more secure applications by avoiding common pitfalls and implementing proper input validation and output encoding. For penetration testers, understanding XPath Injection can help them identify and exploit vulnerabilities in applications that use XPath.


### ⛏️ How ?

XPath Injection can be exploited by sending maliciously crafted input to an application that uses user-supplied input to construct XPath queries. This usually involves inserting special characters or strings into the input in such a way that it alters the XPath query to perform actions unintended by the developer. To defend against XPath Injection, developers should use parameterized queries or prepared statements, which can separate data from commands and thus prevent an attacker from manipulating the queries. It's also important to perform input validation and output encoding to ensure that any user-supplied input is safe before it's included in an XPath query.


### ⏳ When ?

XPath Injection has been a known attack vector since the early 2000s, when XML and XPath started to be widely used in web applications. Despite the known risks and the availability of countermeasures, XPath Injection is still a common vulnerability found in many web applications today.


# ⚙️ Technical Explanations

---

In XPath Injection, the attacker manipulates an XPath query by inserting malicious strings into the user-supplied input. This can lead to various outcomes depending on the structure of the XPath query and the XML data. For instance, an attacker could manipulate an XPath query used for authentication to always return true, thereby bypassing the login mechanism. Alternatively, an attacker could manipulate an XPath query to return all nodes of an XML document, thereby revealing sensitive information. XPath Injection is possible because many applications fail to properly separate data (user-supplied input) from commands (XPath queries). This can be mitigated by using parameterized queries or prepared statements, which ensure that user-supplied input is always treated as data and not as part of the command. Furthermore, input validation and output encoding can be used to prevent special characters in the user-supplied input from altering the XPath query.
