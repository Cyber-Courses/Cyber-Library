# 161,162,10161,10162/udp - Pentesting SNMP


# üëâ¬†Overview

---

### üëÄ¬†What ?

> SNMP (Simple Network Management Protocol) is a protocol used to manage and monitor network devices. It operates on UDP ports 161 and 162 for general commands and trap messages respectively. UDP ports 10161 and 10162 are used for similar purposes, but are less common.
> 

### üßê¬†Why ?

> Understanding and pentesting SNMP is crucial due to its widespread use in managing network devices. Misconfigurations can lead to unauthorized information disclosure, allowing potential attackers to gain insight into the network structure and exploit vulnerabilities.
> 

### ‚õèÔ∏è¬†How ?

> To pentest SNMP, start by scanning for open UDP ports 161, 162, 10161, and 10162. Tools like Nmap can be used for this. Once detected, use SNMP-specific tools, such as snmpwalk or snmp-check, to enumerate SNMP objects and identify misconfigurations or weak community strings. Remember to follow ethical guidelines and only test systems you have permission to.
> 

### ‚è≥¬†When ?

> SNMP has been in use since the 1980s, and its pentesting is an ongoing process as new vulnerabilities and exploits continue to be discovered.
> 

# ‚öôÔ∏è¬†Technical Explanations

---

SNMP, which stands for Simple Network Management Protocol, is an essential protocol used to manage and monitor network devices. It operates at the application layer of the OSI model, which is responsible for providing services to software applications to communicate with the network.

SNMP uses User Datagram Protocol (UDP) rather than Transmission Control Protocol (TCP). This is due to UDP's lower overhead, which makes it faster and more efficient for data transmission, despite its lack of guaranteed delivery, order of segments, and protection against duplicates.

SNMP communicates using Protocol Data Units (PDUs). There are two primary types of PDUs: SNMP commands and SNMP trap messages. SNMP commands are sent to UDP port 161. These commands include GET, GETNEXT, SET, and RESPONSE, used to retrieve and modify data on the network devices.

SNMP trap messages, on the other hand, are sent to UDP port 162. Trap messages are unsolicited alerts or notifications sent by the network device to the network management system to signal that an event has occurred on the device.

Security in SNMP is handled through a community-based model. By default, the read community is "public", and the write community is "private". The community string works like a password, providing access to the statistics of the network device. If these default community strings are not changed, or weak strings are used, it can lead to unauthorized access and control of the network devices. Therefore, it's crucial to use strong community strings and change them regularly.

Furthermore, it's important to note that while UDP ports 161 and 162 are the standard ports for SNMP, ports 10161 and 10162 are also used for the same purpose but are less common. It's important to scan for these ports as well when conducting a penetration test on SNMP.

For instance, let's say we're performing a penetration test on a network device. To begin, we'll use the Nmap tool to scan for open UDP ports. The command might look like this:

```bash
nmap -sU -p 161,162,10161,10162 target_ip_address

```

In this command, `-sU` instructs Nmap to perform a UDP scan, while `-p` specifies the ports to be scanned. You would replace `target_ip_address` with the IP address of the device you're testing.

Suppose Nmap detects open ports 161 and 162. We could then use the `snmpwalk` tool to retrieve data from the device:

```bash
snmpwalk -v2c -c public target_ip_address

```

Here `-v2c` specifies the SNMP version to use (in this case, version 2c), `-c public` uses the default read community string "public", and `target_ip_address` is the IP of the device.

The `snmpwalk` command would output a list of SNMP objects from the device. These might include system information, interfaces, or IP routing information, which could indicate potential vulnerabilities.

Next, to mitigate security risks, we should change the community strings from the defaults of "public" and "private" to something stronger. This could be done via the device's management interface or through SNMP commands.

Remember, these steps are for educational purposes and should only be performed on systems you have permission to test.
