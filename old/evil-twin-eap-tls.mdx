# Evil Twin EAP-TLS


# üëâ¬†Overview

---

### üëÄ¬†What ?

Evil Twin EAP-TLS is a type of cyber attack where an attacker creates a fake wireless access point that looks like a legitimate one, then tricks a victim into connecting to it. EAP-TLS (Extensible Authentication Protocol-Transport Layer Security) is a protocol used to provide secure communication over a network. The fundamental principles underlying Evil Twin EAP-TLS involve networking, cryptography, and operating systems.


### üßê¬†Why ?

Understanding Evil Twin EAP-TLS is essential because it's a common method used by cyber attackers to steal sensitive information. It's a type of 'man-in-the-middle' attack, where an attacker intercepts communication between two parties without them knowing. This could be used to steal personal information, login credentials, or other sensitive data.


### ‚õèÔ∏è¬†How ?

To set up an Evil Twin EAP-TLS attack, an attacker usually needs to be within the range of the victim's wireless network. They create a 'rogue access point' that mimics the legitimate one, tricking the victim's device into connecting to it. Once the victim's device is connected, the attacker can intercept and decrypt any data sent over the network. To protect against this type of attack, it's essential to use secure protocols for wireless communication, regularly update and patch systems, and educate users about the risks of connecting to unknown networks.


### ‚è≥¬†When ?

The concept of Evil Twin attacks has been around since the inception of wireless networking, but they've become more prevalent with the increasing use of public Wi-Fi hotspots. The specific method of using EAP-TLS in these attacks is more recent, as it takes advantage of the increased security provided by this protocol to make the attack more convincing.


# ‚öôÔ∏è¬†Technical Explanations

---

An Evil Twin EAP-TLS attack is a sophisticated cybersecurity threat where the attacker creates a fraudulent wireless access point, also referred to as a rogue access point. This malicious network mimics the appearance and attributes of a legitimate network, leading unsuspecting victims to connect to it.

The process begins with the attacker setting up this rogue access point using equipment such as a laptop or specialized hardware. This rogue network is configured to broadcast the same Service Set Identifier (SSID), which is the network name, as the authentic network. This similarity in SSID often tricks devices into automatically connecting to the rogue access point, believing it to be their familiar network.

Upon connection, a victim is typically presented with a deceptive login page that closely resembles the login interface of the legitimate network. Should the victim mistakenly enter their credentials into this fraudulent page, the attacker gains access to these sensitive details.

These credentials can then be utilized by the attacker to infiltrate the actual network, thereby compromising its security and potentially gaining access to other interconnected systems. The attacker can intercept, decrypt, and potentially manipulate any data transferred over this rogue network, posing significant security risks.

Protection against this form of attack predominantly revolves around the use of secure wireless communication protocols such as WPA3, which provide robust encryption and authentication mechanisms. Furthermore, it is essential to maintain systems updated and patched to prevent exploitation of known vulnerabilities.

Lastly, user education is a crucial defense strategy against Evil Twin EAP-TLS attacks. Users should be made aware of the risks associated with connecting to unknown or public networks and should be trained to identify potential signs of rogue access points, such as suspiciously weak signals or unexpected requests for login credentials.

Consider the scenario where an attacker sets up an Evil Twin EAP-TLS attack at a popular coffee shop known for its free Wi-Fi. Let's call this coffee shop "Caf√©Net".

The attacker brings a laptop equipped with a wireless network card that supports "monitor" mode and "packet" injection. They utilize a tool such as 'aircrack-ng' to scan the area for Wi-Fi networks.

```bash
airmon-ng start wlan0    # wlan0 is the network interface
airodump-ng wlan0mon     # wlan0mon is the new interface in monitor mode

```

Upon identifying "Caf√©Net" and its details (e.g., channel and BSSID), the attacker creates an Evil Twin access point with the same SSID.

```bash
airbase-ng -a [BSSID] --essid "Caf√©Net" -c [channel] wlan0mon

```

Meanwhile, on another terminal, the attacker sets up a DHCP server to provide IP addresses to victims who connect to the rogue access point.

```bash
ifconfig at0 up 10.0.0.1 netmask 255.255.255.0
route add -net 10.0.0.0 netmask 255.255.255.0 gw 10.0.0.1
echo 1 /proc/sys/net/ipv4/ip_forward
dhcpd -cf /etc/dhcp/dhcpd.conf -pf /var/run/dhcpd.pid at0
/etc/init.d/isc-dhcp-server start

```

The attacker then uses 'sslstrip' and 'iptables' to intercept secure requests, making them appear as standard HTTP.

```bash
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
sslstrip -l 10000

```

When a victim connects to the rogue access point, thinking it's "Caf√©Net", they're presented with a login page imitating "Caf√©Net's" usual login page. The attacker now intercepts any data the victim sends, potentially gaining sensitive information.

To protect against such attacks, users should be wary of public Wi-Fi networks, especially those without password protection. They should avoid entering sensitive data when connected to public networks. Network administrators should ensure the use of secure protocols like WPA3 and regularly update and patch systems to prevent exploitation of known vulnerabilities.

# üñáÔ∏è¬†R√©f√©rences

---